! -----------------------------------------------------------------------------  
! This file was automatically created by SARAH version 4.5.9b3 
! SARAH References: arXiv:0806.0538, 0909.2863, 1002.0840, 1207.0906, 1309.7223  
! (c) Florian Staub, 2013  
! ------------------------------------------------------------------------------  
! File created at 14:31 on 26.8.2015   
! ----------------------------------------------------------------------  
 
 
Module FlavorKit_LFV_munuSSM3G 
Use Control 
Use Couplings_munuSSM3G 
Use LoopCouplings_munuSSM3G 
Use LoopFunctions 
Use LoopMasses_munuSSM3G 
Use StandardModel 

 
 Contains 
 
Subroutine CalculateBox2L2d(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,               & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVGL,              & 
& cplcFdFdVGR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,              & 
& cplcFdFuHpmR,cplcFdFuVWmL,cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,         & 
& cplcFuChiSuR,cplcFuFdcHpmL,cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,      & 
& cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFdcSdL,cplChiFdcSdR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL,cplGluFdcSdR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplHpmSucSd,cplSdcSdVP,            & 
& cplSdcSdVZ,cplSucSdVWm,cplSucSuVG,cplSucSuVP,cplSucSuVZ,BOllddSLL,BOllddSRR,           & 
& BOllddSRL,BOllddSLR,BOllddVRR,BOllddVLL,BOllddVRL,BOllddVLR,BOllddTLL,BOllddTLR,       & 
& BOllddTRL,BOllddTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process Box2L2d 
! 'PreSARAH' output has been generated  at 19:25 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVGL(3,3),cplcFdFdVGR(3,3),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),  & 
& cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),            & 
& cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),            & 
& cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),     & 
& cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),           & 
& cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),& 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFdcSdL(10,3,6),cplChiFdcSdR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL(3,6),           & 
& cplGluFdcSdR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplHpmSucSd(8,6,6),cplSdcSdVP(6,6),  & 
& cplSdcSdVZ(6,6),cplSucSdVWm(6,6),cplSucSuVG(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: BOllddSLL 
Complex(dp), Intent(out) :: BOllddSRR 
Complex(dp), Intent(out) :: BOllddSRL 
Complex(dp), Intent(out) :: BOllddSLR 
Complex(dp), Intent(out) :: BOllddVRR 
Complex(dp), Intent(out) :: BOllddVLL 
Complex(dp), Intent(out) :: BOllddVRL 
Complex(dp), Intent(out) :: BOllddVLR 
Complex(dp), Intent(out) :: BOllddTLL 
Complex(dp), Intent(out) :: BOllddTLR 
Complex(dp), Intent(out) :: BOllddTRL 
Complex(dp), Intent(out) :: BOllddTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateBox2L2d' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFd(gt3)  
MassEx32=MFd2(gt3) 
MassEx4=MFd(gt4)  
MassEx42=MFd2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], DownQuark, bar[DownQuark]} 
 ! ------------------------------ 
 
BOllddSLL=0._dp 
BOllddSRR=0._dp 
BOllddSRL=0._dp 
BOllddSLR=0._dp 
BOllddVRR=0._dp 
BOllddVLL=0._dp 
BOllddVRL=0._dp 
BOllddVLR=0._dp 
BOllddTLL=0._dp 
BOllddTLR=0._dp 
BOllddTRL=0._dp 
BOllddTRR=0._dp 
!----------------------------- 
! Box Contributions            
!----------------------------- 
! Cha,Ah,Fd,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(i3,gt3,i2)
coup3R = cplcFdFdAhR(i3,gt3,i2)
coup4L = cplcFdFdAhL(gt4,i3,i4)
coup4R = cplcFdFdAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
!print*,i1,i2,i3,i4
!stop
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Fd,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(i3,gt3,i2)
coup3R = cplcFdFdhhR(i3,gt3,i2)
coup4L = cplcFdFdAhL(gt4,i3,i4)
coup4R = cplcFdFdAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Fd,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(i3,gt3)
coup3R = cplcFdFdVPR(i3,gt3)
coup4L = cplcFdFdAhL(gt4,i3,i4)
coup4R = cplcFdFdAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Fd,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup4L = cplcFdFdAhL(gt4,i3,i4)
coup4R = cplcFdFdAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Hpm,Chi,Sd,Chi
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplChiFdcSdL(i2,gt3,i3)
coup3R = cplChiFdcSdR(i2,gt3,i3)
coup4L = cplcFdChiSdL(gt4,i4,i3)
coup4R = cplcFdChiSdR(gt4,i4,i3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VWm,Chi,Sd,Chi
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplChiFdcSdL(i2,gt3,i3)
coup3R = cplChiFdcSdR(i2,gt3,i3)
coup4L = cplcFdChiSdL(gt4,i4,i3)
coup4R = cplcFdChiSdR(gt4,i4,i3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BOllddSLL=BOllddSLL+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 -       & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BOllddSRR=BOllddSRR+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 -       & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +           & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -               & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -           & 
&  2.*int2)
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -           & 
&  2.*int2)
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Cha,Ah,Fd,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(i3,gt3,i2)
coup3R = cplcFdFdAhR(i3,gt3,i2)
coup4L = cplcFdFdhhL(gt4,i3,i4)
coup4R = cplcFdFdhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Fd,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(i3,gt3,i2)
coup3R = cplcFdFdhhR(i3,gt3,i2)
coup4L = cplcFdFdhhL(gt4,i3,i4)
coup4R = cplcFdFdhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Fd,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(i3,gt3)
coup3R = cplcFdFdVPR(i3,gt3)
coup4L = cplcFdFdhhL(gt4,i3,i4)
coup4R = cplcFdFdhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Fd,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup4L = cplcFdFdhhL(gt4,i3,i4)
coup4R = cplcFdFdhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,Ah,Fd,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(i3,gt3,i2)
coup3R = cplcFdFdAhR(i3,gt3,i2)
coup4L = cplcFdFdVPL(gt4,i3)
coup4R = cplcFdFdVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Fd,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(i3,gt3,i2)
coup3R = cplcFdFdhhR(i3,gt3,i2)
coup4L = cplcFdFdVPL(gt4,i3)
coup4R = cplcFdFdVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Fd,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(i3,gt3)
coup3R = cplcFdFdVPR(i3,gt3)
coup4L = cplcFdFdVPL(gt4,i3)
coup4R = cplcFdFdVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOllddVRR=BOllddVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOllddVLL=BOllddVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOllddVRL=BOllddVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Fd,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup4L = cplcFdFdVPL(gt4,i3)
coup4R = cplcFdFdVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOllddVRR=BOllddVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOllddVLL=BOllddVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOllddVRL=BOllddVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,Fd,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(i3,gt3,i2)
coup3R = cplcFdFdAhR(i3,gt3,i2)
coup4L = cplcFdFdVZL(gt4,i3)
coup4R = cplcFdFdVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Fd,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(i3,gt3,i2)
coup3R = cplcFdFdhhR(i3,gt3,i2)
coup4L = cplcFdFdVZL(gt4,i3)
coup4R = cplcFdFdVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Fd,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(i3,gt3)
coup3R = cplcFdFdVPR(i3,gt3)
coup4L = cplcFdFdVZL(gt4,i3)
coup4R = cplcFdFdVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOllddVRR=BOllddVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOllddVLL=BOllddVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOllddVRL=BOllddVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Fd,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup4L = cplcFdFdVZL(gt4,i3)
coup4R = cplcFdFdVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOllddVRR=BOllddVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOllddVLL=BOllddVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOllddVRL=BOllddVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Ah,bar[Cha],Su,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i2,i1)
coup2R = cplcChaChaAhR(gt2,i2,i1)
coup3L = cplcChaFdcSuL(i2,gt3,i3)
coup3R = cplcChaFdcSuR(i2,gt3,i3)
coup4L = cplcFdChaSuL(gt4,i4,i3)
coup4R = cplcFdChaSuR(gt4,i4,i3)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! hh,bar[Cha],Su,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt2,i2,i1)
coup2R = cplcChaChahhR(gt2,i2,i1)
coup3L = cplcChaFdcSuL(i2,gt3,i3)
coup3R = cplcChaFdcSuR(i2,gt3,i3)
coup4L = cplcFdChaSuL(gt4,i4,i3)
coup4R = cplcFdChaSuR(gt4,i4,i3)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VP,bar[Cha],Su,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVPL(gt2,i2)
coup2R = cplcChaChaVPR(gt2,i2)
coup3L = cplcChaFdcSuL(i2,gt3,i3)
coup3R = cplcChaFdcSuR(i2,gt3,i3)
coup4L = cplcFdChaSuL(gt4,i4,i3)
coup4R = cplcFdChaSuR(gt4,i4,i3)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BOllddSLL=BOllddSLL+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 -       & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BOllddSRR=BOllddSRR+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 -       & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +           & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -               & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -           & 
&  2.*int2)
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -           & 
&  2.*int2)
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VZ,bar[Cha],Su,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVZL(gt2,i2)
coup2R = cplcChaChaVZR(gt2,i2)
coup3L = cplcChaFdcSuL(i2,gt3,i3)
coup3R = cplcChaFdcSuR(i2,gt3,i3)
coup4L = cplcFdChaSuL(gt4,i4,i3)
coup4R = cplcFdChaSuR(gt4,i4,i3)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BOllddSLL=BOllddSLL+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 -       & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BOllddSRR=BOllddSRR+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 -       & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +           & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -               & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -           & 
&  2.*int2)
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -           & 
&  2.*int2)
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! conj[Su],bar[Fd],Ah,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
    Do i3=1,8
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdFdAhL(i2,gt3,i3)
coup3R = cplcFdFdAhR(i2,gt3,i3)
coup4L = cplcFdFdAhL(gt4,i4,i3)
coup4R = cplcFdFdAhR(gt4,i4,i3)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! conj[Su],bar[Fd],hh,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
    Do i3=1,8
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdFdhhL(i2,gt3,i3)
coup3R = cplcFdFdhhR(i2,gt3,i3)
coup4L = cplcFdFdhhL(gt4,i4,i3)
coup4R = cplcFdFdhhR(gt4,i4,i3)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! conj[Su],bar[Fd],VG,bar[Fd]
chargefactor = 4._dp/3._dp 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdFdVGL(i2,gt3)
coup3R = cplcFdFdVGR(i2,gt3)
coup4L = cplcFdFdVGL(gt4,i4)
coup4R = cplcFdFdVGR(gt4,i4)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BOllddSLL=BOllddSLL+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 -       & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BOllddSRR=BOllddSRR+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 -       & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -               & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +           & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -           & 
&  2.*int2)
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -           & 
&  2.*int2)
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! conj[Su],bar[Fd],VP,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdFdVPL(i2,gt3)
coup3R = cplcFdFdVPR(i2,gt3)
coup4L = cplcFdFdVPL(gt4,i4)
coup4R = cplcFdFdVPR(gt4,i4)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BOllddSLL=BOllddSLL+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 -       & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BOllddSRR=BOllddSRR+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 -       & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -               & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +           & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -           & 
&  2.*int2)
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -           & 
&  2.*int2)
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! conj[Su],bar[Fd],VZ,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdFdVZL(i2,gt3)
coup3R = cplcFdFdVZR(i2,gt3)
coup4L = cplcFdFdVZL(gt4,i4)
coup4R = cplcFdFdVZR(gt4,i4)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BOllddSLL=BOllddSLL+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 -       & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BOllddSRR=BOllddSRR+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 -       & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -               & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +           & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -           & 
&  2.*int2)
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -           & 
&  2.*int2)
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Chi,conj[Hpm],Fu,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,10
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplcFuFdcHpmL(i3,gt3,i2)
coup3R = cplcFuFdcHpmR(i3,gt3,i2)
coup4L = cplcFdFuHpmL(gt4,i3,i4)
coup4R = cplcFdFuHpmR(gt4,i3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,conj[VWm],Fu,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,10
    Do i3=1,3
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplcFuFdcVWmL(i3,gt3)
coup3R = cplcFuFdcVWmR(i3,gt3)
coup4L = cplcFdFuHpmL(gt4,i3,i4)
coup4R = cplcFdFuHpmR(gt4,i3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! bar[Fu],conj[Sd],Chi,conj[Sd]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,3
  Do i2=1,6
    Do i3=1,10
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(gt2,i1,i2)
coup2R = cplcChacFuSdR(gt2,i1,i2)
coup3L = cplChiFdcSdL(i3,gt3,i2)
coup3R = cplChiFdcSdR(i3,gt3,i2)
coup4L = cplcFdChiSdL(gt4,i3,i4)
coup4R = cplcFdChiSdR(gt4,i3,i4)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! bar[Fu],conj[Sd],Glu,conj[Sd]
chargefactor = 4._dp/3._dp 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,3
  Do i2=1,6
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(gt2,i1,i2)
coup2R = cplcChacFuSdR(gt2,i1,i2)
coup3L = cplGluFdcSdL(gt3,i2)
coup3R = cplGluFdcSdR(gt3,i2)
coup4L = cplcFdGluSdL(gt4,i4)
coup4R = cplcFdGluSdR(gt4,i4)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MGlu
mF22 = MGlu2
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Chi,conj[Hpm],Fu,conj[VWm]
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,10
  Do i2=1,8
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplcFuFdcHpmL(i3,gt3,i2)
coup3R = cplcFuFdcHpmR(i3,gt3,i2)
coup4L = cplcFdFuVWmL(gt4,i3)
coup4R = cplcFdFuVWmR(gt4,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSRR=BOllddSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Chi,conj[VWm],Fu,conj[VWm]
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,10
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplcFuFdcVWmL(i3,gt3)
coup3R = cplcFuFdcVWmR(i3,gt3)
coup4L = cplcFdFuVWmL(gt4,i3)
coup4R = cplcFdFuVWmR(gt4,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOllddVRR=BOllddVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOllddVLL=BOllddVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOllddVRL=BOllddVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,bar[Fd],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(gt4,i3,i2)
coup3R = cplcFdFdAhR(gt4,i3,i2)
coup4L = cplcFdFdAhL(i3,gt3,i4)
coup4R = cplcFdFdAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Fd],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(gt4,i3,i2)
coup3R = cplcFdFdhhR(gt4,i3,i2)
coup4L = cplcFdFdAhL(i3,gt3,i4)
coup4R = cplcFdFdAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Fd],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(gt4,i3)
coup3R = cplcFdFdVPR(gt4,i3)
coup4L = cplcFdFdAhL(i3,gt3,i4)
coup4R = cplcFdFdAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Fd],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcFdFdAhL(i3,gt3,i4)
coup4R = cplcFdFdAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Hpm,Chi,conj[Sd],Chi
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,8
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplcFdChiSdL(gt4,i2,i3)
coup3R = cplcFdChiSdR(gt4,i2,i3)
coup4L = cplChiFdcSdL(i4,gt3,i3)
coup4R = cplChiFdcSdR(i4,gt3,i3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLL=BOllddVLL - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddTLL=BOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VWm,Chi,conj[Sd],Chi
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 2
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplcFdChiSdL(gt4,i2,i3)
coup3R = cplcFdChiSdR(gt4,i2,i3)
coup4L = cplChiFdcSdL(i4,gt3,i3)
coup4R = cplChiFdcSdR(i4,gt3,i3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mV12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mV12, mS22)
  BOllddSLL=BOllddSLL - 8.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOllddSRR=BOllddSRR - 8.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOllddVLL=BOllddVLL+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Sd,Fu,conj[Hpm],Fu
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,6
  Do i2=1,3
    Do i3=1,8
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplcFdFuHpmL(gt4,i2,i3)
coup3R = cplcFdFuHpmR(gt4,i2,i3)
coup4L = cplcFuFdcHpmL(i4,gt3,i3)
coup4R = cplcFuFdcHpmR(i4,gt3,i3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLL=BOllddVLL - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddTLL=BOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Sd,Fu,conj[VWm],Fu
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 2
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplcFdFuVWmL(gt4,i2)
coup3R = cplcFdFuVWmR(gt4,i2)
coup4L = cplcFuFdcVWmL(i4,gt3)
coup4R = cplcFuFdcVWmR(i4,gt3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mV2 = MVWm
mV22 = MVWm2
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF12, mF22, mS12, mV22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mV22)
  BOllddSLL=BOllddSLL - 8.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOllddSRR=BOllddSRR - 8.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOllddVRR=BOllddVRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOllddVLL=BOllddVLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Cha,Ah,bar[Fd],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(gt4,i3,i2)
coup3R = cplcFdFdAhR(gt4,i3,i2)
coup4L = cplcFdFdhhL(i3,gt3,i4)
coup4R = cplcFdFdhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Fd],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(gt4,i3,i2)
coup3R = cplcFdFdhhR(gt4,i3,i2)
coup4L = cplcFdFdhhL(i3,gt3,i4)
coup4R = cplcFdFdhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Fd],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(gt4,i3)
coup3R = cplcFdFdVPR(gt4,i3)
coup4L = cplcFdFdhhL(i3,gt3,i4)
coup4R = cplcFdFdhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Fd],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcFdFdhhL(i3,gt3,i4)
coup4R = cplcFdFdhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Fd,Su,bar[Cha],Su
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
      Do i4=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MSu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i4)
coup1R = cplcFdChaSuR(i1,gt1,i4)
coup2L = cplcChaFdcSuL(gt2,i1,i2)
coup2R = cplcChaFdcSuR(gt2,i1,i2)
coup3L = cplcFdChaSuL(gt4,i3,i2)
coup3R = cplcFdChaSuR(gt4,i3,i2)
coup4L = cplcChaFdcSuL(i3,gt3,i4)
coup4R = cplcChaFdcSuR(i3,gt3,i4)
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i4)
mS12 = MSu2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MSu(i2)
mS22 = MSu2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddSLR=BOllddSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddTLL=BOllddTLL+0.
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,Ah,bar[Fd],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(gt4,i3,i2)
coup3R = cplcFdFdAhR(gt4,i3,i2)
coup4L = cplcFdFdVPL(i3,gt3)
coup4R = cplcFdFdVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Fd],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(gt4,i3,i2)
coup3R = cplcFdFdhhR(gt4,i3,i2)
coup4L = cplcFdFdVPL(i3,gt3)
coup4R = cplcFdFdVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Fd],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(gt4,i3)
coup3R = cplcFdFdVPR(gt4,i3)
coup4L = cplcFdFdVPL(i3,gt3)
coup4R = cplcFdFdVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRR=BOllddVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddVLL=BOllddVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddVRL=BOllddVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Fd],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcFdFdVPL(i3,gt3)
coup4R = cplcFdFdVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRR=BOllddVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddVLL=BOllddVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddVRL=BOllddVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,bar[Fd],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFdFdAhL(gt4,i3,i2)
coup3R = cplcFdFdAhR(gt4,i3,i2)
coup4L = cplcFdFdVZL(i3,gt3)
coup4R = cplcFdFdVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Fd],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFdFdhhL(gt4,i3,i2)
coup3R = cplcFdFdhhR(gt4,i3,i2)
coup4L = cplcFdFdVZL(i3,gt3)
coup4R = cplcFdFdVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Fd],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFdFdVPL(gt4,i3)
coup3R = cplcFdFdVPR(gt4,i3)
coup4L = cplcFdFdVZL(i3,gt3)
coup4R = cplcFdFdVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRR=BOllddVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddVLL=BOllddVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddVRL=BOllddVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Fd],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcFdFdVZL(i3,gt3)
coup4R = cplcFdFdVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOllddSLL=BOllddSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddSRR=BOllddSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOllddSRL=BOllddSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddSLR=BOllddSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRR=BOllddVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOllddVLL=BOllddVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOllddVRL=BOllddVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Ah,Fd,Su,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,3
    Do i3=1,6
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcFdChaSuL(gt4,i4,i3)
coup2R = cplcFdChaSuR(gt4,i4,i3)
coup3L = cplcFdFdAhL(i2,gt3,i1)
coup3R = cplcFdFdAhR(i2,gt3,i1)
coup4L = cplcChaFdcSuL(gt2,i2,i3)
coup4R = cplcChaFdcSuR(gt2,i2,i3)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! hh,Fd,Su,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,3
    Do i3=1,6
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcFdChaSuL(gt4,i4,i3)
coup2R = cplcFdChaSuR(gt4,i4,i3)
coup3L = cplcFdFdhhL(i2,gt3,i1)
coup3R = cplcFdFdhhR(i2,gt3,i1)
coup4L = cplcChaFdcSuL(gt2,i2,i3)
coup4R = cplcChaFdcSuR(gt2,i2,i3)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VP,Fd,Su,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 3
  Do i2=1,3
    Do i3=1,6
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcFdChaSuL(gt4,i4,i3)
coup2R = cplcFdChaSuR(gt4,i4,i3)
coup3L = cplcFdFdVPL(i2,gt3)
coup3R = cplcFdFdVPR(i2,gt3)
coup4L = cplcChaFdcSuL(gt2,i2,i3)
coup4R = cplcChaFdcSuR(gt2,i2,i3)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mV12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BOllddSLL=BOllddSLL - 0.25*chargefactor*(13.*coup1L*coup2L*coup3L*coup4L +          & 
&  3.*coup1R*coup2R*coup3R*coup4R)*int1
  BOllddSRR=BOllddSRR - 0.25*chargefactor*(3.*coup1L*coup2L*coup3L*coup4L +           & 
&  13.*coup1R*coup2R*coup3R*coup4R)*int1
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(-1.*coup1L*coup2L*coup3L*coup4L +           & 
&  coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1R*coup2L*coup3L*coup4R*int2)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(coup1L*coup2L*coup3L*coup4L -               & 
&  1.*coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1L*coup2R*coup3R*coup4L*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRL=BOllddVRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(-21.*coup1L*coup2L*coup3L*coup4L +         & 
&  5.*coup1R*coup2R*coup3R*coup4R)*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(5.*coup1L*coup2L*coup3L*coup4L -           & 
&  21.*coup1R*coup2R*coup3R*coup4R)*int1
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VZ,Fd,Su,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 3
  Do i2=1,3
    Do i3=1,6
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcFdChaSuL(gt4,i4,i3)
coup2R = cplcFdChaSuR(gt4,i4,i3)
coup3L = cplcFdFdVZL(i2,gt3)
coup3R = cplcFdFdVZR(i2,gt3)
coup4L = cplcChaFdcSuL(gt2,i2,i3)
coup4R = cplcChaFdcSuR(gt2,i2,i3)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mV12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BOllddSLL=BOllddSLL - 0.25*chargefactor*(13.*coup1L*coup2L*coup3L*coup4L +          & 
&  3.*coup1R*coup2R*coup3R*coup4R)*int1
  BOllddSRR=BOllddSRR - 0.25*chargefactor*(3.*coup1L*coup2L*coup3L*coup4L +           & 
&  13.*coup1R*coup2R*coup3R*coup4R)*int1
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(-1.*coup1L*coup2L*coup3L*coup4L +           & 
&  coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1R*coup2L*coup3L*coup4R*int2)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(coup1L*coup2L*coup3L*coup4L -               & 
&  1.*coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1L*coup2R*coup3R*coup4L*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRL=BOllddVRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(-21.*coup1L*coup2L*coup3L*coup4L +         & 
&  5.*coup1R*coup2R*coup3R*coup4R)*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(5.*coup1L*coup2L*coup3L*coup4L -           & 
&  21.*coup1R*coup2R*coup3R*coup4R)*int1
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! conj[Su],Cha,Ah,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,6
  Do i2=1,5
    Do i3=1,8
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcFdFdAhL(gt4,i4,i3)
coup2R = cplcFdFdAhR(gt4,i4,i3)
coup3L = cplcChaFdcSuL(i2,gt3,i1)
coup3R = cplcChaFdcSuR(i2,gt3,i1)
coup4L = cplcChaChaAhL(gt2,i2,i3)
coup4R = cplcChaChaAhR(gt2,i2,i3)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! conj[Su],Cha,hh,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,6
  Do i2=1,5
    Do i3=1,8
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcFdFdhhL(gt4,i4,i3)
coup2R = cplcFdFdhhR(gt4,i4,i3)
coup3L = cplcChaFdcSuL(i2,gt3,i1)
coup3R = cplcChaFdcSuR(i2,gt3,i1)
coup4L = cplcChaChahhL(gt2,i2,i3)
coup4R = cplcChaChahhR(gt2,i2,i3)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOllddVRL=BOllddVRL+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOllddVLR=BOllddVLR+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOllddTLL=BOllddTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! conj[Su],Cha,VP,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 3
Do i1=1,6
  Do i2=1,5
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcFdFdVPL(gt4,i4)
coup2R = cplcFdFdVPR(gt4,i4)
coup3L = cplcChaFdcSuL(i2,gt3,i1)
coup3R = cplcChaFdcSuR(i2,gt3,i1)
coup4L = cplcChaChaVPL(gt2,i2)
coup4R = cplcChaChaVPR(gt2,i2)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BOllddSLL=BOllddSLL - 0.25*chargefactor*(3.*coup1R*coup2L*coup3R*coup4L +           & 
&  13.*coup1L*coup2R*coup3L*coup4R)*int1
  BOllddSRR=BOllddSRR - 0.25*chargefactor*(13.*coup1R*coup2L*coup3R*coup4L +          & 
&  3.*coup1L*coup2R*coup3L*coup4R)*int1
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(coup1R*coup2L*coup3R*coup4L -               & 
&  1.*coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1R*coup2R*coup3L*coup4L*int2)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(-1.*coup1R*coup2L*coup3R*coup4L +           & 
&  coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1L*coup2L*coup3R*coup4R*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddVRL=BOllddVRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(5.*coup1R*coup2L*coup3R*coup4L -           & 
&  21.*coup1L*coup2R*coup3L*coup4R)*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(-21.*coup1R*coup2L*coup3R*coup4L +         & 
&  5.*coup1L*coup2R*coup3L*coup4R)*int1
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! conj[Su],Cha,VZ,bar[Fd]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 3
Do i1=1,6
  Do i2=1,5
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcFdFdVZL(gt4,i4)
coup2R = cplcFdFdVZR(gt4,i4)
coup3L = cplcChaFdcSuL(i2,gt3,i1)
coup3R = cplcChaFdcSuR(i2,gt3,i1)
coup4L = cplcChaChaVZL(gt2,i2)
coup4R = cplcChaChaVZR(gt2,i2)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BOllddSLL=BOllddSLL - 0.25*chargefactor*(3.*coup1R*coup2L*coup3R*coup4L +           & 
&  13.*coup1L*coup2R*coup3L*coup4R)*int1
  BOllddSRR=BOllddSRR - 0.25*chargefactor*(13.*coup1R*coup2L*coup3R*coup4L +          & 
&  3.*coup1L*coup2R*coup3L*coup4R)*int1
  BOllddSRL=BOllddSRL+chargefactor*(0.75*(coup1R*coup2L*coup3R*coup4L -               & 
&  1.*coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1R*coup2R*coup3L*coup4L*int2)
  BOllddSLR=BOllddSLR+chargefactor*(0.75*(-1.*coup1R*coup2L*coup3R*coup4L +           & 
&  coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1L*coup2L*coup3R*coup4R*int2)
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddVRL=BOllddVRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddVLR=BOllddVLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddTLL=BOllddTLL+0.0625*chargefactor*(5.*coup1R*coup2L*coup3R*coup4L -           & 
&  21.*coup1L*coup2R*coup3L*coup4R)*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.0625*chargefactor*(-21.*coup1R*coup2L*coup3R*coup4L +         & 
&  5.*coup1L*coup2R*coup3L*coup4R)*int1
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Chi,Sd,Fu,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcFdFuHpmL(gt4,i3,i4)
coup2R = cplcFdFuHpmR(gt4,i3,i4)
coup3L = cplChiFdcSdL(i1,gt3,i2)
coup3R = cplChiFdcSdR(i1,gt3,i2)
coup4L = cplcChacFuSdL(gt2,i3,i2)
coup4R = cplcChacFuSdR(gt2,i3,i2)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRR=BOllddVRR - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLL=BOllddVLL - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! bar[Fu],Hpm,Chi,conj[Sd]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,3
  Do i2=1,8
    Do i3=1,10
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcFdChiSdL(gt4,i3,i4)
coup2R = cplcFdChiSdR(gt4,i3,i4)
coup3L = cplcFuFdcHpmL(i1,gt3,i2)
coup3R = cplcFuFdcHpmR(i1,gt3,i2)
coup4L = cplcChaChiHpmL(gt2,i3,i2)
coup4R = cplcChaChiHpmR(gt2,i3,i2)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOllddSLL=BOllddSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddSRR=BOllddSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOllddSRL=BOllddSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOllddSLR=BOllddSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOllddVRR=BOllddVRR - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOllddVLL=BOllddVLL - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOllddVRL=BOllddVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOllddVLR=BOllddVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOllddTLL=BOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! bar[Fu],VWm,Chi,conj[Sd]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 3
Do i1=1,3
    Do i3=1,10
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcFdChiSdL(gt4,i3,i4)
coup2R = cplcFdChiSdR(gt4,i3,i4)
coup3L = cplcFuFdcVWmL(i1,gt3)
coup3R = cplcFuFdcVWmR(i1,gt3)
coup4L = cplcChaChiVWmL(gt2,i3)
coup4R = cplcChaChiVWmR(gt2,i3)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -           & 
&  8.*int2)
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -           & 
&  8.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOllddTLL=BOllddTLL - 0.25*chargefactor*coup1L*coup2L*coup3L*coup4R*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.25*chargefactor*coup1R*coup2R*coup3R*coup4L*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Chi,Sd,Fu,conj[VWm]
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 3
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcFdFuVWmL(gt4,i3)
coup2R = cplcFdFuVWmR(gt4,i3)
coup3L = cplChiFdcSdL(i1,gt3,i2)
coup3R = cplChiFdcSdR(i1,gt3,i2)
coup4L = cplcChacFuSdL(gt2,i3,i2)
coup4R = cplcChacFuSdR(gt2,i3,i2)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOllddSLL=BOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -           & 
&  8.*int2)
  BOllddSRR=BOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -           & 
&  8.*int2)
  BOllddSRL=BOllddSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOllddSLR=BOllddSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOllddVRR=BOllddVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BOllddVLL=BOllddVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BOllddVRL=BOllddVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOllddVLR=BOllddVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOllddTLL=BOllddTLL - 0.25*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOllddTLR=BOllddTLR+0.
  BOllddTRL=BOllddTRL+0.
  BOllddTRR=BOllddTRR - 0.25*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 BOllddSLL=oo16pi2*BOllddSLL 
BOllddSRR=oo16pi2*BOllddSRR 
BOllddSRL=oo16pi2*BOllddSRL 
BOllddSLR=oo16pi2*BOllddSLR 
BOllddVRR=oo16pi2*BOllddVRR 
BOllddVLL=oo16pi2*BOllddVLL 
BOllddVRL=oo16pi2*BOllddVRL 
BOllddVLR=oo16pi2*BOllddVLR 
BOllddTLL=oo16pi2*BOllddTLL 
BOllddTLR=oo16pi2*BOllddTLR 
BOllddTRL=oo16pi2*BOllddTRL 
BOllddTRR=oo16pi2*BOllddTRR 
Iname=Iname-1

End Subroutine CalculateBox2L2d 

Subroutine CalculatePengS2L2d(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVGL,              & 
& cplcFdFdVGR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,              & 
& cplcFdFuHpmR,cplcFdFuVWmL,cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,         & 
& cplcFuChiSuR,cplcFuFdcHpmL,cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,      & 
& cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFdcSdL,cplChiFdcSdR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL,cplGluFdcSdR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplHpmSucSd,cplSdcSdVP,            & 
& cplSdcSdVZ,cplSucSdVWm,cplSucSuVG,cplSucSuVP,cplSucSuVZ,PSOllddSLL,PSOllddSRR,         & 
& PSOllddSRL,PSOllddSLR,PSOllddVRR,PSOllddVLL,PSOllddVRL,PSOllddVLR,PSOllddTLL,          & 
& PSOllddTLR,PSOllddTRL,PSOllddTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengS2L2d 
! 'PreSARAH' output has been generated  at 19:26 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVGL(3,3),cplcFdFdVGR(3,3),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),  & 
& cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),            & 
& cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),            & 
& cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),     & 
& cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),           & 
& cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),& 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFdcSdL(10,3,6),cplChiFdcSdR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL(3,6),           & 
& cplGluFdcSdR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplHpmSucSd(8,6,6),cplSdcSdVP(6,6),  & 
& cplSdcSdVZ(6,6),cplSucSdVWm(6,6),cplSucSuVG(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PSOllddSLL 
Complex(dp), Intent(out) :: PSOllddSRR 
Complex(dp), Intent(out) :: PSOllddSRL 
Complex(dp), Intent(out) :: PSOllddSLR 
Complex(dp), Intent(out) :: PSOllddVRR 
Complex(dp), Intent(out) :: PSOllddVLL 
Complex(dp), Intent(out) :: PSOllddVRL 
Complex(dp), Intent(out) :: PSOllddVLR 
Complex(dp), Intent(out) :: PSOllddTLL 
Complex(dp), Intent(out) :: PSOllddTLR 
Complex(dp), Intent(out) :: PSOllddTRL 
Complex(dp), Intent(out) :: PSOllddTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengS2L2d' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFd(gt3)  
MassEx32=MFd2(gt3) 
MassEx4=MFd(gt4)  
MassEx42=MFd2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], DownQuark, bar[DownQuark]} 
 ! ------------------------------ 
 
PSOllddSLL=0._dp 
PSOllddSRR=0._dp 
PSOllddSRL=0._dp 
PSOllddSLR=0._dp 
PSOllddVRR=0._dp 
PSOllddVLL=0._dp 
PSOllddVRL=0._dp 
PSOllddVLR=0._dp 
PSOllddTLL=0._dp 
PSOllddTLR=0._dp 
PSOllddTRL=0._dp 
PSOllddTRR=0._dp 
!---------------------------------------- 
! Scalar Wave Contributions            
!---------------------------------------- 
! -- Su - Penguins            
! Propagator: Su, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcFdChaSuL(gt4,i3,iProp)
coup3R = cplcFdChaSuR(gt4,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcFdChaSuL(gt4,i3,iProp)
coup3R = cplcFdChaSuR(gt4,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcFdChaSuL(gt4,i3,iProp)
coup3R = cplcFdChaSuR(gt4,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-    & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-    & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 3 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcFdChaSuL(gt4,i3,iProp)
coup3R = cplcFdChaSuR(gt4,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcFdChaSuL(gt4,i3,iProp)
coup3R = cplcFdChaSuR(gt4,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 3 
Do iProp=1,6
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcFdChaSuL(gt4,i3,iProp)
coup3R = cplcFdChaSuR(gt4,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcFdChaSuL(gt4,i3,iProp)
coup3R = cplcFdChaSuR(gt4,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-    & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-    & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Fd,Ah, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplcFdFdAhL(i1,i3,i2)
coup2R = cplcFdFdAhR(i1,i3,i2)
coup1L = cplcFdFdAhL(gt4,i1,i2)
coup1R = cplcFdFdAhR(gt4,i1,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Sd,Chi, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,6
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplChiFdcSdL(i2,i3,i1)
coup2R = cplChiFdcSdR(i2,i3,i1)
coup1L = cplcFdChiSdL(gt4,i2,i1)
coup1R = cplcFdChiSdR(gt4,i2,i1)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Sd,Glu, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 4._dp/3._dp 
Do iProp=1,6
Do i1=1,6
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplGluFdcSdL(i3,i1)
coup2R = cplGluFdcSdR(i3,i1)
coup1L = cplcFdGluSdL(gt4,i1)
coup1R = cplcFdGluSdR(gt4,i1)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Fd,hh, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplcFdFdhhL(i1,i3,i2)
coup2R = cplcFdFdhhR(i1,i3,i2)
coup1L = cplcFdFdhhL(gt4,i1,i2)
coup1R = cplcFdFdhhR(gt4,i1,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Fd,VZ, Internal fermion: Fd
! Generic diagram: FVF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplcFdFdVZL(i1,i3)
coup2R = cplcFdFdVZR(i1,i3)
coup1L = cplcFdFdVZL(gt4,i1)
coup1R = cplcFdFdVZR(gt4,i1)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-    & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-    & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Su,bar[Cha], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,6
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplcChaFdcSuL(i2,i3,i1)
coup2R = cplcChaFdcSuR(i2,i3,i1)
coup1L = cplcFdChaSuL(gt4,i2,i1)
coup1R = cplcFdChaSuR(gt4,i2,i1)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Hpm,bar[Fu], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplcFuFdcHpmL(i2,i3,i1)
coup2R = cplcFuFdcHpmR(i2,i3,i1)
coup1L = cplcFdFuHpmL(gt4,i2,i1)
coup1R = cplcFdFuHpmR(gt4,i2,i1)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: VWm,bar[Fu], Internal fermion: Fd
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,6
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdChaSuL(i3,gt1,iProp)
coup3R = cplcFdChaSuR(i3,gt1,iProp)
coup2L = cplcFuFdcVWmL(i2,i3)
coup2R = cplcFuFdcVWmR(i2,i3)
coup1L = cplcFdFuVWmL(gt4,i2)
coup1R = cplcFdFuVWmR(gt4,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddVLR=PSOllddVLR+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddTLL=PSOllddTLL+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-    & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-    & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Fd, Internal fermion: bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdAhL(i2,gt3,i1)
coup1R = cplcFdFdAhR(i2,gt3,i1)
coup2L = cplcFdFdAhL(i3,i2,i1)
coup2R = cplcFdFdAhR(i3,i2,i1)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Sd, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i1,gt3,i2)
coup1R = cplChiFdcSdR(i1,gt3,i2)
coup2L = cplcFdChiSdL(i3,i1,i2)
coup2R = cplcFdChiSdR(i3,i1,i2)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Glu,Sd, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,3
If ((MGlu2.gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFdcSdL(gt3,i2)
coup1R = cplGluFdcSdR(gt3,i2)
coup2L = cplcFdGluSdL(i3,i2)
coup2R = cplcFdGluSdR(i3,i2)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Fd, Internal fermion: bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i2,gt3,i1)
coup1R = cplcFdFdhhR(i2,gt3,i1)
coup2L = cplcFdFdhhL(i3,i2,i1)
coup2R = cplcFdFdhhR(i3,i2,i1)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Fd, Internal fermion: bar[Fd]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdVZL(i2,gt3)
coup1R = cplcFdFdVZR(i2,gt3)
coup2L = cplcFdFdVZL(i3,i2)
coup2R = cplcFdFdVZR(i3,i2)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Su, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i1,gt3,i2)
coup1R = cplcChaFdcSuR(i1,gt3,i2)
coup2L = cplcFdChaSuL(i3,i1,i2)
coup2R = cplcFdChaSuR(i3,i1,i2)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],Hpm, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuHpmL(i3,i1,i2)
coup2R = cplcFdFuHpmR(i3,i1,i2)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],VWm, Internal fermion: bar[Fd]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuVWmL(i3,i1)
coup2R = cplcFdFuVWmR(i3,i1)
coup3L = cplcFdFdhhL(gt4,i3,iProp)
coup3R = cplcFdFdhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Ah, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplcFdFdAhL(i1,i3,i2)
coup2R = cplcFdFdAhR(i1,i3,i2)
coup1L = cplcFdFdAhL(gt4,i1,i2)
coup1R = cplcFdFdAhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Chi, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplChiFdcSdL(i2,i3,i1)
coup2R = cplChiFdcSdR(i2,i3,i1)
coup1L = cplcFdChiSdL(gt4,i2,i1)
coup1R = cplcFdChiSdR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Glu, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 4._dp/3._dp 
Do iProp=1,8
Do i1=1,6
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplGluFdcSdL(i3,i1)
coup2R = cplGluFdcSdR(i3,i1)
coup1L = cplcFdGluSdL(gt4,i1)
coup1R = cplcFdGluSdR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,hh, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplcFdFdhhL(i1,i3,i2)
coup2R = cplcFdFdhhR(i1,i3,i2)
coup1L = cplcFdFdhhL(gt4,i1,i2)
coup1R = cplcFdFdhhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,VZ, Internal fermion: Fd
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplcFdFdVZL(i1,i3)
coup2R = cplcFdFdVZR(i1,i3)
coup1L = cplcFdFdVZL(gt4,i1)
coup1R = cplcFdFdVZR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,bar[Cha], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplcChaFdcSuL(i2,i3,i1)
coup2R = cplcChaFdcSuR(i2,i3,i1)
coup1L = cplcFdChaSuL(gt4,i2,i1)
coup1R = cplcFdChaSuR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,bar[Fu], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplcFuFdcHpmL(i2,i3,i1)
coup2R = cplcFuFdcHpmR(i2,i3,i1)
coup1L = cplcFdFuHpmL(gt4,i2,i1)
coup1R = cplcFdFuHpmR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,bar[Fu], Internal fermion: Fd
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdhhL(i3,gt3,iProp)
coup3R = cplcFdFdhhR(i3,gt3,iProp)
coup2L = cplcFuFdcVWmL(i2,i3)
coup2R = cplcFuFdcVWmR(i2,i3)
coup1L = cplcFdFuVWmL(gt4,i2)
coup1R = cplcFdFuVWmR(gt4,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Fd, Internal fermion: bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdAhL(i2,gt3,i1)
coup1R = cplcFdFdAhR(i2,gt3,i1)
coup2L = cplcFdFdAhL(i3,i2,i1)
coup2R = cplcFdFdAhR(i3,i2,i1)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Sd, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i1,gt3,i2)
coup1R = cplChiFdcSdR(i1,gt3,i2)
coup2L = cplcFdChiSdL(i3,i1,i2)
coup2R = cplcFdChiSdR(i3,i1,i2)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Glu,Sd, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,3
If ((MGlu2.gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFdcSdL(gt3,i2)
coup1R = cplGluFdcSdR(gt3,i2)
coup2L = cplcFdGluSdL(i3,i2)
coup2R = cplcFdGluSdR(i3,i2)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Fd, Internal fermion: bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i2,gt3,i1)
coup1R = cplcFdFdhhR(i2,gt3,i1)
coup2L = cplcFdFdhhL(i3,i2,i1)
coup2R = cplcFdFdhhR(i3,i2,i1)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Fd, Internal fermion: bar[Fd]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdVZL(i2,gt3)
coup1R = cplcFdFdVZR(i2,gt3)
coup2L = cplcFdFdVZL(i3,i2)
coup2R = cplcFdFdVZR(i3,i2)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Su, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i1,gt3,i2)
coup1R = cplcChaFdcSuR(i1,gt3,i2)
coup2L = cplcFdChaSuL(i3,i1,i2)
coup2R = cplcFdChaSuR(i3,i1,i2)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],Hpm, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuHpmL(i3,i1,i2)
coup2R = cplcFdFuHpmR(i3,i1,i2)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],VWm, Internal fermion: bar[Fd]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuVWmL(i3,i1)
coup2R = cplcFdFuVWmR(i3,i1)
coup3L = cplcFdFdAhL(gt4,i3,iProp)
coup3R = cplcFdFdAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Ah, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplcFdFdAhL(i1,i3,i2)
coup2R = cplcFdFdAhR(i1,i3,i2)
coup1L = cplcFdFdAhL(gt4,i1,i2)
coup1R = cplcFdFdAhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Chi, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplChiFdcSdL(i2,i3,i1)
coup2R = cplChiFdcSdR(i2,i3,i1)
coup1L = cplcFdChiSdL(gt4,i2,i1)
coup1R = cplcFdChiSdR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Glu, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 4._dp/3._dp 
Do iProp=1,8
Do i1=1,6
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplGluFdcSdL(i3,i1)
coup2R = cplGluFdcSdR(i3,i1)
coup1L = cplcFdGluSdL(gt4,i1)
coup1R = cplcFdGluSdR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,hh, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplcFdFdhhL(i1,i3,i2)
coup2R = cplcFdFdhhR(i1,i3,i2)
coup1L = cplcFdFdhhL(gt4,i1,i2)
coup1R = cplcFdFdhhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,VZ, Internal fermion: Fd
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplcFdFdVZL(i1,i3)
coup2R = cplcFdFdVZR(i1,i3)
coup1L = cplcFdFdVZL(gt4,i1)
coup1R = cplcFdFdVZR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,bar[Cha], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplcChaFdcSuL(i2,i3,i1)
coup2R = cplcChaFdcSuR(i2,i3,i1)
coup1L = cplcFdChaSuL(gt4,i2,i1)
coup1R = cplcFdChaSuR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,bar[Fu], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplcFuFdcHpmL(i2,i3,i1)
coup2R = cplcFuFdcHpmR(i2,i3,i1)
coup1L = cplcFdFuHpmL(gt4,i2,i1)
coup1R = cplcFdFuHpmR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOllddSLL=PSOllddSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,bar[Fu], Internal fermion: Fd
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdAhL(i3,gt3,iProp)
coup3R = cplcFdFdAhR(i3,gt3,iProp)
coup2L = cplcFuFdcVWmL(i2,i3)
coup2R = cplcFuFdcVWmR(i2,i3)
coup1L = cplcFdFuVWmL(gt4,i2)
coup1R = cplcFdFuVWmR(gt4,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOllddSLL=PSOllddSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRR=PSOllddSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSRL=PSOllddSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddSLR=PSOllddSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 !---------------------------------------- 
! Scalar Penguin Contributions            
!---------------------------------------- 
! -- Su - Penguins            
! Propagator: Su, Loop particles: Ah,Cha,Fd
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,5
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcFdFdAhL(gt4,i3,i1)
coup2R = cplcFdFdAhR(gt4,i3,i1)
coup3L = cplcFdChaSuL(i3,i2,iProp)
coup3R = cplcFdChaSuR(i3,i2,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Chi,Hpm,Sd
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
  Do i2=1,8
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcFdChiSdL(gt4,i1,i3)
coup2R = cplcFdChiSdR(gt4,i1,i3)
coup3 = cplHpmSucSd(i2,iProp,i3)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: Chi,VWm,Sd
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcFdChiSdL(gt4,i1,i3)
coup2R = cplcFdChiSdR(gt4,i1,i3)
coup3 = -cplSucSdVWm(iProp,i3)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: hh,Cha,Fd
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,5
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcFdFdhhL(gt4,i3,i1)
coup2R = cplcFdFdhhR(gt4,i3,i1)
coup3L = cplcFdChaSuL(i3,i2,iProp)
coup3R = cplcFdChaSuR(i3,i2,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: VZ,Cha,Fd
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
  Do i2=1,5
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcFdFdVZL(gt4,i3)
coup2R = cplcFdFdVZR(gt4,i3)
coup3L = cplcFdChaSuL(i3,i2,iProp)
coup3R = cplcFdChaSuR(i3,i2,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(-1.*coup3L*Finite +   & 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(-1.*coup3R*Finite +   & 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(-1.*coup3R*Finite +   & 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  PSOllddVLR=PSOllddVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(-1.*coup3L*Finite +   & 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOllddTLL=PSOllddTLL+0.25*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.25*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Cha],Ah,Su
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
  Do i2=1,8
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcFdChaSuL(gt4,i1,i3)
coup2R = cplcFdChaSuR(gt4,i1,i3)
coup3 = cplAhSucSu(i2,iProp,i3)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Cha],hh,Su
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
  Do i2=1,8
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcFdChaSuL(gt4,i1,i3)
coup2R = cplcFdChaSuR(gt4,i1,i3)
coup3 = cplhhSucSu(i2,iProp,i3)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Cha],VZ,Su
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcFdChaSuL(gt4,i1,i3)
coup2R = cplcFdChaSuR(gt4,i1,i3)
coup3 = -cplSucSuVZ(iProp,i3)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Fd],conj[Su],Ah
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcFdFdAhL(gt4,i1,i3)
coup2R = cplcFdFdAhR(gt4,i1,i3)
coup3 = cplAhSucSu(i3,iProp,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Fd],conj[Su],hh
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplhhSucSu(i3,iProp,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Fd],conj[Su],VG
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 4._dp/3._dp 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcFdFdVGL(gt4,i1)
coup2R = cplcFdFdVGR(gt4,i1)
coup3 = -cplSucSuVG(iProp,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mV2 = 0.
mV22 = 0._dp
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOllddSLL=PSOllddSLL+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddVLR=PSOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddTLL=PSOllddTLL - 0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +  & 
&  int2*mF12)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR - 0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +  & 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Fd],conj[Su],VP
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcFdFdVPL(gt4,i1)
coup2R = cplcFdFdVPR(gt4,i1)
coup3 = -cplSucSuVP(iProp,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mV2 = 0.
mV22 = 0._dp
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOllddSLL=PSOllddSLL+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddVLR=PSOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddTLL=PSOllddTLL - 0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +  & 
&  int2*mF12)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR - 0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +  & 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Su, Loop particles: bar[Fd],conj[Su],VZ
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcFdFdVZL(gt4,i1)
coup2R = cplcFdFdVZR(gt4,i1)
coup3 = -cplSucSuVZ(iProp,i2)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOllddSLL=PSOllddSLL+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddVLR=PSOllddVLR+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOllddTLL=PSOllddTLL - 0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +  & 
&  int2*mF12)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR - 0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +  & 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Su, Loop particles: conj[Hpm],Chi,Fu
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,10
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcFdFuHpmL(gt4,i3,i1)
coup2R = cplcFdFuHpmR(gt4,i3,i1)
coup3L = cplcFuChiSuL(i3,i2,iProp)
coup3R = cplcFuChiSuR(i3,i2,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: conj[Sd],bar[Fu],Chi
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
Do i1=1,6
  Do i2=1,3
    Do i3=1,10
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcFdChiSdL(gt4,i3,i1)
coup2R = cplcFdChiSdR(gt4,i3,i1)
coup3L = cplcFuChiSuL(i2,i3,iProp)
coup3R = cplcFuChiSuR(i2,i3,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Su, Loop particles: conj[Sd],bar[Fu],Glu
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 4._dp/3._dp 
Do iProp=1,6
Do i1=1,6
  Do i2=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcFdGluSdL(gt4,i1)
coup2R = cplcFdGluSdR(gt4,i1)
coup3L = cplcFuGluSuL(i2,iProp)
coup3R = cplcFuGluSuR(i2,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MGlu
mF22 = MGlu2
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOllddVLR=PSOllddVLR - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLL=PSOllddTLL+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Su, Loop particles: conj[VWm],Chi,Fu
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
  Do i2=1,10
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcFdFuVWmL(gt4,i3)
coup2R = cplcFdFuVWmR(gt4,i3)
coup3L = cplcFuChiSuL(i3,i2,iProp)
coup3R = cplcFuChiSuR(i3,i2,iProp)
coup4L = cplcChaFdcSuL(gt2,gt3,iProp)
coup4R = cplcChaFdcSuR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(-1.*coup3L*Finite +   & 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(-1.*coup3R*Finite +   & 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+0.
  PSOllddSLR=PSOllddSLR+0.
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(-1.*coup3R*Finite +   & 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  PSOllddVLR=PSOllddVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(-1.*coup3L*Finite +   & 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOllddTLL=PSOllddTLL+0.25*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.25*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSOllddSLL=PSOllddSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSOllddSLL=PSOllddSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplhhSucSu(iProp,i3,i2)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,iProp)
coup3R = cplcFuFuhhR(i2,i3,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcFdFdhhL(gt4,gt3,iProp)
coup4R = cplcFdFdhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdAhL(i2,gt3,i1)
coup1R = cplcFdFdAhR(i2,gt3,i1)
coup2L = cplcFdFdAhL(gt4,i3,i1)
coup2R = cplcFdFdAhR(gt4,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i1,gt3,i2)
coup1R = cplChiFdcSdR(i1,gt3,i2)
coup2L = cplcFdChiSdL(gt4,i1,i3)
coup2R = cplcFdChiSdR(gt4,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Glu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,6
If ((MGlu2.gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFdcSdL(gt3,i2)
coup1R = cplGluFdcSdR(gt3,i2)
coup2L = cplcFdGluSdL(gt4,i3)
coup2R = cplcFdGluSdR(gt4,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i2,gt3,i1)
coup1R = cplcFdFdhhR(i2,gt3,i1)
coup2L = cplcFdFdhhL(gt4,i3,i1)
coup2R = cplcFdFdhhR(gt4,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Fd,Fd
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdVZL(i2,gt3)
coup1R = cplcFdFdVZR(i2,gt3)
coup2L = cplcFdFdVZL(gt4,i3)
coup2R = cplcFdFdVZR(gt4,i3)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i1,gt3,i2)
coup1R = cplcChaFdcSuR(i1,gt3,i2)
coup2L = cplcFdChaSuL(gt4,i1,i3)
coup2R = cplcFdChaSuR(gt4,i1,i3)
coup3 = cplhhSucSu(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdAhL(i1,gt3,i2)
coup1R = cplcFdFdAhR(i1,gt3,i2)
coup2L = cplcFdFdAhL(gt4,i1,i3)
coup2R = cplcFdFdAhR(gt4,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i1,gt3,i2)
coup1R = cplcFdFdhhR(i1,gt3,i2)
coup2L = cplcFdFdAhL(gt4,i1,i3)
coup2R = cplcFdFdAhR(gt4,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdVZL(i1,gt3)
coup1R = cplcFdFdVZR(i1,gt3)
coup2L = cplcFdFdAhL(gt4,i1,i3)
coup2R = cplcFdFdAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdAhL(i1,gt3,i2)
coup1R = cplcFdFdAhR(i1,gt3,i2)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i1,gt3,i2)
coup1R = cplcFdFdhhR(i1,gt3,i2)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdAhL(i1,gt3,i2)
coup1R = cplcFdFdAhR(i1,gt3,i2)
coup2L = cplcFdFdVZL(gt4,i1)
coup2R = cplcFdFdVZR(gt4,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdVZL(i1,gt3)
coup1R = cplcFdFdVZR(i1,gt3)
coup2L = cplcFdFdVZL(gt4,i1)
coup2R = cplcFdFdVZR(gt4,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSOllddSLL=PSOllddSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuHpmL(gt4,i1,i3)
coup2R = cplcFdFuHpmR(gt4,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuHpmL(gt4,i1,i3)
coup2R = cplcFdFuHpmR(gt4,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuVWmL(gt4,i1)
coup2R = cplcFdFuVWmR(gt4,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuVWmL(gt4,i1)
coup2R = cplcFdFuVWmR(gt4,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSOllddSLL=PSOllddSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcHpmL(i2,gt3,i1)
coup1R = cplcFuFdcHpmR(i2,gt3,i1)
coup2L = cplcFdFuHpmL(gt4,i3,i1)
coup2R = cplcFdFuHpmR(gt4,i3,i1)
coup3L = cplcFuFuhhL(i3,i2,iProp)
coup3R = cplcFuFuhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,10
If ((MSd2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i2,gt3,i1)
coup1R = cplChiFdcSdR(i2,gt3,i1)
coup2L = cplcFdChiSdL(gt4,i3,i1)
coup2R = cplcFdChiSdR(gt4,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Su],Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i2,gt3,i1)
coup1R = cplcChaFdcSuR(i2,gt3,i1)
coup2L = cplcFdChaSuL(gt4,i3,i1)
coup2R = cplcFdChaSuR(gt4,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Fu,Fu
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFdcVWmL(i2,gt3)
coup1R = cplcFuFdcVWmR(i2,gt3)
coup2L = cplcFdFuVWmL(gt4,i3)
coup2R = cplcFdFuVWmR(gt4,i3)
coup3L = cplcFuFuhhL(i3,i2,iProp)
coup3R = cplcFuFuhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplAhSucSu(iProp,i3,i2)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuAhL(i2,i3,iProp)
coup3R = cplcFuFuAhR(i2,i3,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcFdFdAhL(gt4,gt3,iProp)
coup4R = cplcFdFdAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdAhL(i2,gt3,i1)
coup1R = cplcFdFdAhR(i2,gt3,i1)
coup2L = cplcFdFdAhL(gt4,i3,i1)
coup2R = cplcFdFdAhR(gt4,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i1,gt3,i2)
coup1R = cplChiFdcSdR(i1,gt3,i2)
coup2L = cplcFdChiSdL(gt4,i1,i3)
coup2R = cplcFdChiSdR(gt4,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Glu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,6
If ((MGlu2.gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFdcSdL(gt3,i2)
coup1R = cplGluFdcSdR(gt3,i2)
coup2L = cplcFdGluSdL(gt4,i3)
coup2R = cplcFdGluSdR(gt4,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i2,gt3,i1)
coup1R = cplcFdFdhhR(i2,gt3,i1)
coup2L = cplcFdFdhhL(gt4,i3,i1)
coup2R = cplcFdFdhhR(gt4,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Fd,Fd
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdVZL(i2,gt3)
coup1R = cplcFdFdVZR(i2,gt3)
coup2L = cplcFdFdVZL(gt4,i3)
coup2R = cplcFdFdVZR(gt4,i3)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i1,gt3,i2)
coup1R = cplcChaFdcSuR(i1,gt3,i2)
coup2L = cplcFdChaSuL(gt4,i1,i3)
coup2R = cplcFdChaSuR(gt4,i1,i3)
coup3 = cplAhSucSu(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdAhL(i1,gt3,i2)
coup1R = cplcFdFdAhR(i1,gt3,i2)
coup2L = cplcFdFdAhL(gt4,i1,i3)
coup2R = cplcFdFdAhR(gt4,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i1,gt3,i2)
coup1R = cplcFdFdhhR(i1,gt3,i2)
coup2L = cplcFdFdAhL(gt4,i1,i3)
coup2R = cplcFdFdAhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdAhL(i1,gt3,i2)
coup1R = cplcFdFdAhR(i1,gt3,i2)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i1,gt3,i2)
coup1R = cplcFdFdhhR(i1,gt3,i2)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdVZL(i1,gt3)
coup1R = cplcFdFdVZR(i1,gt3)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i1,gt3,i2)
coup1R = cplcFdFdhhR(i1,gt3,i2)
coup2L = cplcFdFdVZL(gt4,i1)
coup2R = cplcFdFdVZR(gt4,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuHpmL(gt4,i1,i3)
coup2R = cplcFdFuHpmR(gt4,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuHpmL(gt4,i1,i3)
coup2R = cplcFdFuHpmR(gt4,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuVWmL(gt4,i1)
coup2R = cplcFdFuVWmR(gt4,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOllddSLL=PSOllddSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRR=PSOllddSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSRL=PSOllddSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddSLR=PSOllddSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i2,gt3,i1)
coup1R = cplcFuFdcHpmR(i2,gt3,i1)
coup2L = cplcFdFuHpmL(gt4,i3,i1)
coup2R = cplcFdFuHpmR(gt4,i3,i1)
coup3L = cplcFuFuAhL(i3,i2,iProp)
coup3R = cplcFuFuAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,10
If ((MSd2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i2,gt3,i1)
coup1R = cplChiFdcSdR(i2,gt3,i1)
coup2L = cplcFdChiSdL(gt4,i3,i1)
coup2R = cplcFdChiSdR(gt4,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Su],Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i2,gt3,i1)
coup1R = cplcChaFdcSuR(i2,gt3,i1)
coup2L = cplcFdChaSuL(gt4,i3,i1)
coup2R = cplcFdChaSuR(gt4,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOllddSLL=PSOllddSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Fu,Fu
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcVWmL(i2,gt3)
coup1R = cplcFuFdcVWmR(i2,gt3)
coup2L = cplcFdFuVWmL(gt4,i3)
coup2R = cplcFdFuVWmR(gt4,i3)
coup3L = cplcFuFuAhL(i3,i2,iProp)
coup3R = cplcFuFuAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOllddSLL=PSOllddSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSRR=PSOllddSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddSRL=PSOllddSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOllddSLR=PSOllddSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOllddVRR=PSOllddVRR+0.
  PSOllddVLL=PSOllddVLL+0.
  PSOllddVRL=PSOllddVRL+0.
  PSOllddVLR=PSOllddVLR+0.
  PSOllddTLL=PSOllddTLL+0.
  PSOllddTLR=PSOllddTLR+0.
  PSOllddTRL=PSOllddTRL+0.
  PSOllddTRR=PSOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 PSOllddSLL=oo16pi2*PSOllddSLL 
PSOllddSRR=oo16pi2*PSOllddSRR 
PSOllddSRL=oo16pi2*PSOllddSRL 
PSOllddSLR=oo16pi2*PSOllddSLR 
PSOllddVRR=oo16pi2*PSOllddVRR 
PSOllddVLL=oo16pi2*PSOllddVLL 
PSOllddVRL=oo16pi2*PSOllddVRL 
PSOllddVLR=oo16pi2*PSOllddVLR 
PSOllddTLL=oo16pi2*PSOllddTLL 
PSOllddTLR=oo16pi2*PSOllddTLR 
PSOllddTRL=oo16pi2*PSOllddTRL 
PSOllddTRR=oo16pi2*PSOllddTRR 
Iname=Iname-1

End Subroutine CalculatePengS2L2d 

Subroutine CalculatePengV2L2d(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVGL,              & 
& cplcFdFdVGR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,              & 
& cplcFdFuHpmR,cplcFdFuVWmL,cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,         & 
& cplcFuChiSuR,cplcFuFdcHpmL,cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,      & 
& cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFdcSdL,cplChiFdcSdR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL,cplGluFdcSdR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplHpmSucSd,cplSdcSdVP,            & 
& cplSdcSdVZ,cplSucSdVWm,cplSucSuVG,cplSucSuVP,cplSucSuVZ,PVOllddSLL,PVOllddSRR,         & 
& PVOllddSRL,PVOllddSLR,PVOllddVRR,PVOllddVLL,PVOllddVRL,PVOllddVLR,PVOllddTLL,          & 
& PVOllddTLR,PVOllddTRL,PVOllddTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengV2L2d 
! 'PreSARAH' output has been generated  at 19:29 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVGL(3,3),cplcFdFdVGR(3,3),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),  & 
& cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),            & 
& cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),            & 
& cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),     & 
& cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),           & 
& cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),& 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFdcSdL(10,3,6),cplChiFdcSdR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL(3,6),           & 
& cplGluFdcSdR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplHpmSucSd(8,6,6),cplSdcSdVP(6,6),  & 
& cplSdcSdVZ(6,6),cplSucSdVWm(6,6),cplSucSuVG(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PVOllddSLL 
Complex(dp), Intent(out) :: PVOllddSRR 
Complex(dp), Intent(out) :: PVOllddSRL 
Complex(dp), Intent(out) :: PVOllddSLR 
Complex(dp), Intent(out) :: PVOllddVRR 
Complex(dp), Intent(out) :: PVOllddVLL 
Complex(dp), Intent(out) :: PVOllddVRL 
Complex(dp), Intent(out) :: PVOllddVLR 
Complex(dp), Intent(out) :: PVOllddTLL 
Complex(dp), Intent(out) :: PVOllddTLR 
Complex(dp), Intent(out) :: PVOllddTRL 
Complex(dp), Intent(out) :: PVOllddTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengV2L2d' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFd(gt3)  
MassEx32=MFd2(gt3) 
MassEx4=MFd(gt4)  
MassEx42=MFd2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], DownQuark, bar[DownQuark]} 
 ! ------------------------------ 
 
PVOllddSLL=0._dp 
PVOllddSRR=0._dp 
PVOllddSRL=0._dp 
PVOllddSLR=0._dp 
PVOllddVRR=0._dp 
PVOllddVLL=0._dp 
PVOllddVRL=0._dp 
PVOllddVLR=0._dp 
PVOllddTLL=0._dp 
PVOllddTLR=0._dp 
PVOllddTRL=0._dp 
PVOllddTRR=0._dp 
!---------------------------------------- 
! Vector Wave Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Fd, Internal fermion: bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdAhL(i2,gt3,i1)
coup1R = cplcFdFdAhR(i2,gt3,i1)
coup2L = cplcFdFdAhL(i3,i2,i1)
coup2R = cplcFdFdAhR(i3,i2,i1)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Sd, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i1,gt3,i2)
coup1R = cplChiFdcSdR(i1,gt3,i2)
coup2L = cplcFdChiSdL(i3,i1,i2)
coup2R = cplcFdChiSdR(i3,i1,i2)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Glu,Sd, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 4._dp/3._dp 
  Do i2=1,6
    Do i3=1,3
If ((MGlu2.gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFdcSdL(gt3,i2)
coup1R = cplGluFdcSdR(gt3,i2)
coup2L = cplcFdGluSdL(i3,i2)
coup2R = cplcFdGluSdR(i3,i2)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Fd, Internal fermion: bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i2,gt3,i1)
coup1R = cplcFdFdhhR(i2,gt3,i1)
coup2L = cplcFdFdhhL(i3,i2,i1)
coup2R = cplcFdFdhhR(i3,i2,i1)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Fd, Internal fermion: bar[Fd]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdVZL(i2,gt3)
coup1R = cplcFdFdVZR(i2,gt3)
coup2L = cplcFdFdVZL(i3,i2)
coup2R = cplcFdFdVZR(i3,i2)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Su, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i1,gt3,i2)
coup1R = cplcChaFdcSuR(i1,gt3,i2)
coup2L = cplcFdChaSuL(i3,i1,i2)
coup2R = cplcFdChaSuR(i3,i1,i2)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],Hpm, Internal fermion: bar[Fd]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuHpmL(i3,i1,i2)
coup2R = cplcFdFuHpmR(i3,i1,i2)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],VWm, Internal fermion: bar[Fd]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,3
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuVWmL(i3,i1)
coup2R = cplcFdFuVWmR(i3,i1)
coup3L = cplcFdFdVZL(gt4,i3)
coup3R = cplcFdFdVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt3)
MFin2 = MFd2(i3)-MFd2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Ah, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplcFdFdAhL(i1,i3,i2)
coup2R = cplcFdFdAhR(i1,i3,i2)
coup1L = cplcFdFdAhL(gt4,i1,i2)
coup1R = cplcFdFdAhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Chi, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplChiFdcSdL(i2,i3,i1)
coup2R = cplChiFdcSdR(i2,i3,i1)
coup1L = cplcFdChiSdL(gt4,i2,i1)
coup1R = cplcFdChiSdR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Glu, Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 4._dp/3._dp 
Do i1=1,6
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplGluFdcSdL(i3,i1)
coup2R = cplGluFdcSdR(i3,i1)
coup1L = cplcFdGluSdL(gt4,i1)
coup1R = cplcFdGluSdR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,hh, Internal fermion: Fd
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplcFdFdhhL(i1,i3,i2)
coup2R = cplcFdFdhhR(i1,i3,i2)
coup1L = cplcFdFdhhL(gt4,i1,i2)
coup1R = cplcFdFdhhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,VZ, Internal fermion: Fd
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplcFdFdVZL(i1,i3)
coup2R = cplcFdFdVZR(i1,i3)
coup1L = cplcFdFdVZL(gt4,i1)
coup1R = cplcFdFdVZR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,bar[Cha], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplcChaFdcSuL(i2,i3,i1)
coup2R = cplcChaFdcSuR(i2,i3,i1)
coup1L = cplcFdChaSuL(gt4,i2,i1)
coup1R = cplcFdChaSuR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,bar[Fu], Internal fermion: Fd
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplcFuFdcHpmL(i2,i3,i1)
coup2R = cplcFuFdcHpmR(i2,i3,i1)
coup1L = cplcFdFuHpmL(gt4,i2,i1)
coup1R = cplcFdFuHpmR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,bar[Fu], Internal fermion: Fd
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcFdFdVZL(i3,gt3)
coup3R = cplcFdFdVZR(i3,gt3)
coup2L = cplcFuFdcVWmL(i2,i3)
coup2R = cplcFuFdcVWmR(i2,i3)
coup1L = cplcFdFuVWmL(gt4,i2)
coup1R = cplcFdFuVWmR(gt4,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFd(i3)-MFd(gt4)
MFin2 = MFd2(i3)-MFd2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFd(i3)
MFin2 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddVLL=PVOllddVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddVRL=PVOllddVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddVLR=PVOllddVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 !---------------------------------------- 
! Vector Penguin Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV22, mV12)
  int3=C0check(mF12, mV22, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcFdFdVZL(gt4,gt3)
coup4R = cplcFdFdVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdAhL(i2,gt3,i1)
coup1R = cplcFdFdAhR(i2,gt3,i1)
coup2L = cplcFdFdAhL(gt4,i3,i1)
coup2R = cplcFdFdAhR(gt4,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
  Do i2=1,6
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i1,gt3,i2)
coup1R = cplChiFdcSdR(i1,gt3,i2)
coup2L = cplcFdChiSdL(gt4,i1,i3)
coup2R = cplcFdChiSdR(gt4,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Glu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 4._dp/3._dp 
  Do i2=1,6
    Do i3=1,6
If ((MGlu2.gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFdcSdL(gt3,i2)
coup1R = cplGluFdcSdR(gt3,i2)
coup2L = cplcFdGluSdL(gt4,i3)
coup2R = cplcFdGluSdR(gt4,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i2,gt3,i1)
coup1R = cplcFdFdhhR(i2,gt3,i1)
coup2L = cplcFdFdhhL(gt4,i3,i1)
coup2R = cplcFdFdhhR(gt4,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Fd,Fd
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFdVZL(i2,gt3)
coup1R = cplcFdFdVZR(i2,gt3)
coup2L = cplcFdFdVZL(gt4,i3)
coup2R = cplcFdFdVZR(gt4,i3)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,6
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i1,gt3,i2)
coup1R = cplcChaFdcSuR(i1,gt3,i2)
coup2L = cplcFdChaSuL(gt4,i1,i3)
coup2R = cplcFdChaSuR(gt4,i1,i3)
coup3 = -cplSucSuVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i1,gt3,i2)
coup1R = cplcFdFdhhR(i1,gt3,i2)
coup2L = cplcFdFdAhL(gt4,i1,i3)
coup2R = cplcFdFdAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdAhL(i1,gt3,i2)
coup1R = cplcFdFdAhR(i1,gt3,i2)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdVZL(i1,gt3)
coup1R = cplcFdFdVZR(i1,gt3)
coup2L = cplcFdFdhhL(gt4,i1,i3)
coup2R = cplcFdFdhhR(gt4,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFdhhL(i1,gt3,i2)
coup1R = cplcFdFdhhR(i1,gt3,i2)
coup2L = cplcFdFdVZL(gt4,i1)
coup2R = cplcFdFdVZR(gt4,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuHpmL(gt4,i1,i3)
coup2R = cplcFdFuHpmR(gt4,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOllddVLL=PVOllddVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOllddVRL=PVOllddVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOllddVLR=PVOllddVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuHpmL(gt4,i1,i3)
coup2R = cplcFdFuHpmR(gt4,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i1,gt3,i2)
coup1R = cplcFuFdcHpmR(i1,gt3,i2)
coup2L = cplcFdFuVWmL(gt4,i1)
coup2R = cplcFdFuVWmR(gt4,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcVWmL(i1,gt3)
coup1R = cplcFuFdcVWmR(i1,gt3)
coup2L = cplcFdFuVWmL(gt4,i1)
coup2R = cplcFdFuVWmR(gt4,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV12, mV22)
  int3=C0check(mF12, mV12, mV22)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcHpmL(i2,gt3,i1)
coup1R = cplcFuFdcHpmR(i2,gt3,i1)
coup2L = cplcFdFuHpmL(gt4,i3,i1)
coup2R = cplcFdFuHpmR(gt4,i3,i1)
coup3L = cplcFuFuVZL(i3,i2)
coup3R = cplcFuFuVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,6
  Do i2=1,10
    Do i3=1,10
If ((MSd2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFdcSdL(i2,gt3,i1)
coup1R = cplChiFdcSdR(i2,gt3,i1)
coup2L = cplcFdChiSdL(gt4,i3,i1)
coup2R = cplcFdChiSdR(gt4,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Su],Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,6
  Do i2=1,5
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(i2,gt3,i1)
coup1R = cplcChaFdcSuR(i2,gt3,i1)
coup2L = cplcFdChaSuL(gt4,i3,i1)
coup2R = cplcFdChaSuR(gt4,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Fu,Fu
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFdcVWmL(i2,gt3)
coup1R = cplcFuFdcVWmR(i2,gt3)
coup2L = cplcFdFuVWmL(gt4,i3)
coup2R = cplcFdFuVWmR(gt4,i3)
coup3L = cplcFuFuVZL(i3,i2)
coup3R = cplcFuFuVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOllddSLL=PVOllddSLL+0.
  PVOllddSRR=PVOllddSRR+0.
  PVOllddSRL=PVOllddSRL+0.
  PVOllddSLR=PVOllddSLR+0.
  PVOllddVRR=PVOllddVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddVLL=PVOllddVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddVRL=PVOllddVRL - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOllddVLR=PVOllddVLR - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOllddTLL=PVOllddTLL+0.
  PVOllddTLR=PVOllddTLR+0.
  PVOllddTRL=PVOllddTRL+0.
  PVOllddTRR=PVOllddTRR+0.
  End if 
End if 
   End Do 
  End Do 


 PVOllddSLL=oo16pi2*PVOllddSLL
PVOllddSRR=oo16pi2*PVOllddSRR
PVOllddSRL=oo16pi2*PVOllddSRL
PVOllddSLR=oo16pi2*PVOllddSLR
PVOllddVRR=oo16pi2*PVOllddVRR
PVOllddVLL=oo16pi2*PVOllddVLL
PVOllddVRL=oo16pi2*PVOllddVRL
PVOllddVLR=oo16pi2*PVOllddVLR
PVOllddTLL=oo16pi2*PVOllddTLL
PVOllddTLR=oo16pi2*PVOllddTLR
PVOllddTRL=oo16pi2*PVOllddTRL
PVOllddTRR=oo16pi2*PVOllddTRR
Iname=Iname-1

End Subroutine CalculatePengV2L2d 

Subroutine CalculateTreeS2L2d(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVGL,              & 
& cplcFdFdVGR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,              & 
& cplcFdFuHpmR,cplcFdFuVWmL,cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,         & 
& cplcFuChiSuR,cplcFuFdcHpmL,cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,      & 
& cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFdcSdL,cplChiFdcSdR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL,cplGluFdcSdR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplHpmSucSd,cplSdcSdVP,            & 
& cplSdcSdVZ,cplSucSdVWm,cplSucSuVG,cplSucSuVP,cplSucSuVZ,TSOllddSLL,TSOllddSRR,         & 
& TSOllddSRL,TSOllddSLR,TSOllddVRR,TSOllddVLL,TSOllddVRL,TSOllddVLR,TSOllddTLL,          & 
& TSOllddTLR,TSOllddTRL,TSOllddTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeS2L2d 
! 'PreSARAH' output has been generated  at 19:29 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVGL(3,3),cplcFdFdVGR(3,3),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),  & 
& cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),            & 
& cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),            & 
& cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),     & 
& cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),           & 
& cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),& 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFdcSdL(10,3,6),cplChiFdcSdR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL(3,6),           & 
& cplGluFdcSdR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplHpmSucSd(8,6,6),cplSdcSdVP(6,6),  & 
& cplSdcSdVZ(6,6),cplSucSdVWm(6,6),cplSucSuVG(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TSOllddSLL 
Complex(dp), Intent(out) :: TSOllddSRR 
Complex(dp), Intent(out) :: TSOllddSRL 
Complex(dp), Intent(out) :: TSOllddSLR 
Complex(dp), Intent(out) :: TSOllddVRR 
Complex(dp), Intent(out) :: TSOllddVLL 
Complex(dp), Intent(out) :: TSOllddVRL 
Complex(dp), Intent(out) :: TSOllddVLR 
Complex(dp), Intent(out) :: TSOllddTLL 
Complex(dp), Intent(out) :: TSOllddTLR 
Complex(dp), Intent(out) :: TSOllddTRL 
Complex(dp), Intent(out) :: TSOllddTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeS2L2d' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFd(gt3)  
MassEx32=MFd2(gt3) 
MassEx4=MFd(gt4)  
MassEx42=MFd2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], DownQuark, bar[DownQuark]} 
 ! ------------------------------ 
 
TSOllddSLL=0._dp 
TSOllddSRR=0._dp 
TSOllddSRL=0._dp 
TSOllddSLR=0._dp 
TSOllddVRR=0._dp 
TSOllddVLL=0._dp 
TSOllddVRL=0._dp 
TSOllddVLR=0._dp 
TSOllddTLL=0._dp 
TSOllddTLR=0._dp 
TSOllddTRL=0._dp 
TSOllddTRR=0._dp 
!---------------------------------------- 
! Scalar Tree Contributions            
!---------------------------------------- 
! -- Su - Tree            
! Propagator: VZ
! InsertionOrder: 3
chargefactor = 1 
Do iProp=1,6
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(gt4,gt1,iProp)
coup1R = cplcFdChaSuR(gt4,gt1,iProp)
coup2L = cplcChaFdcSuL(gt2,gt3,iProp)
coup2R = cplcChaFdcSuR(gt2,gt3,iProp)
! Propagator and inverse propagator mass 
MP = MSu(iProp)
MP2 = MSu2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSOllddSLL=TSOllddSLL-0.5*coup1L*coup2L*IMP2
  TSOllddSRR=TSOllddSRR-0.5*coup1R*coup2R*IMP2
  TSOllddSRL=TSOllddSRL+ 0.
  TSOllddSLR=TSOllddSLR+ 0.
  TSOllddVRR=TSOllddVRR+ 0.
  TSOllddVLL=TSOllddVLL+ 0.
  TSOllddVRL=TSOllddVRL-0.5*coup1R*coup2L*IMP2
  TSOllddVLR=TSOllddVLR-0.5*coup1L*coup2R*IMP2
  TSOllddTLL=TSOllddTLL+ 0.125*coup1L*coup2L*IMP2
  TSOllddTLR=TSOllddTLR+ 0.
  TSOllddTRL=TSOllddTRL+ 0.
  TSOllddTRR=TSOllddTRR+ 0.125*coup1R*coup2R*IMP2
 End if 
End Do 


 ! -- hh - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,gt1,iProp)
coup1R = cplcChaChahhR(gt2,gt1,iProp)
coup2L = cplcFdFdhhL(gt4,gt3,iProp)
coup2R = cplcFdFdhhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSOllddSLL=TSOllddSLL+ 1*coup1L*coup2L*IMP2
  TSOllddSRR=TSOllddSRR+ 1*coup1R*coup2R*IMP2
  TSOllddSRL=TSOllddSRL+ 1*coup1R*coup2L*IMP2
  TSOllddSLR=TSOllddSLR+ 1*coup1L*coup2R*IMP2
  TSOllddVRR=TSOllddVRR+ 0.
  TSOllddVLL=TSOllddVLL+ 0.
  TSOllddVRL=TSOllddVRL+ 0.
  TSOllddVLR=TSOllddVLR+ 0.
  TSOllddTLL=TSOllddTLL+ 0.
  TSOllddTLR=TSOllddTLR+ 0.
  TSOllddTRL=TSOllddTRL+ 0.
  TSOllddTRR=TSOllddTRR+ 0.
 End if 
End Do 


 ! -- Ah - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (((iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,gt1,iProp)
coup1R = cplcChaChaAhR(gt2,gt1,iProp)
coup2L = cplcFdFdAhL(gt4,gt3,iProp)
coup2R = cplcFdFdAhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSOllddSLL=TSOllddSLL+ 1*coup1L*coup2L*IMP2
  TSOllddSRR=TSOllddSRR+ 1*coup1R*coup2R*IMP2
  TSOllddSRL=TSOllddSRL+ 1*coup1R*coup2L*IMP2
  TSOllddSLR=TSOllddSLR+ 1*coup1L*coup2R*IMP2
  TSOllddVRR=TSOllddVRR+ 0.
  TSOllddVLL=TSOllddVLL+ 0.
  TSOllddVRL=TSOllddVRL+ 0.
  TSOllddVLR=TSOllddVLR+ 0.
  TSOllddTLL=TSOllddTLL+ 0.
  TSOllddTLR=TSOllddTLR+ 0.
  TSOllddTRL=TSOllddTRL+ 0.
  TSOllddTRR=TSOllddTRR+ 0.
 End if 
End Do 


 Iname=Iname-1

End Subroutine CalculateTreeS2L2d 

Subroutine CalculateTreeV2L2d(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVGL,              & 
& cplcFdFdVGR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,              & 
& cplcFdFuHpmR,cplcFdFuVWmL,cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,         & 
& cplcFuChiSuR,cplcFuFdcHpmL,cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,      & 
& cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFdcSdL,cplChiFdcSdR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL,cplGluFdcSdR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplHpmSucSd,cplSdcSdVP,            & 
& cplSdcSdVZ,cplSucSdVWm,cplSucSuVG,cplSucSuVP,cplSucSuVZ,TVOllddSLL,TVOllddSRR,         & 
& TVOllddSRL,TVOllddSLR,TVOllddVRR,TVOllddVLL,TVOllddVRL,TVOllddVLR,TVOllddTLL,          & 
& TVOllddTLR,TVOllddTRL,TVOllddTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeV2L2d 
! 'PreSARAH' output has been generated  at 19:29 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVGL(3,3),cplcFdFdVGR(3,3),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),  & 
& cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),            & 
& cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),            & 
& cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),     & 
& cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),           & 
& cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),& 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFdcSdL(10,3,6),cplChiFdcSdR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFdcSdL(3,6),           & 
& cplGluFdcSdR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplHpmSucSd(8,6,6),cplSdcSdVP(6,6),  & 
& cplSdcSdVZ(6,6),cplSucSdVWm(6,6),cplSucSuVG(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TVOllddSLL 
Complex(dp), Intent(out) :: TVOllddSRR 
Complex(dp), Intent(out) :: TVOllddSRL 
Complex(dp), Intent(out) :: TVOllddSLR 
Complex(dp), Intent(out) :: TVOllddVRR 
Complex(dp), Intent(out) :: TVOllddVLL 
Complex(dp), Intent(out) :: TVOllddVRL 
Complex(dp), Intent(out) :: TVOllddVLR 
Complex(dp), Intent(out) :: TVOllddTLL 
Complex(dp), Intent(out) :: TVOllddTLR 
Complex(dp), Intent(out) :: TVOllddTRL 
Complex(dp), Intent(out) :: TVOllddTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeV2L2d' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFd(gt3)  
MassEx32=MFd2(gt3) 
MassEx4=MFd(gt4)  
MassEx42=MFd2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], DownQuark, bar[DownQuark]} 
 ! ------------------------------ 
 
TVOllddSLL=0._dp 
TVOllddSRR=0._dp 
TVOllddSRL=0._dp 
TVOllddSLR=0._dp 
TVOllddVRR=0._dp 
TVOllddVLL=0._dp 
TVOllddVRL=0._dp 
TVOllddVLR=0._dp 
TVOllddTLL=0._dp 
TVOllddTLR=0._dp 
TVOllddTRL=0._dp 
TVOllddTRR=0._dp 
!---------------------------------------- 
! Vector Tree Contributions            
!---------------------------------------- 
! -- VZ - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(gt2,gt1)
coup1R = cplcChaChaVZR(gt2,gt1)
coup2L = cplcFdFdVZL(gt4,gt3)
coup2R = cplcFdFdVZR(gt4,gt3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TVOllddSLL=TVOllddSLL+ 0.
  TVOllddSRR=TVOllddSRR+ 0.
  TVOllddSRL=TVOllddSRL+ 0.
  TVOllddSLR=TVOllddSLR+ 0.
  TVOllddVRR=TVOllddVRR-1*coup1R*coup2R*IMP2
  TVOllddVLL=TVOllddVLL-1*coup1L*coup2L*IMP2
  TVOllddVRL=TVOllddVRL-1*coup1R*coup2L*IMP2
  TVOllddVLR=TVOllddVLR-1*coup1L*coup2R*IMP2
  TVOllddTLL=TVOllddTLL+ 0.
  TVOllddTLR=TVOllddTLR+ 0.
  TVOllddTRL=TVOllddTRL+ 0.
  TVOllddTRR=TVOllddTRR+ 0.
 End if 


 Iname=Iname-1

End Subroutine CalculateTreeV2L2d 

Subroutine CalculateBox2L2u(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,               & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,              & 
& cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,cplcFdFuHpmR,cplcFdFuVWmL,            & 
& cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,cplcFuChiSuR,cplcFuFdcHpmL,        & 
& cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,         & 
& cplcFuFuhhR,cplcFuFuVGL,cplcFuFuVGR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFucSuL,cplChiFucSuR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL,cplGluFucSuR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplSdcHpmcSu,cplSdcSdVG,           & 
& cplSdcSdVP,cplSdcSdVZ,cplSdcSucVWm,cplSucSuVP,cplSucSuVZ,BOlluuSLL,BOlluuSRR,          & 
& BOlluuSRL,BOlluuSLR,BOlluuVRR,BOlluuVLL,BOlluuVRL,BOlluuVLR,BOlluuTLL,BOlluuTLR,       & 
& BOlluuTRL,BOlluuTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process Box2L2u 
! 'PreSARAH' output has been generated  at 19:36 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),& 
& cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),             & 
& cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),      & 
& cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),         & 
& cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVGL(3,3),             & 
& cplcFuFuVGR(3,3),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),  & 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFucSuL(10,3,6),cplChiFucSuR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL(3,6),           & 
& cplGluFucSuR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplSdcHpmcSu(6,8,6),cplSdcSdVG(6,6), & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSdcSucVWm(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: BOlluuSLL 
Complex(dp), Intent(out) :: BOlluuSRR 
Complex(dp), Intent(out) :: BOlluuSRL 
Complex(dp), Intent(out) :: BOlluuSLR 
Complex(dp), Intent(out) :: BOlluuVRR 
Complex(dp), Intent(out) :: BOlluuVLL 
Complex(dp), Intent(out) :: BOlluuVRL 
Complex(dp), Intent(out) :: BOlluuVLR 
Complex(dp), Intent(out) :: BOlluuTLL 
Complex(dp), Intent(out) :: BOlluuTLR 
Complex(dp), Intent(out) :: BOlluuTRL 
Complex(dp), Intent(out) :: BOlluuTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateBox2L2u' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFu(gt3)  
MassEx32=MFu2(gt3) 
MassEx4=MFu(gt4)  
MassEx42=MFu2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], UpQuark, bar[UpQuark]} 
 ! ------------------------------ 
 
BOlluuSLL=0._dp 
BOlluuSRR=0._dp 
BOlluuSRL=0._dp 
BOlluuSLR=0._dp 
BOlluuVRR=0._dp 
BOlluuVLL=0._dp 
BOlluuVRL=0._dp 
BOlluuVLR=0._dp 
BOlluuTLL=0._dp 
BOlluuTLR=0._dp 
BOlluuTRL=0._dp 
BOlluuTRR=0._dp 
!----------------------------- 
! Box Contributions            
!----------------------------- 
! Cha,Ah,Fu,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(i3,gt3,i2)
coup3R = cplcFuFuAhR(i3,gt3,i2)
coup4L = cplcFuFuAhL(gt4,i3,i4)
coup4R = cplcFuFuAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Fu,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(i3,gt3,i2)
coup3R = cplcFuFuhhR(i3,gt3,i2)
coup4L = cplcFuFuAhL(gt4,i3,i4)
coup4R = cplcFuFuAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Fu,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(i3,gt3)
coup3R = cplcFuFuVPR(i3,gt3)
coup4L = cplcFuFuAhL(gt4,i3,i4)
coup4R = cplcFuFuAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Fu,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup4L = cplcFuFuAhL(gt4,i3,i4)
coup4R = cplcFuFuAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Hpm,Chi,Su,Chi
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplChiFucSuL(i2,gt3,i3)
coup3R = cplChiFucSuR(i2,gt3,i3)
coup4L = cplcFuChiSuL(gt4,i4,i3)
coup4R = cplcFuChiSuR(gt4,i4,i3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLR=BOlluuVLR+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuTLL=BOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VWm,Chi,Su,Chi
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplChiFucSuL(i2,gt3,i3)
coup3R = cplChiFucSuR(i2,gt3,i3)
coup4L = cplcFuChiSuL(gt4,i4,i3)
coup4R = cplcFuChiSuR(gt4,i4,i3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BOlluuSLL=BOlluuSLL+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 -       & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BOlluuSRR=BOlluuSRR+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 -       & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BOlluuSRL=BOlluuSRL+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +           & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BOlluuSLR=BOlluuSLR+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -               & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -           & 
&  2.*int2)
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -           & 
&  2.*int2)
  BOlluuTLL=BOlluuTLL+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Cha,Ah,Fu,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(i3,gt3,i2)
coup3R = cplcFuFuAhR(i3,gt3,i2)
coup4L = cplcFuFuhhL(gt4,i3,i4)
coup4R = cplcFuFuhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Fu,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(i3,gt3,i2)
coup3R = cplcFuFuhhR(i3,gt3,i2)
coup4L = cplcFuFuhhL(gt4,i3,i4)
coup4R = cplcFuFuhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Fu,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(i3,gt3)
coup3R = cplcFuFuVPR(i3,gt3)
coup4L = cplcFuFuhhL(gt4,i3,i4)
coup4R = cplcFuFuhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Fu,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup4L = cplcFuFuhhL(gt4,i3,i4)
coup4R = cplcFuFuhhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,Ah,Fu,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(i3,gt3,i2)
coup3R = cplcFuFuAhR(i3,gt3,i2)
coup4L = cplcFuFuVPL(gt4,i3)
coup4R = cplcFuFuVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Fu,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(i3,gt3,i2)
coup3R = cplcFuFuhhR(i3,gt3,i2)
coup4L = cplcFuFuVPL(gt4,i3)
coup4R = cplcFuFuVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Fu,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(i3,gt3)
coup3R = cplcFuFuVPR(i3,gt3)
coup4L = cplcFuFuVPL(gt4,i3)
coup4R = cplcFuFuVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOlluuVRR=BOlluuVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOlluuVLL=BOlluuVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOlluuVRL=BOlluuVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Fu,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup4L = cplcFuFuVPL(gt4,i3)
coup4R = cplcFuFuVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOlluuVRR=BOlluuVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOlluuVLL=BOlluuVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOlluuVRL=BOlluuVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,Fu,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(i3,gt3,i2)
coup3R = cplcFuFuAhR(i3,gt3,i2)
coup4L = cplcFuFuVZL(gt4,i3)
coup4R = cplcFuFuVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Fu,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(i3,gt3,i2)
coup3R = cplcFuFuhhR(i3,gt3,i2)
coup4L = cplcFuFuVZL(gt4,i3)
coup4R = cplcFuFuVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSRR=BOlluuSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -             & 
&  2.*int2)
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -             & 
&  2.*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Fu,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(i3,gt3)
coup3R = cplcFuFuVPR(i3,gt3)
coup4L = cplcFuFuVZL(gt4,i3)
coup4R = cplcFuFuVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOlluuVRR=BOlluuVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOlluuVLL=BOlluuVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOlluuVRL=BOlluuVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Fu,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup4L = cplcFuFuVZL(gt4,i3)
coup4R = cplcFuFuVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BOlluuVRR=BOlluuVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -           & 
&  3.*int2)
  BOlluuVLL=BOlluuVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -           & 
&  3.*int2)
  BOlluuVRL=BOlluuVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! conj[Su],bar[Fd],conj[Hpm],bar[Fd]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
    Do i3=1,8
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdFuHpmL(i2,gt3,i3)
coup3R = cplcFdFuHpmR(i2,gt3,i3)
coup4L = cplcFuFdcHpmL(gt4,i4,i3)
coup4R = cplcFuFdcHpmR(gt4,i4,i3)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLR=BOlluuVLR+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuTLL=BOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! conj[Su],bar[Fd],conj[VWm],bar[Fd]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdFuVWmL(i2,gt3)
coup3R = cplcFdFuVWmR(i2,gt3)
coup4L = cplcFuFdcVWmL(gt4,i4)
coup4R = cplcFuFdcVWmR(gt4,i4)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mV2 = MVWm
mV22 = MVWm2
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BOlluuSLL=BOlluuSLL+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 -       & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BOlluuSRR=BOlluuSRR+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 -       & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BOlluuSRL=BOlluuSRL+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -               & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BOlluuSLR=BOlluuSLR+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +           & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -           & 
&  2.*int2)
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -           & 
&  2.*int2)
  BOlluuTLL=BOlluuTLL+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -     & 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -     & 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! bar[Fu],conj[Sd],bar[Cha],conj[Sd]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(gt2,i1,i2)
coup2R = cplcChacFuSdR(gt2,i1,i2)
coup3L = cplChaFucSdL(i3,gt3,i2)
coup3R = cplChaFucSdR(i3,gt3,i2)
coup4L = cplcChacFuSdL(i3,gt4,i4)
coup4R = cplcChacFuSdR(i3,gt4,i4)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,Ah,bar[Fu],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(gt4,i3,i2)
coup3R = cplcFuFuAhR(gt4,i3,i2)
coup4L = cplcFuFuAhL(i3,gt3,i4)
coup4R = cplcFuFuAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Fu],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(gt4,i3,i2)
coup3R = cplcFuFuhhR(gt4,i3,i2)
coup4L = cplcFuFuAhL(i3,gt3,i4)
coup4R = cplcFuFuAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Fu],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(gt4,i3)
coup3R = cplcFuFuVPR(gt4,i3)
coup4L = cplcFuFuAhL(i3,gt3,i4)
coup4R = cplcFuFuAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Fu],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcFuFuAhL(i3,gt3,i4)
coup4R = cplcFuFuAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Hpm,Chi,conj[Su],Chi
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,8
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplcFuChiSuL(gt4,i2,i3)
coup3R = cplcFuChiSuR(gt4,i2,i3)
coup4L = cplChiFucSuL(i4,gt3,i3)
coup4R = cplChiFucSuR(i4,gt3,i3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VWm,Chi,conj[Su],Chi
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 2
  Do i2=1,10
    Do i3=1,6
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplcFuChiSuL(gt4,i2,i3)
coup3R = cplcFuChiSuR(gt4,i2,i3)
coup4L = cplChiFucSuL(i4,gt3,i3)
coup4R = cplChiFucSuR(i4,gt3,i3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mV12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mV12, mS22)
  BOlluuSLL=BOlluuSLL - 8.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 8.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Sd,Fu,Ah,Fu
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,6
  Do i2=1,3
    Do i3=1,8
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplcFuFuAhL(gt4,i2,i3)
coup3R = cplcFuFuAhR(gt4,i2,i3)
coup4L = cplcFuFuAhL(i4,gt3,i3)
coup4R = cplcFuFuAhR(i4,gt3,i3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Sd,Fu,hh,Fu
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,6
  Do i2=1,3
    Do i3=1,8
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplcFuFuhhL(gt4,i2,i3)
coup3R = cplcFuFuhhR(gt4,i2,i3)
coup4L = cplcFuFuhhL(i4,gt3,i3)
coup4R = cplcFuFuhhR(i4,gt3,i3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Sd,Fu,VG,Fu
chargefactor = 4._dp/3._dp 
! Generic diagram: SFFV,  InsertionOrder: 2
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplcFuFuVGL(gt4,i2)
coup3R = cplcFuFuVGR(gt4,i2)
coup4L = cplcFuFuVGL(i4,gt3)
coup4R = cplcFuFuVGR(i4,gt3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF12, mF22, mS12, mV22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mV22)
  BOlluuSLL=BOlluuSLL - 8.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 8.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Sd,Fu,VP,Fu
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 2
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplcFuFuVPL(gt4,i2)
coup3R = cplcFuFuVPR(gt4,i2)
coup4L = cplcFuFuVPL(i4,gt3)
coup4R = cplcFuFuVPR(i4,gt3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF12, mF22, mS12, mV22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mV22)
  BOlluuSLL=BOlluuSLL - 8.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 8.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Sd,Fu,VZ,Fu
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 2
Do i1=1,6
  Do i2=1,3
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplcFuFuVZL(gt4,i2)
coup3R = cplcFuFuVZR(gt4,i2)
coup4L = cplcFuFuVZL(i4,gt3)
coup4R = cplcFuFuVZR(i4,gt3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF12, mF22, mS12, mV22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mV22)
  BOlluuSLL=BOlluuSLL - 8.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 8.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Cha,Ah,bar[Fu],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(gt4,i3,i2)
coup3R = cplcFuFuAhR(gt4,i3,i2)
coup4L = cplcFuFuhhL(i3,gt3,i4)
coup4R = cplcFuFuhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Fu],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(gt4,i3,i2)
coup3R = cplcFuFuhhR(gt4,i3,i2)
coup4L = cplcFuFuhhL(i3,gt3,i4)
coup4R = cplcFuFuhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Fu],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(gt4,i3)
coup3R = cplcFuFuVPR(gt4,i3)
coup4L = cplcFuFuhhL(i3,gt3,i4)
coup4R = cplcFuFuhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Fu],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcFuFuhhL(i3,gt3,i4)
coup4R = cplcFuFuhhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Fd,Su,Chi,Su
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,3
  Do i2=1,6
    Do i3=1,10
      Do i4=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MSu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i4)
coup1R = cplcFdChaSuR(i1,gt1,i4)
coup2L = cplcChaFdcSuL(gt2,i1,i2)
coup2R = cplcChaFdcSuR(gt2,i1,i2)
coup3L = cplcFuChiSuL(gt4,i3,i2)
coup3R = cplcFuChiSuR(gt4,i3,i2)
coup4L = cplChiFucSuL(i3,gt3,i4)
coup4R = cplChiFucSuR(i3,gt3,i4)
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i4)
mS12 = MSu2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MSu(i2)
mS22 = MSu2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Fd,Su,Glu,Su
chargefactor = 4._dp/3._dp 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,3
  Do i2=1,6
      Do i4=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3)).Or.(MSu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i4)
coup1R = cplcFdChaSuR(i1,gt1,i4)
coup2L = cplcChaFdcSuL(gt2,i1,i2)
coup2R = cplcChaFdcSuR(gt2,i1,i2)
coup3L = cplcFuGluSuL(gt4,i2)
coup3R = cplcFuGluSuR(gt4,i2)
coup4L = cplGluFucSuL(gt3,i4)
coup4R = cplGluFucSuR(gt3,i4)
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i4)
mS12 = MSu2(i4)
mF2 = MGlu
mF22 = MGlu2
mS2 = MSu(i2)
mS22 = MSu2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Cha,Ah,bar[Fu],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(gt4,i3,i2)
coup3R = cplcFuFuAhR(gt4,i3,i2)
coup4L = cplcFuFuVPL(i3,gt3)
coup4R = cplcFuFuVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Fu],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(gt4,i3,i2)
coup3R = cplcFuFuhhR(gt4,i3,i2)
coup4L = cplcFuFuVPL(i3,gt3)
coup4R = cplcFuFuVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Fu],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(gt4,i3)
coup3R = cplcFuFuVPR(gt4,i3)
coup4L = cplcFuFuVPL(i3,gt3)
coup4R = cplcFuFuVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Fu],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcFuFuVPL(i3,gt3)
coup4R = cplcFuFuVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,bar[Fu],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcFuFuAhL(gt4,i3,i2)
coup3R = cplcFuFuAhR(gt4,i3,i2)
coup4L = cplcFuFuVZL(i3,gt3)
coup4R = cplcFuFuVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Fu],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcFuFuhhL(gt4,i3,i2)
coup3R = cplcFuFuhhR(gt4,i3,i2)
coup4L = cplcFuFuVZL(i3,gt3)
coup4R = cplcFuFuVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Fu],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcFuFuVPL(gt4,i3)
coup3R = cplcFuFuVPR(gt4,i3)
coup4L = cplcFuFuVZL(i3,gt3)
coup4R = cplcFuFuVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Fu],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcFuFuVZL(i3,gt3)
coup4R = cplcFuFuVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Ah,bar[Cha],conj[Sd],bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,8
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i2,i1)
coup2R = cplcChaChaAhR(gt2,i2,i1)
coup3L = cplcChacFuSdL(i2,gt4,i3)
coup3R = cplcChacFuSdR(i2,gt4,i3)
coup4L = cplChaFucSdL(i4,gt3,i3)
coup4R = cplChaFucSdR(i4,gt3,i3)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! hh,bar[Cha],conj[Sd],bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,8
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt2,i2,i1)
coup2R = cplcChaChahhR(gt2,i2,i1)
coup3L = cplcChacFuSdL(i2,gt4,i3)
coup3R = cplcChacFuSdR(i2,gt4,i3)
coup4L = cplChaFucSdL(i4,gt3,i3)
coup4R = cplChaFucSdR(i4,gt3,i3)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VP,bar[Cha],conj[Sd],bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 2
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVPL(gt2,i2)
coup2R = cplcChaChaVPR(gt2,i2)
coup3L = cplcChacFuSdL(i2,gt4,i3)
coup3R = cplcChacFuSdR(i2,gt4,i3)
coup4L = cplChaFucSdL(i4,gt3,i3)
coup4R = cplChaFucSdR(i4,gt3,i3)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF12, mF22, mV12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mV12, mS22)
  BOlluuSLL=BOlluuSLL - 8.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 8.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VZ,bar[Cha],conj[Sd],bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 2
  Do i2=1,5
    Do i3=1,6
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVZL(gt2,i2)
coup2R = cplcChaChaVZR(gt2,i2)
coup3L = cplcChacFuSdL(i2,gt4,i3)
coup3R = cplcChacFuSdR(i2,gt4,i3)
coup4L = cplChaFucSdL(i4,gt3,i3)
coup4R = cplChaFucSdR(i4,gt3,i3)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF12, mF22, mV12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mV12, mS22)
  BOlluuSLL=BOlluuSLL - 8.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 8.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Chi,conj[Hpm],bar[Fd],conj[Hpm]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,10
  Do i2=1,8
    Do i3=1,3
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplcFuFdcHpmL(gt4,i3,i2)
coup3R = cplcFuFdcHpmR(gt4,i3,i2)
coup4L = cplcFdFuHpmL(i3,gt3,i4)
coup4R = cplcFdFuHpmR(i3,gt3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuSLR=BOlluuSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,conj[VWm],bar[Fd],conj[Hpm]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,10
    Do i3=1,3
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplcFuFdcVWmL(gt4,i3)
coup3R = cplcFuFdcVWmR(gt4,i3)
coup4L = cplcFdFuHpmL(i3,gt3,i4)
coup4R = cplcFdFuHpmR(i3,gt3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Chi,conj[Hpm],bar[Fd],conj[VWm]
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,10
  Do i2=1,8
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplcFuFdcHpmL(gt4,i3,i2)
coup3R = cplcFuFdcHpmR(gt4,i3,i2)
coup4L = cplcFdFuVWmL(i3,gt3)
coup4R = cplcFdFuVWmR(i3,gt3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Chi,conj[VWm],bar[Fd],conj[VWm]
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,10
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplcFuFdcVWmL(gt4,i3)
coup3R = cplcFuFdcVWmR(gt4,i3)
coup4L = cplcFdFuVWmL(i3,gt3)
coup4R = cplcFdFuVWmR(i3,gt3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MFd(i3)
mF22 = MFd2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BOlluuSLL=BOlluuSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuSRR=BOlluuSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BOlluuSRL=BOlluuSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuSLR=BOlluuSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRR=BOlluuVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BOlluuVLL=BOlluuVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BOlluuVRL=BOlluuVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Sd,Fu,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcFuFuAhL(gt4,i3,i4)
coup2R = cplcFuFuAhR(gt4,i3,i4)
coup3L = cplChaFucSdL(i1,gt3,i2)
coup3R = cplChaFucSdR(i1,gt3,i2)
coup4L = cplcChacFuSdL(gt2,i3,i2)
coup4R = cplcChacFuSdR(gt2,i3,i2)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Hpm,Fd,Su,Chi
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,3
    Do i3=1,6
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcFuChiSuL(gt4,i4,i3)
coup2R = cplcFuChiSuR(gt4,i4,i3)
coup3L = cplcFdFuHpmL(i2,gt3,i1)
coup3R = cplcFdFuHpmR(i2,gt3,i1)
coup4L = cplcChaFdcSuL(gt2,i2,i3)
coup4R = cplcChaFdcSuR(gt2,i2,i3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! VWm,Fd,Su,Chi
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 3
  Do i2=1,3
    Do i3=1,6
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcFuChiSuL(gt4,i4,i3)
coup2R = cplcFuChiSuR(gt4,i4,i3)
coup3L = cplcFdFuVWmL(i2,gt3)
coup3R = cplcFdFuVWmR(i2,gt3)
coup4L = cplcChaFdcSuL(gt2,i2,i3)
coup4R = cplcChaFdcSuR(gt2,i2,i3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mV12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BOlluuSLL=BOlluuSLL - 0.25*chargefactor*(13.*coup1L*coup2L*coup3L*coup4L +          & 
&  3.*coup1R*coup2R*coup3R*coup4R)*int1
  BOlluuSRR=BOlluuSRR - 0.25*chargefactor*(3.*coup1L*coup2L*coup3L*coup4L +           & 
&  13.*coup1R*coup2R*coup3R*coup4R)*int1
  BOlluuSRL=BOlluuSRL+chargefactor*(0.75*(-1.*coup1L*coup2L*coup3L*coup4L +           & 
&  coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1R*coup2L*coup3L*coup4R*int2)
  BOlluuSLR=BOlluuSLR+chargefactor*(0.75*(coup1L*coup2L*coup3L*coup4L -               & 
&  1.*coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1L*coup2R*coup3R*coup4L*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRL=BOlluuVRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.0625*chargefactor*(-21.*coup1L*coup2L*coup3L*coup4L +         & 
&  5.*coup1R*coup2R*coup3R*coup4R)*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.0625*chargefactor*(5.*coup1L*coup2L*coup3L*coup4L -           & 
&  21.*coup1R*coup2R*coup3R*coup4R)*int1
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Cha,Sd,Fu,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcFuFuhhL(gt4,i3,i4)
coup2R = cplcFuFuhhR(gt4,i3,i4)
coup3L = cplChaFucSdL(i1,gt3,i2)
coup3R = cplChaFucSdR(i1,gt3,i2)
coup4L = cplcChacFuSdL(gt2,i3,i2)
coup4R = cplcChacFuSdR(gt2,i3,i2)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,Sd,Fu,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 3
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcFuFuVPL(gt4,i3)
coup2R = cplcFuFuVPR(gt4,i3)
coup3L = cplChaFucSdL(i1,gt3,i2)
coup3R = cplChaFucSdR(i1,gt3,i2)
coup4L = cplcChacFuSdL(gt2,i3,i2)
coup4R = cplcChacFuSdR(gt2,i3,i2)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -           & 
&  8.*int2)
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -           & 
&  8.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuTLL=BOlluuTLL - 0.25*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.25*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,Sd,Fu,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 3
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcFuFuVZL(gt4,i3)
coup2R = cplcFuFuVZR(gt4,i3)
coup3L = cplChaFucSdL(i1,gt3,i2)
coup3R = cplChaFucSdR(i1,gt3,i2)
coup4L = cplcChacFuSdL(gt2,i3,i2)
coup4R = cplcChacFuSdR(gt2,i3,i2)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -           & 
&  8.*int2)
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -           & 
&  8.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuTLL=BOlluuTLL - 0.25*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.25*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! conj[Su],Chi,conj[Hpm],bar[Fd]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,6
  Do i2=1,10
    Do i3=1,8
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcFuFdcHpmL(gt4,i4,i3)
coup2R = cplcFuFdcHpmR(gt4,i4,i3)
coup3L = cplChiFucSuL(i2,gt3,i1)
coup3R = cplChiFucSuR(i2,gt3,i1)
coup4L = cplcChaChiHpmL(gt2,i2,i3)
coup4R = cplcChaChiHpmR(gt2,i2,i3)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BOlluuVRL=BOlluuVRL+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BOlluuVLR=BOlluuVLR+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BOlluuTLL=BOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! conj[Su],Chi,conj[VWm],bar[Fd]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 3
Do i1=1,6
  Do i2=1,10
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcFuFdcVWmL(gt4,i4)
coup2R = cplcFuFdcVWmR(gt4,i4)
coup3L = cplChiFucSuL(i2,gt3,i1)
coup3R = cplChiFucSuR(i2,gt3,i1)
coup4L = cplcChaChiVWmL(gt2,i2)
coup4R = cplcChaChiVWmR(gt2,i2)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mV2 = MVWm
mV22 = MVWm2
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF22, mF12, mS12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BOlluuSLL=BOlluuSLL - 0.25*chargefactor*(3.*coup1R*coup2L*coup3R*coup4L +           & 
&  13.*coup1L*coup2R*coup3L*coup4R)*int1
  BOlluuSRR=BOlluuSRR - 0.25*chargefactor*(13.*coup1R*coup2L*coup3R*coup4L +          & 
&  3.*coup1L*coup2R*coup3L*coup4R)*int1
  BOlluuSRL=BOlluuSRL+chargefactor*(0.75*(coup1R*coup2L*coup3R*coup4L -               & 
&  1.*coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1R*coup2R*coup3L*coup4L*int2)
  BOlluuSLR=BOlluuSLR+chargefactor*(0.75*(-1.*coup1R*coup2L*coup3R*coup4L +           & 
&  coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1L*coup2L*coup3R*coup4R*int2)
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuVRL=BOlluuVRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuVLR=BOlluuVLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuTLL=BOlluuTLL+0.0625*chargefactor*(5.*coup1R*coup2L*coup3R*coup4L -           & 
&  21.*coup1L*coup2R*coup3L*coup4R)*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.0625*chargefactor*(-21.*coup1R*coup2L*coup3R*coup4L +         & 
&  5.*coup1L*coup2R*coup3L*coup4R)*int1
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! bar[Fu],Ah,bar[Cha],conj[Sd]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,3
  Do i2=1,8
    Do i3=1,5
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(i3,gt4,i4)
coup2R = cplcChacFuSdR(i3,gt4,i4)
coup3L = cplcFuFuAhL(i1,gt3,i2)
coup3R = cplcFuFuAhR(i1,gt3,i2)
coup4L = cplcChaChaAhL(gt2,i3,i2)
coup4R = cplcChaChaAhR(gt2,i3,i2)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! bar[Fu],hh,bar[Cha],conj[Sd]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,3
  Do i2=1,8
    Do i3=1,5
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(i3,gt4,i4)
coup2R = cplcChacFuSdR(i3,gt4,i4)
coup3L = cplcFuFuhhL(i1,gt3,i2)
coup3R = cplcFuFuhhR(i1,gt3,i2)
coup4L = cplcChaChahhL(gt2,i3,i2)
coup4R = cplcChaChahhR(gt2,i3,i2)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BOlluuSLL=BOlluuSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuSRR=BOlluuSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BOlluuSRL=BOlluuSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BOlluuSLR=BOlluuSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BOlluuVRR=BOlluuVRR - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BOlluuVLL=BOlluuVLL - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BOlluuVRL=BOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BOlluuVLR=BOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BOlluuTLL=BOlluuTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! bar[Fu],VP,bar[Cha],conj[Sd]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 3
Do i1=1,3
    Do i3=1,5
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(i3,gt4,i4)
coup2R = cplcChacFuSdR(i3,gt4,i4)
coup3L = cplcFuFuVPL(i1,gt3)
coup3R = cplcFuFuVPR(i1,gt3)
coup4L = cplcChaChaVPL(gt2,i3)
coup4R = cplcChaChaVPR(gt2,i3)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -           & 
&  8.*int2)
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -           & 
&  8.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuTLL=BOlluuTLL - 0.25*chargefactor*coup1L*coup2L*coup3L*coup4R*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.25*chargefactor*coup1R*coup2R*coup3R*coup4L*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! bar[Fu],VZ,bar[Cha],conj[Sd]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 3
Do i1=1,3
    Do i3=1,5
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(i3,gt4,i4)
coup2R = cplcChacFuSdR(i3,gt4,i4)
coup3L = cplcFuFuVZL(i1,gt3)
coup3R = cplcFuFuVZR(i1,gt3)
coup4L = cplcChaChaVZL(gt2,i3)
coup4R = cplcChaChaVZR(gt2,i3)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BOlluuSLL=BOlluuSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -           & 
&  8.*int2)
  BOlluuSRR=BOlluuSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -           & 
&  8.*int2)
  BOlluuSRL=BOlluuSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BOlluuSLR=BOlluuSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BOlluuVRR=BOlluuVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BOlluuVLL=BOlluuVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BOlluuVRL=BOlluuVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BOlluuVLR=BOlluuVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BOlluuTLL=BOlluuTLL - 0.25*chargefactor*coup1L*coup2L*coup3L*coup4R*int1
  BOlluuTLR=BOlluuTLR+0.
  BOlluuTRL=BOlluuTRL+0.
  BOlluuTRR=BOlluuTRR - 0.25*chargefactor*coup1R*coup2R*coup3R*coup4L*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 BOlluuSLL=oo16pi2*BOlluuSLL 
BOlluuSRR=oo16pi2*BOlluuSRR 
BOlluuSRL=oo16pi2*BOlluuSRL 
BOlluuSLR=oo16pi2*BOlluuSLR 
BOlluuVRR=oo16pi2*BOlluuVRR 
BOlluuVLL=oo16pi2*BOlluuVLL 
BOlluuVRL=oo16pi2*BOlluuVRL 
BOlluuVLR=oo16pi2*BOlluuVLR 
BOlluuTLL=oo16pi2*BOlluuTLL 
BOlluuTLR=oo16pi2*BOlluuTLR 
BOlluuTRL=oo16pi2*BOlluuTRL 
BOlluuTRR=oo16pi2*BOlluuTRR 
Iname=Iname-1

End Subroutine CalculateBox2L2u 

Subroutine CalculatePengS2L2u(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,              & 
& cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,cplcFdFuHpmR,cplcFdFuVWmL,            & 
& cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,cplcFuChiSuR,cplcFuFdcHpmL,        & 
& cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,         & 
& cplcFuFuhhR,cplcFuFuVGL,cplcFuFuVGR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFucSuL,cplChiFucSuR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL,cplGluFucSuR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplSdcHpmcSu,cplSdcSdVG,           & 
& cplSdcSdVP,cplSdcSdVZ,cplSdcSucVWm,cplSucSuVP,cplSucSuVZ,PSOlluuSLL,PSOlluuSRR,        & 
& PSOlluuSRL,PSOlluuSLR,PSOlluuVRR,PSOlluuVLL,PSOlluuVRL,PSOlluuVLR,PSOlluuTLL,          & 
& PSOlluuTLR,PSOlluuTRL,PSOlluuTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengS2L2u 
! 'PreSARAH' output has been generated  at 19:38 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),& 
& cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),             & 
& cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),      & 
& cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),         & 
& cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVGL(3,3),             & 
& cplcFuFuVGR(3,3),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),  & 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFucSuL(10,3,6),cplChiFucSuR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL(3,6),           & 
& cplGluFucSuR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplSdcHpmcSu(6,8,6),cplSdcSdVG(6,6), & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSdcSucVWm(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PSOlluuSLL 
Complex(dp), Intent(out) :: PSOlluuSRR 
Complex(dp), Intent(out) :: PSOlluuSRL 
Complex(dp), Intent(out) :: PSOlluuSLR 
Complex(dp), Intent(out) :: PSOlluuVRR 
Complex(dp), Intent(out) :: PSOlluuVLL 
Complex(dp), Intent(out) :: PSOlluuVRL 
Complex(dp), Intent(out) :: PSOlluuVLR 
Complex(dp), Intent(out) :: PSOlluuTLL 
Complex(dp), Intent(out) :: PSOlluuTLR 
Complex(dp), Intent(out) :: PSOlluuTRL 
Complex(dp), Intent(out) :: PSOlluuTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengS2L2u' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFu(gt3)  
MassEx32=MFu2(gt3) 
MassEx4=MFu(gt4)  
MassEx42=MFu2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], UpQuark, bar[UpQuark]} 
 ! ------------------------------ 
 
PSOlluuSLL=0._dp 
PSOlluuSRR=0._dp 
PSOlluuSRL=0._dp 
PSOlluuSLR=0._dp 
PSOlluuVRR=0._dp 
PSOlluuVLL=0._dp 
PSOlluuVRL=0._dp 
PSOlluuVLR=0._dp 
PSOlluuTLL=0._dp 
PSOlluuTLR=0._dp 
PSOlluuTRL=0._dp 
PSOlluuTRR=0._dp 
!---------------------------------------- 
! Scalar Wave Contributions            
!---------------------------------------- 
! -- Sd - Penguins            
! Propagator: Sd, Loop particles: Ah,bar[Cha], Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 9
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcChaChaAhL(i2,i3,i1)
coup2R = cplcChaChaAhR(i2,i3,i1)
coup3L = cplcChacFuSdL(i3,gt4,iProp)
coup3R = cplcChacFuSdR(i3,gt4,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 9
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup3L = cplcChacFuSdL(i3,gt4,iProp)
coup3R = cplcChacFuSdR(i3,gt4,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 9
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = Conjg(-cplcChaChaVZR(i1,i3))
coup2R = Conjg(-cplcChaChaVZL(i1,i3))
coup3L = cplcChacFuSdL(i3,gt4,iProp)
coup3R = cplcChacFuSdR(i3,gt4,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(-0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-      & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(-0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-      & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Chi,conj[Hpm], Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 9
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplChiChacHpmL(i1,i3,i2)
coup2R = cplChiChacHpmR(i1,i3,i2)
coup3L = cplcChacFuSdL(i3,gt4,iProp)
coup3R = cplcChacFuSdR(i3,gt4,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Chi,conj[VWm], Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 9
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,i3))
coup2R = Conjg(-cplChiChacVWmL(i1,i3))
coup3L = cplcChacFuSdL(i3,gt4,iProp)
coup3R = cplcChacFuSdR(i3,gt4,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(-0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-      & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(-0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-      & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 9
chargefactor = 3 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup3L = cplcChacFuSdL(i3,gt4,iProp)
coup3R = cplcChacFuSdR(i3,gt4,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 9
chargefactor = 3 
Do iProp=1,6
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup3L = cplcChacFuSdL(i3,gt4,iProp)
coup3R = cplcChacFuSdR(i3,gt4,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Fu,Ah, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 10
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplcFuFuAhL(i1,i3,i2)
coup2R = cplcFuFuAhR(i1,i3,i2)
coup1L = cplcFuFuAhL(gt4,i1,i2)
coup1R = cplcFuFuAhR(gt4,i1,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Sd,Cha, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 10
chargefactor = 1 
Do iProp=1,6
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplChaFucSdL(i2,i3,i1)
coup2R = cplChaFucSdR(i2,i3,i1)
coup1L = cplcChacFuSdL(i2,gt4,i1)
coup1R = cplcChacFuSdR(i2,gt4,i1)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Su,Chi, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 10
chargefactor = 1 
Do iProp=1,6
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplChiFucSuL(i2,i3,i1)
coup2R = cplChiFucSuR(i2,i3,i1)
coup1L = cplcFuChiSuL(gt4,i2,i1)
coup1R = cplcFuChiSuR(gt4,i2,i1)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Su,Glu, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 10
chargefactor = 4._dp/3._dp 
Do iProp=1,6
Do i1=1,6
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplGluFucSuL(i3,i1)
coup2R = cplGluFucSuR(i3,i1)
coup1L = cplcFuGluSuL(gt4,i1)
coup1R = cplcFuGluSuR(gt4,i1)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Fu,hh, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 10
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplcFuFuhhL(i1,i3,i2)
coup2R = cplcFuFuhhR(i1,i3,i2)
coup1L = cplcFuFuhhL(gt4,i1,i2)
coup1R = cplcFuFuhhR(gt4,i1,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Fd,Hpm, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 10
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplcFdFuHpmL(i1,i3,i2)
coup2R = cplcFdFuHpmR(i1,i3,i2)
coup1L = cplcFuFdcHpmL(gt4,i1,i2)
coup1R = cplcFuFdcHpmR(gt4,i1,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(0.5*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(0.5*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Fd,VWm, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 10
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplcFdFuVWmL(i1,i3)
coup2R = cplcFdFuVWmR(i1,i3)
coup1L = cplcFuFdcVWmL(gt4,i1)
coup1R = cplcFuFdcVWmR(gt4,i1)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(-0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-      & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(-0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-      & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Fu,VZ, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 10
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChacFuSdL(gt2,i3,iProp)
coup3R = cplcChacFuSdR(gt2,i3,iProp)
coup2L = cplcFuFuVZL(i1,i3)
coup2R = cplcFuFuVZR(i1,i3)
coup1L = cplcFuFuVZL(gt4,i1)
coup1R = cplcFuFuVZR(gt4,i1)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+(-0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-      & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVLL=PSOlluuVLL+(-0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-      & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+(0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+(0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Fu, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuAhL(i2,gt3,i1)
coup1R = cplcFuFuAhR(i2,gt3,i1)
coup2L = cplcFuFuAhL(i3,i2,i1)
coup2R = cplcFuFuAhR(i3,i2,i1)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Sd, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i1,gt3,i2)
coup1R = cplChaFucSdR(i1,gt3,i2)
coup2L = cplcChacFuSdL(i1,i3,i2)
coup2R = cplcChacFuSdR(i1,i3,i2)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Su, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i1,gt3,i2)
coup1R = cplChiFucSuR(i1,gt3,i2)
coup2L = cplcFuChiSuL(i3,i1,i2)
coup2R = cplcFuChiSuR(i3,i1,i2)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Glu,Su, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,3
If ((MGlu2.gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFucSuL(gt3,i2)
coup1R = cplGluFucSuR(gt3,i2)
coup2L = cplcFuGluSuL(i3,i2)
coup2R = cplcFuGluSuR(i3,i2)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Fu, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i2,gt3,i1)
coup1R = cplcFuFuhhR(i2,gt3,i1)
coup2L = cplcFuFuhhL(i3,i2,i1)
coup2R = cplcFuFuhhR(i3,i2,i1)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Fd, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuHpmL(i2,gt3,i1)
coup1R = cplcFdFuHpmR(i2,gt3,i1)
coup2L = cplcFuFdcHpmL(i3,i2,i1)
coup2R = cplcFuFdcHpmR(i3,i2,i1)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Fd, Internal fermion: bar[Fu]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuVWmL(i2,gt3)
coup1R = cplcFdFuVWmR(i2,gt3)
coup2L = cplcFuFdcVWmL(i3,i2)
coup2R = cplcFuFdcVWmR(i3,i2)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Fu, Internal fermion: bar[Fu]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuVZL(i2,gt3)
coup1R = cplcFuFuVZR(i2,gt3)
coup2L = cplcFuFuVZL(i3,i2)
coup2R = cplcFuFuVZR(i3,i2)
coup3L = cplcFuFuhhL(gt4,i3,iProp)
coup3R = cplcFuFuhhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Ah, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplcFuFuAhL(i1,i3,i2)
coup2R = cplcFuFuAhR(i1,i3,i2)
coup1L = cplcFuFuAhL(gt4,i1,i2)
coup1R = cplcFuFuAhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Cha, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplChaFucSdL(i2,i3,i1)
coup2R = cplChaFucSdR(i2,i3,i1)
coup1L = cplcChacFuSdL(i2,gt4,i1)
coup1R = cplcChacFuSdR(i2,gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Chi, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplChiFucSuL(i2,i3,i1)
coup2R = cplChiFucSuR(i2,i3,i1)
coup1L = cplcFuChiSuL(gt4,i2,i1)
coup1R = cplcFuChiSuR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Glu, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 4._dp/3._dp 
Do iProp=1,8
Do i1=1,6
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplGluFucSuL(i3,i1)
coup2R = cplGluFucSuR(i3,i1)
coup1L = cplcFuGluSuL(gt4,i1)
coup1R = cplcFuGluSuR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,hh, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplcFuFuhhL(i1,i3,i2)
coup2R = cplcFuFuhhR(i1,i3,i2)
coup1L = cplcFuFuhhL(gt4,i1,i2)
coup1R = cplcFuFuhhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Hpm, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplcFdFuHpmL(i1,i3,i2)
coup2R = cplcFdFuHpmR(i1,i3,i2)
coup1L = cplcFuFdcHpmL(gt4,i1,i2)
coup1R = cplcFuFdcHpmR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,VWm, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplcFdFuVWmL(i1,i3)
coup2R = cplcFdFuVWmR(i1,i3)
coup1L = cplcFuFdcVWmL(gt4,i1)
coup1R = cplcFuFdcVWmR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,VZ, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuhhL(i3,gt3,iProp)
coup3R = cplcFuFuhhR(i3,gt3,iProp)
coup2L = cplcFuFuVZL(i1,i3)
coup2R = cplcFuFuVZR(i1,i3)
coup1L = cplcFuFuVZL(gt4,i1)
coup1R = cplcFuFuVZR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Fu, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuAhL(i2,gt3,i1)
coup1R = cplcFuFuAhR(i2,gt3,i1)
coup2L = cplcFuFuAhL(i3,i2,i1)
coup2R = cplcFuFuAhR(i3,i2,i1)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Sd, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i1,gt3,i2)
coup1R = cplChaFucSdR(i1,gt3,i2)
coup2L = cplcChacFuSdL(i1,i3,i2)
coup2R = cplcChacFuSdR(i1,i3,i2)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Su, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i1,gt3,i2)
coup1R = cplChiFucSuR(i1,gt3,i2)
coup2L = cplcFuChiSuL(i3,i1,i2)
coup2R = cplcFuChiSuR(i3,i1,i2)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Glu,Su, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,3
If ((MGlu2.gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFucSuL(gt3,i2)
coup1R = cplGluFucSuR(gt3,i2)
coup2L = cplcFuGluSuL(i3,i2)
coup2R = cplcFuGluSuR(i3,i2)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Fu, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i2,gt3,i1)
coup1R = cplcFuFuhhR(i2,gt3,i1)
coup2L = cplcFuFuhhL(i3,i2,i1)
coup2R = cplcFuFuhhR(i3,i2,i1)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Fd, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i2,gt3,i1)
coup1R = cplcFdFuHpmR(i2,gt3,i1)
coup2L = cplcFuFdcHpmL(i3,i2,i1)
coup2R = cplcFuFdcHpmR(i3,i2,i1)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Fd, Internal fermion: bar[Fu]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuVWmL(i2,gt3)
coup1R = cplcFdFuVWmR(i2,gt3)
coup2L = cplcFuFdcVWmL(i3,i2)
coup2R = cplcFuFdcVWmR(i3,i2)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Fu, Internal fermion: bar[Fu]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuVZL(i2,gt3)
coup1R = cplcFuFuVZR(i2,gt3)
coup2L = cplcFuFuVZL(i3,i2)
coup2R = cplcFuFuVZR(i3,i2)
coup3L = cplcFuFuAhL(gt4,i3,iProp)
coup3R = cplcFuFuAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Ah, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplcFuFuAhL(i1,i3,i2)
coup2R = cplcFuFuAhR(i1,i3,i2)
coup1L = cplcFuFuAhL(gt4,i1,i2)
coup1R = cplcFuFuAhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Cha, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplChaFucSdL(i2,i3,i1)
coup2R = cplChaFucSdR(i2,i3,i1)
coup1L = cplcChacFuSdL(i2,gt4,i1)
coup1R = cplcChacFuSdR(i2,gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Chi, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplChiFucSuL(i2,i3,i1)
coup2R = cplChiFucSuR(i2,i3,i1)
coup1L = cplcFuChiSuL(gt4,i2,i1)
coup1R = cplcFuChiSuR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Glu, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 4._dp/3._dp 
Do iProp=1,8
Do i1=1,6
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplGluFucSuL(i3,i1)
coup2R = cplGluFucSuR(i3,i1)
coup1L = cplcFuGluSuL(gt4,i1)
coup1R = cplcFuGluSuR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,hh, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplcFuFuhhL(i1,i3,i2)
coup2R = cplcFuFuhhR(i1,i3,i2)
coup1L = cplcFuFuhhL(gt4,i1,i2)
coup1R = cplcFuFuhhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Hpm, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplcFdFuHpmL(i1,i3,i2)
coup2R = cplcFdFuHpmR(i1,i3,i2)
coup1L = cplcFuFdcHpmL(gt4,i1,i2)
coup1R = cplcFuFdcHpmR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,VWm, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplcFdFuVWmL(i1,i3)
coup2R = cplcFdFuVWmR(i1,i3)
coup1L = cplcFuFdcVWmL(gt4,i1)
coup1R = cplcFuFdcVWmR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,VZ, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuAhL(i3,gt3,iProp)
coup3R = cplcFuFuAhR(i3,gt3,iProp)
coup2L = cplcFuFuVZL(i1,i3)
coup2R = cplcFuFuVZR(i1,i3)
coup1L = cplcFuFuVZL(gt4,i1)
coup1R = cplcFuFuVZR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRR=PSOlluuSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSRL=PSOlluuSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-       & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuSLR=PSOlluuSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-       & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 !---------------------------------------- 
! Scalar Penguin Contributions            
!---------------------------------------- 
! -- Sd - Penguins            
! Propagator: Sd, Loop particles: Ah,bar[Cha],Fu
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,5
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcFuFuAhL(gt4,i3,i1)
coup2R = cplcFuFuAhR(gt4,i3,i1)
coup3L = cplcChacFuSdL(i2,i3,iProp)
coup3R = cplcChacFuSdR(i2,i3,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF12, mF22, mS12)
  int2=C0check(mF12, mF22, mS12)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +     & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +     & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 + & 
&  coup3L*int2*mF1*mF2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 + & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Cha,Ah,Sd
! Generic diagram: FSS,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
  Do i2=1,8
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup2L = cplcChacFuSdL(i1,gt4,i3)
coup2R = cplcChacFuSdR(i1,gt4,i3)
coup3 = cplAhSdcSd(i2,iProp,i3)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Cha,hh,Sd
! Generic diagram: FSS,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
  Do i2=1,8
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChacFuSdL(i1,gt4,i3)
coup2R = cplcChacFuSdR(i1,gt4,i3)
coup3 = cplhhSdcSd(i2,iProp,i3)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Cha,VZ,Sd
! Generic diagram: FVS,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,5
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = cplcChacFuSdL(i1,gt4,i3)
coup2R = cplcChacFuSdR(i1,gt4,i3)
coup3 = -cplSdcSdVZ(iProp,i3)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +  & 
&  int2*mF12)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +  & 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Chi,conj[Hpm],Su
! Generic diagram: FSS,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
  Do i2=1,8
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplcFuChiSuL(gt4,i1,i3)
coup2R = cplcFuChiSuR(gt4,i1,i3)
coup3 = cplSdcHpmcSu(iProp,i2,i3)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Chi,conj[VWm],Su
! Generic diagram: FVS,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,10
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = cplcFuChiSuL(gt4,i1,i3)
coup2R = cplcFuChiSuR(gt4,i1,i3)
coup3 = -cplSdcSucVWm(iProp,i3)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +  & 
&  int2*mF12)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +  & 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: hh,bar[Cha],Fu
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,5
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i2,i1)
coup1R = cplcChaChahhR(gt2,i2,i1)
coup2L = cplcFuFuhhL(gt4,i3,i1)
coup2R = cplcFuFuhhR(gt4,i3,i1)
coup3L = cplcChacFuSdL(i2,i3,iProp)
coup3R = cplcChacFuSdR(i2,i3,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF12, mF22, mS12)
  int2=C0check(mF12, mF22, mS12)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +     & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +     & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 + & 
&  coup3L*int2*mF1*mF2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 + & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: Hpm,Chi,Fd
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,8
  Do i2=1,10
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup2L = cplcFuFdcHpmL(gt4,i3,i1)
coup2R = cplcFuFdcHpmR(gt4,i3,i1)
coup3L = cplcFdChiSdL(i3,i2,iProp)
coup3R = cplcFdChiSdR(i3,i2,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF12, mF22, mS12)
  int2=C0check(mF12, mF22, mS12)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +     & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +     & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 + & 
&  coup3L*int2*mF1*mF2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 + & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: VWm,Chi,Fd
! Generic diagram: VFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
  Do i2=1,10
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i2))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i2))
coup2L = cplcFuFdcVWmL(gt4,i3)
coup2R = cplcFuFdcVWmR(gt4,i3)
coup3L = cplcFdChiSdL(i3,i2,iProp)
coup3R = cplcFdChiSdR(i3,i2,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF12, mF22, mV12)
  int2=C0check(mF12, mF22, mV12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1R*coup2L*coup4L*IMP2*(-1.*coup3L*Finite +   & 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1L*coup2R*coup4R*IMP2*(-1.*coup3R*Finite +   & 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(Finite -      & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuVLL=PSOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(Finite -      & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.25*chargefactor*coup1R*coup2L*coup4L*IMP2*(-1.*coup3L*Finite +& 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.25*chargefactor*coup1L*coup2R*coup4R*IMP2*(-1.*coup3R*Finite +& 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: VZ,bar[Cha],Fu
! Generic diagram: VFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
  Do i2=1,5
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i2))
coup1R = Conjg(-cplcChaChaVZL(gt2,i2))
coup2L = cplcFuFuVZL(gt4,i3)
coup2R = cplcFuFuVZR(gt4,i3)
coup3L = cplcChacFuSdL(i2,i3,iProp)
coup3R = cplcChacFuSdR(i2,i3,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF12, mF22, mV12)
  int2=C0check(mF12, mF22, mV12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1R*coup2L*coup4L*IMP2*(-1.*coup3L*Finite +   & 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1L*coup2R*coup4R*IMP2*(-1.*coup3R*Finite +   & 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(Finite -      & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuVLL=PSOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(Finite -      & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.25*chargefactor*coup1R*coup2L*coup4L*IMP2*(-1.*coup3L*Finite +& 
&  2.*coup3L*int1 + 2.*coup3R*int2*mF1*mF2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.25*chargefactor*coup1L*coup2R*coup4R*IMP2*(-1.*coup3R*Finite +& 
&  2.*coup3R*int1 + 2.*coup3L*int2*mF1*mF2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: bar[Fu],conj[Sd],Ah
! Generic diagram: FSS,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplcFuFuAhL(gt4,i1,i3)
coup2R = cplcFuFuAhR(gt4,i1,i3)
coup3 = cplAhSdcSd(i3,iProp,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: bar[Fu],conj[Sd],hh
! Generic diagram: FSS,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplhhSdcSd(i3,iProp,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: bar[Fu],conj[Sd],VG
! Generic diagram: FSV,  InsertionOrder: 5
chargefactor = 4._dp/3._dp 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplcFuFuVGL(gt4,i1)
coup2R = cplcFuFuVGR(gt4,i1)
coup3 = -cplSdcSdVG(iProp,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mV2 = 0.
mV22 = 0._dp
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOlluuSLL=PSOlluuSLL+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR - 0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuVLL=PSOlluuVLL - 0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Sd, Loop particles: bar[Fu],conj[Sd],VP
! Generic diagram: FSV,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplcFuFuVPL(gt4,i1)
coup2R = cplcFuFuVPR(gt4,i1)
coup3 = -cplSdcSdVP(iProp,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mV2 = 0.
mV22 = 0._dp
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOlluuSLL=PSOlluuSLL+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR - 0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuVLL=PSOlluuVLL - 0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Sd, Loop particles: bar[Fu],conj[Sd],VZ
! Generic diagram: FSV,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,3
  Do i2=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplcFuFuVZL(gt4,i1)
coup2R = cplcFuFuVZR(gt4,i1)
coup3 = -cplSdcSdVZ(iProp,i2)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOlluuSLL=PSOlluuSLL+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +      & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR - 0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuVLL=PSOlluuVLL - 0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Sd, Loop particles: conj[Su],bar[Fd],Chi
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,6
Do i1=1,6
  Do i2=1,3
    Do i3=1,10
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i2,i1)
coup1R = cplcChaFdcSuR(gt2,i2,i1)
coup2L = cplcFuChiSuL(gt4,i3,i1)
coup2R = cplcFuChiSuR(gt4,i3,i1)
coup3L = cplcFdChiSdL(i2,i3,iProp)
coup3R = cplcFdChiSdR(i2,i3,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF12, mF22, mS12)
  int2=C0check(mF12, mF22, mS12)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +     & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +     & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 + & 
&  coup3L*int2*mF1*mF2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 + & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Sd, Loop particles: conj[Su],bar[Fd],Glu
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 4._dp/3._dp 
Do iProp=1,6
Do i1=1,6
  Do i2=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i2,i1)
coup1R = cplcChaFdcSuR(gt2,i2,i1)
coup2L = cplcFuGluSuL(gt4,i1)
coup2R = cplcFuGluSuR(gt4,i1)
coup3L = cplcFdGluSdL(i2,iProp)
coup3R = cplcFdGluSdR(i2,iProp)
coup4L = cplChaFucSdL(gt1,gt3,iProp)
coup4R = cplChaFucSdR(gt1,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MGlu
mF22 = MGlu2
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF12, mF22, mS12)
  int2=C0check(mF12, mF22, mS12)
  PSOlluuSLL=PSOlluuSLL - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +   & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +   & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+0.
  PSOlluuSLR=PSOlluuSLR+0.
  PSOlluuVRR=PSOlluuVRR+0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +     & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVLL=PSOlluuVLL+0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +     & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL - 0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 + & 
&  coup3L*int2*mF1*mF2)
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR - 0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 + & 
&  coup3R*int2*mF1*mF2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSOlluuSLL=PSOlluuSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSOlluuSLL=PSOlluuSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplhhSucSu(iProp,i3,i2)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,iProp)
coup3R = cplcFuFuhhR(i2,i3,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcFuFuhhL(gt4,gt3,iProp)
coup4R = cplcFuFuhhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuAhL(i2,gt3,i1)
coup1R = cplcFuFuAhR(i2,gt3,i1)
coup2L = cplcFuFuAhL(gt4,i3,i1)
coup2R = cplcFuFuAhR(gt4,i3,i1)
coup3L = cplcFuFuhhL(i3,i2,iProp)
coup3R = cplcFuFuhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i1,gt3,i2)
coup1R = cplChaFucSdR(i1,gt3,i2)
coup2L = cplcChacFuSdL(i1,gt4,i3)
coup2R = cplcChacFuSdR(i1,gt4,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i1,gt3,i2)
coup1R = cplChiFucSuR(i1,gt3,i2)
coup2L = cplcFuChiSuL(gt4,i1,i3)
coup2R = cplcFuChiSuR(gt4,i1,i3)
coup3 = cplhhSucSu(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Glu,Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,6
If ((MGlu2.gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFucSuL(gt3,i2)
coup1R = cplGluFucSuR(gt3,i2)
coup2L = cplcFuGluSuL(gt4,i3)
coup2R = cplcFuGluSuR(gt4,i3)
coup3 = cplhhSucSu(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i2,gt3,i1)
coup1R = cplcFuFuhhR(i2,gt3,i1)
coup2L = cplcFuFuhhL(gt4,i3,i1)
coup2R = cplcFuFuhhR(gt4,i3,i1)
coup3L = cplcFuFuhhL(i3,i2,iProp)
coup3R = cplcFuFuhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuHpmL(i2,gt3,i1)
coup1R = cplcFdFuHpmR(i2,gt3,i1)
coup2L = cplcFuFdcHpmL(gt4,i3,i1)
coup2R = cplcFuFdcHpmR(gt4,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Fd,Fd
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuVWmL(i2,gt3)
coup1R = cplcFdFuVWmR(i2,gt3)
coup2L = cplcFuFdcVWmL(gt4,i3)
coup2R = cplcFuFdcVWmR(gt4,i3)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Fu,Fu
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuVZL(i2,gt3)
coup1R = cplcFuFuVZR(i2,gt3)
coup2L = cplcFuFuVZL(gt4,i3)
coup2R = cplcFuFuVZR(gt4,i3)
coup3L = cplcFuFuhhL(i3,i2,iProp)
coup3R = cplcFuFuhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Hpm],conj[Hpm]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuHpmL(i1,gt3,i2)
coup1R = cplcFdFuHpmR(i1,gt3,i2)
coup2L = cplcFuFdcHpmL(gt4,i1,i3)
coup2R = cplcFuFdcHpmR(gt4,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[VWm],conj[Hpm]
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuVWmL(i1,gt3)
coup1R = cplcFdFuVWmR(i1,gt3)
coup2L = cplcFuFdcHpmL(gt4,i1,i3)
coup2R = cplcFuFdcHpmR(gt4,i1,i3)
coup3 = -cplhhHpmcVWm(iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Hpm],conj[VWm]
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuHpmL(i1,gt3,i2)
coup1R = cplcFdFuHpmR(i1,gt3,i2)
coup2L = cplcFuFdcVWmL(gt4,i1)
coup2R = cplcFuFdcVWmR(gt4,i1)
coup3 = -cplhhcHpmVWm(iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[VWm],conj[VWm]
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdFuVWmL(i1,gt3)
coup1R = cplcFdFuVWmR(i1,gt3)
coup2L = cplcFuFdcVWmL(gt4,i1)
coup2R = cplcFuFdcVWmR(gt4,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSOlluuSLL=PSOlluuSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuAhL(i1,gt3,i2)
coup1R = cplcFuFuAhR(i1,gt3,i2)
coup2L = cplcFuFuAhL(gt4,i1,i3)
coup2R = cplcFuFuAhR(gt4,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i1,gt3,i2)
coup1R = cplcFuFuhhR(i1,gt3,i2)
coup2L = cplcFuFuAhL(gt4,i1,i3)
coup2R = cplcFuFuAhR(gt4,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuVZL(i1,gt3)
coup1R = cplcFuFuVZR(i1,gt3)
coup2L = cplcFuFuAhL(gt4,i1,i3)
coup2R = cplcFuFuAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuAhL(i1,gt3,i2)
coup1R = cplcFuFuAhR(i1,gt3,i2)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i1,gt3,i2)
coup1R = cplcFuFuhhR(i1,gt3,i2)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuAhL(i1,gt3,i2)
coup1R = cplcFuFuAhR(i1,gt3,i2)
coup2L = cplcFuFuVZL(gt4,i1)
coup2R = cplcFuFuVZR(gt4,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuVZL(i1,gt3)
coup1R = cplcFuFuVZR(i1,gt3)
coup2L = cplcFuFuVZL(gt4,i1)
coup2R = cplcFuFuVZR(gt4,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSOlluuSLL=PSOlluuSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i2,gt3,i1)
coup1R = cplChaFucSdR(i2,gt3,i1)
coup2L = cplcChacFuSdL(i3,gt4,i1)
coup2R = cplcChacFuSdR(i3,gt4,i1)
coup3L = cplcChaChahhL(i2,i3,iProp)
coup3R = cplcChaChahhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Su],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,10
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i2,gt3,i1)
coup1R = cplChiFucSuR(i2,gt3,i1)
coup2L = cplcFuChiSuL(gt4,i3,i1)
coup2R = cplcFuChiSuR(gt4,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplAhSucSu(iProp,i3,i2)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuAhL(i2,i3,iProp)
coup3R = cplcFuFuAhR(i2,i3,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcFuFuAhL(gt4,gt3,iProp)
coup4R = cplcFuFuAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuAhL(i2,gt3,i1)
coup1R = cplcFuFuAhR(i2,gt3,i1)
coup2L = cplcFuFuAhL(gt4,i3,i1)
coup2R = cplcFuFuAhR(gt4,i3,i1)
coup3L = cplcFuFuAhL(i3,i2,iProp)
coup3R = cplcFuFuAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,6
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i1,gt3,i2)
coup1R = cplChaFucSdR(i1,gt3,i2)
coup2L = cplcChacFuSdL(i1,gt4,i3)
coup2R = cplcChacFuSdR(i1,gt4,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,6
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i1,gt3,i2)
coup1R = cplChiFucSuR(i1,gt3,i2)
coup2L = cplcFuChiSuL(gt4,i1,i3)
coup2R = cplcFuChiSuR(gt4,i1,i3)
coup3 = cplAhSucSu(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Glu,Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 4._dp/3._dp 
Do iProp=1,8
  Do i2=1,6
    Do i3=1,6
If ((MGlu2.gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFucSuL(gt3,i2)
coup1R = cplGluFucSuR(gt3,i2)
coup2L = cplcFuGluSuL(gt4,i3)
coup2R = cplcFuGluSuR(gt4,i3)
coup3 = cplAhSucSu(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i2,gt3,i1)
coup1R = cplcFuFuhhR(i2,gt3,i1)
coup2L = cplcFuFuhhL(gt4,i3,i1)
coup2R = cplcFuFuhhR(gt4,i3,i1)
coup3L = cplcFuFuAhL(i3,i2,iProp)
coup3R = cplcFuFuAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i2,gt3,i1)
coup1R = cplcFdFuHpmR(i2,gt3,i1)
coup2L = cplcFuFdcHpmL(gt4,i3,i1)
coup2R = cplcFuFdcHpmR(gt4,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Fd,Fd
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuVWmL(i2,gt3)
coup1R = cplcFdFuVWmR(i2,gt3)
coup2L = cplcFuFdcVWmL(gt4,i3)
coup2R = cplcFuFdcVWmR(gt4,i3)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Fu,Fu
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuVZL(i2,gt3)
coup1R = cplcFuFuVZR(i2,gt3)
coup2L = cplcFuFuVZL(gt4,i3)
coup2R = cplcFuFuVZR(gt4,i3)
coup3L = cplcFuFuAhL(i3,i2,iProp)
coup3R = cplcFuFuAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSOlluuSLL=PSOlluuSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -   & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -   & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Hpm],conj[Hpm]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i1,gt3,i2)
coup1R = cplcFdFuHpmR(i1,gt3,i2)
coup2L = cplcFuFdcHpmL(gt4,i1,i3)
coup2R = cplcFuFdcHpmR(gt4,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[VWm],conj[Hpm]
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuVWmL(i1,gt3)
coup1R = cplcFdFuVWmR(i1,gt3)
coup2L = cplcFuFdcHpmL(gt4,i1,i3)
coup2R = cplcFuFdcHpmR(gt4,i1,i3)
coup3 = -cplAhHpmcVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Hpm],conj[VWm]
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i1,gt3,i2)
coup1R = cplcFdFuHpmR(i1,gt3,i2)
coup2L = cplcFuFdcVWmL(gt4,i1)
coup2R = cplcFuFdcVWmR(gt4,i1)
coup3 = -cplAhcHpmVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuAhL(i1,gt3,i2)
coup1R = cplcFuFuAhR(i1,gt3,i2)
coup2L = cplcFuFuAhL(gt4,i1,i3)
coup2R = cplcFuFuAhR(gt4,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i1,gt3,i2)
coup1R = cplcFuFuhhR(i1,gt3,i2)
coup2L = cplcFuFuAhL(gt4,i1,i3)
coup2R = cplcFuFuAhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuAhL(i1,gt3,i2)
coup1R = cplcFuFuAhR(i1,gt3,i2)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i1,gt3,i2)
coup1R = cplcFuFuhhR(i1,gt3,i2)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuVZL(i1,gt3)
coup1R = cplcFuFuVZR(i1,gt3)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +          & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,3
  Do i2=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i1,gt3,i2)
coup1R = cplcFuFuhhR(i1,gt3,i2)
coup2L = cplcFuFuVZL(gt4,i1)
coup2R = cplcFuFuVZR(gt4,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSOlluuSLL=PSOlluuSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRR=PSOlluuSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSRL=PSOlluuSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuSLR=PSOlluuSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +     & 
&  int2*mF12)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,5
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i2,gt3,i1)
coup1R = cplChaFucSdR(i2,gt3,i1)
coup2L = cplcChacFuSdL(i3,gt4,i1)
coup2R = cplcChacFuSdR(i3,gt4,i1)
coup3L = cplcChaChaAhL(i2,i3,iProp)
coup3R = cplcChaChaAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Su],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,6
  Do i2=1,10
    Do i3=1,10
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i2,gt3,i1)
coup1R = cplChiFucSuR(i2,gt3,i1)
coup2L = cplcFuChiSuL(gt4,i3,i1)
coup2R = cplcFuChiSuR(gt4,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSOlluuSLL=PSOlluuSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSRR=PSOlluuSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuSRL=PSOlluuSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +         & 
&  coup3L*int2*mF1*mF2)
  PSOlluuSLR=PSOlluuSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +         & 
&  coup3R*int2*mF1*mF2)
  PSOlluuVRR=PSOlluuVRR+0.
  PSOlluuVLL=PSOlluuVLL+0.
  PSOlluuVRL=PSOlluuVRL+0.
  PSOlluuVLR=PSOlluuVLR+0.
  PSOlluuTLL=PSOlluuTLL+0.
  PSOlluuTLR=PSOlluuTLR+0.
  PSOlluuTRL=PSOlluuTRL+0.
  PSOlluuTRR=PSOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 PSOlluuSLL=oo16pi2*PSOlluuSLL 
PSOlluuSRR=oo16pi2*PSOlluuSRR 
PSOlluuSRL=oo16pi2*PSOlluuSRL 
PSOlluuSLR=oo16pi2*PSOlluuSLR 
PSOlluuVRR=oo16pi2*PSOlluuVRR 
PSOlluuVLL=oo16pi2*PSOlluuVLL 
PSOlluuVRL=oo16pi2*PSOlluuVRL 
PSOlluuVLR=oo16pi2*PSOlluuVLR 
PSOlluuTLL=oo16pi2*PSOlluuTLL 
PSOlluuTLR=oo16pi2*PSOlluuTLR 
PSOlluuTRL=oo16pi2*PSOlluuTRL 
PSOlluuTRR=oo16pi2*PSOlluuTRR 
Iname=Iname-1

End Subroutine CalculatePengS2L2u 

Subroutine CalculatePengV2L2u(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,              & 
& cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,cplcFdFuHpmR,cplcFdFuVWmL,            & 
& cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,cplcFuChiSuR,cplcFuFdcHpmL,        & 
& cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,         & 
& cplcFuFuhhR,cplcFuFuVGL,cplcFuFuVGR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFucSuL,cplChiFucSuR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL,cplGluFucSuR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplSdcHpmcSu,cplSdcSdVG,           & 
& cplSdcSdVP,cplSdcSdVZ,cplSdcSucVWm,cplSucSuVP,cplSucSuVZ,PVOlluuSLL,PVOlluuSRR,        & 
& PVOlluuSRL,PVOlluuSLR,PVOlluuVRR,PVOlluuVLL,PVOlluuVRL,PVOlluuVLR,PVOlluuTLL,          & 
& PVOlluuTLR,PVOlluuTRL,PVOlluuTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengV2L2u 
! 'PreSARAH' output has been generated  at 19:45 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),& 
& cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),             & 
& cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),      & 
& cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),         & 
& cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVGL(3,3),             & 
& cplcFuFuVGR(3,3),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),  & 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFucSuL(10,3,6),cplChiFucSuR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL(3,6),           & 
& cplGluFucSuR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplSdcHpmcSu(6,8,6),cplSdcSdVG(6,6), & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSdcSucVWm(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PVOlluuSLL 
Complex(dp), Intent(out) :: PVOlluuSRR 
Complex(dp), Intent(out) :: PVOlluuSRL 
Complex(dp), Intent(out) :: PVOlluuSLR 
Complex(dp), Intent(out) :: PVOlluuVRR 
Complex(dp), Intent(out) :: PVOlluuVLL 
Complex(dp), Intent(out) :: PVOlluuVRL 
Complex(dp), Intent(out) :: PVOlluuVLR 
Complex(dp), Intent(out) :: PVOlluuTLL 
Complex(dp), Intent(out) :: PVOlluuTLR 
Complex(dp), Intent(out) :: PVOlluuTRL 
Complex(dp), Intent(out) :: PVOlluuTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengV2L2u' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFu(gt3)  
MassEx32=MFu2(gt3) 
MassEx4=MFu(gt4)  
MassEx42=MFu2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], UpQuark, bar[UpQuark]} 
 ! ------------------------------ 
 
PVOlluuSLL=0._dp 
PVOlluuSRR=0._dp 
PVOlluuSRL=0._dp 
PVOlluuSLR=0._dp 
PVOlluuVRR=0._dp 
PVOlluuVLL=0._dp 
PVOlluuVRL=0._dp 
PVOlluuVLR=0._dp 
PVOlluuTLL=0._dp 
PVOlluuTLR=0._dp 
PVOlluuTRL=0._dp 
PVOlluuTRR=0._dp 
!---------------------------------------- 
! Vector Wave Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Fu, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuAhL(i2,gt3,i1)
coup1R = cplcFuFuAhR(i2,gt3,i1)
coup2L = cplcFuFuAhL(i3,i2,i1)
coup2R = cplcFuFuAhR(i3,i2,i1)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Sd, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,5
  Do i2=1,6
    Do i3=1,3
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i1,gt3,i2)
coup1R = cplChaFucSdR(i1,gt3,i2)
coup2L = cplcChacFuSdL(i1,i3,i2)
coup2R = cplcChacFuSdR(i1,i3,i2)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Su, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,10
  Do i2=1,6
    Do i3=1,3
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i1,gt3,i2)
coup1R = cplChiFucSuR(i1,gt3,i2)
coup2L = cplcFuChiSuL(i3,i1,i2)
coup2R = cplcFuChiSuR(i3,i1,i2)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Glu,Su, Internal fermion: bar[Fu]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 4._dp/3._dp 
  Do i2=1,6
    Do i3=1,3
If ((MGlu2.gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFucSuL(gt3,i2)
coup1R = cplGluFucSuR(gt3,i2)
coup2L = cplcFuGluSuL(i3,i2)
coup2R = cplcFuGluSuR(i3,i2)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Fu, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i2,gt3,i1)
coup1R = cplcFuFuhhR(i2,gt3,i1)
coup2L = cplcFuFuhhL(i3,i2,i1)
coup2R = cplcFuFuhhR(i3,i2,i1)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Fd, Internal fermion: bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i2,gt3,i1)
coup1R = cplcFdFuHpmR(i2,gt3,i1)
coup2L = cplcFuFdcHpmL(i3,i2,i1)
coup2R = cplcFuFdcHpmR(i3,i2,i1)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Fd, Internal fermion: bar[Fu]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuVWmL(i2,gt3)
coup1R = cplcFdFuVWmR(i2,gt3)
coup2L = cplcFuFdcVWmL(i3,i2)
coup2R = cplcFuFdcVWmR(i3,i2)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Fu, Internal fermion: bar[Fu]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuVZL(i2,gt3)
coup1R = cplcFuFuVZR(i2,gt3)
coup2L = cplcFuFuVZL(i3,i2)
coup2R = cplcFuFuVZR(i3,i2)
coup3L = cplcFuFuVZL(gt4,i3)
coup3R = cplcFuFuVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt3)
MFin2 = MFu2(i3)-MFu2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Ah, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplcFuFuAhL(i1,i3,i2)
coup2R = cplcFuFuAhR(i1,i3,i2)
coup1L = cplcFuFuAhL(gt4,i1,i2)
coup1R = cplcFuFuAhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Cha, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,6
  Do i2=1,5
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplChaFucSdL(i2,i3,i1)
coup2R = cplChaFucSdR(i2,i3,i1)
coup1L = cplcChacFuSdL(i2,gt4,i1)
coup1R = cplcChacFuSdR(i2,gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Chi, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,6
  Do i2=1,10
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplChiFucSuL(i2,i3,i1)
coup2R = cplChiFucSuR(i2,i3,i1)
coup1L = cplcFuChiSuL(gt4,i2,i1)
coup1R = cplcFuChiSuR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Glu, Internal fermion: Fu
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 4._dp/3._dp 
Do i1=1,6
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MGlu2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplGluFucSuL(i3,i1)
coup2R = cplGluFucSuR(i3,i1)
coup1L = cplcFuGluSuL(gt4,i1)
coup1R = cplcFuGluSuR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MGlu
mF12 = MGlu2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,hh, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplcFuFuhhL(i1,i3,i2)
coup2R = cplcFuFuhhR(i1,i3,i2)
coup1L = cplcFuFuhhL(gt4,i1,i2)
coup1R = cplcFuFuhhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Hpm, Internal fermion: Fu
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplcFdFuHpmL(i1,i3,i2)
coup2R = cplcFdFuHpmR(i1,i3,i2)
coup1L = cplcFuFdcHpmL(gt4,i1,i2)
coup1R = cplcFuFdcHpmR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,VWm, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
    Do i3=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplcFdFuVWmL(i1,i3)
coup2R = cplcFdFuVWmR(i1,i3)
coup1L = cplcFuFdcVWmL(gt4,i1)
coup1R = cplcFuFdcVWmR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,VZ, Internal fermion: Fu
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,3
    Do i3=1,3
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcFuFuVZL(i3,gt3)
coup3R = cplcFuFuVZR(i3,gt3)
coup2L = cplcFuFuVZL(i1,i3)
coup2R = cplcFuFuVZR(i1,i3)
coup1L = cplcFuFuVZL(gt4,i1)
coup1R = cplcFuFuVZR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MFu(i3)-MFu(gt4)
MFin2 = MFu2(i3)-MFu2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MFu(i3)
MFin2 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuVLL=PVOlluuVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuVRL=PVOlluuVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuVLR=PVOlluuVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 !---------------------------------------- 
! Vector Penguin Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV22, mV12)
  int3=C0check(mF12, mV22, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcFuFuVZL(gt4,gt3)
coup4R = cplcFuFuVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MAh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuAhL(i2,gt3,i1)
coup1R = cplcFuFuAhR(i2,gt3,i1)
coup2L = cplcFuFuAhL(gt4,i3,i1)
coup2R = cplcFuFuAhR(gt4,i3,i1)
coup3L = cplcFuFuVZL(i3,i2)
coup3R = cplcFuFuVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,6
    Do i3=1,6
If ((MCha2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i1,gt3,i2)
coup1R = cplChaFucSdR(i1,gt3,i2)
coup2L = cplcChacFuSdL(i1,gt4,i3)
coup2R = cplcChacFuSdR(i1,gt4,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
  Do i2=1,6
    Do i3=1,6
If ((MChi2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i1,gt3,i2)
coup1R = cplChiFucSuR(i1,gt3,i2)
coup2L = cplcFuChiSuL(gt4,i1,i3)
coup2R = cplcFuChiSuR(gt4,i1,i3)
coup3 = -cplSucSuVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Glu,Su,Su
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 4._dp/3._dp 
  Do i2=1,6
    Do i3=1,6
If ((MGlu2.gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplGluFucSuL(gt3,i2)
coup1R = cplGluFucSuR(gt3,i2)
coup2L = cplcFuGluSuL(gt4,i3)
coup2R = cplcFuGluSuR(gt4,i3)
coup3 = -cplSucSuVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MGlu
mF12 = MGlu2
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i2,gt3,i1)
coup1R = cplcFuFuhhR(i2,gt3,i1)
coup2L = cplcFuFuhhL(gt4,i3,i1)
coup2R = cplcFuFuhhR(gt4,i3,i1)
coup3L = cplcFuFuVZL(i3,i2)
coup3R = cplcFuFuVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,3
    Do i3=1,3
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i2,gt3,i1)
coup1R = cplcFdFuHpmR(i2,gt3,i1)
coup2L = cplcFuFdcHpmL(gt4,i3,i1)
coup2R = cplcFuFdcHpmR(gt4,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Fd,Fd
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVWm2.gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuVWmL(i2,gt3)
coup1R = cplcFdFuVWmR(i2,gt3)
coup2L = cplcFuFdcVWmL(gt4,i3)
coup2R = cplcFuFdcVWmR(gt4,i3)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Fu,Fu
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,3
    Do i3=1,3
If ((MVZ2.gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFuFuVZL(i2,gt3)
coup1R = cplcFuFuVZR(i2,gt3)
coup2L = cplcFuFuVZL(gt4,i3)
coup2R = cplcFuFuVZR(gt4,i3)
coup3L = cplcFuFuVZL(i3,i2)
coup3R = cplcFuFuVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite - & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Hpm],conj[Hpm]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i1,gt3,i2)
coup1R = cplcFdFuHpmR(i1,gt3,i2)
coup2L = cplcFuFdcHpmL(gt4,i1,i3)
coup2R = cplcFuFdcHpmR(gt4,i1,i3)
coup3 = cplHpmcHpmVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[VWm],conj[Hpm]
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
    Do i3=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuVWmL(i1,gt3)
coup1R = cplcFdFuVWmR(i1,gt3)
coup2L = cplcFuFdcHpmL(gt4,i1,i3)
coup2R = cplcFuFdcHpmR(gt4,i1,i3)
coup3 = cplHpmcVWmVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Hpm],conj[VWm]
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
If ((MFd2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuHpmL(i1,gt3,i2)
coup1R = cplcFdFuHpmR(i1,gt3,i2)
coup2L = cplcFuFdcVWmL(gt4,i1)
coup2R = cplcFuFdcVWmR(gt4,i1)
coup3 = cplcHpmVWmVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[VWm],conj[VWm]
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
If ((MFd2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcFdFuVWmL(i1,gt3)
coup1R = cplcFdFuVWmR(i1,gt3)
coup2L = cplcFuFdcVWmL(gt4,i1)
coup2R = cplcFuFdcVWmR(gt4,i1)
coup3 = cplcVWmVWmVZ
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV12, mV22)
  int3=C0check(mF12, mV12, mV22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-               & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i1,gt3,i2)
coup1R = cplcFuFuhhR(i1,gt3,i2)
coup2L = cplcFuFuAhL(gt4,i1,i3)
coup2R = cplcFuFuAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuAhL(i1,gt3,i2)
coup1R = cplcFuFuAhR(i1,gt3,i2)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVOlluuVLL=PVOlluuVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVOlluuVRL=PVOlluuVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVOlluuVLR=PVOlluuVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
    Do i3=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuVZL(i1,gt3)
coup1R = cplcFuFuVZR(i1,gt3)
coup2L = cplcFuFuhhL(gt4,i1,i3)
coup2R = cplcFuFuhhR(gt4,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,3
  Do i2=1,8
If ((MFu2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFuFuhhL(i1,gt3,i2)
coup1R = cplcFuFuhhR(i1,gt3,i2)
coup2L = cplcFuFuVZL(gt4,i1)
coup2R = cplcFuFuVZR(gt4,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,6
  Do i2=1,5
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(i2,gt3,i1)
coup1R = cplChaFucSdR(i2,gt3,i1)
coup2L = cplcChacFuSdL(i3,gt4,i1)
coup2R = cplcChacFuSdR(i3,gt4,i1)
coup3L = Conjg(-cplcChaChaVZR(i2,i3))
coup3R = Conjg(-cplcChaChaVZL(i2,i3))
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Su],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,6
  Do i2=1,10
    Do i3=1,10
If ((MSu2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiFucSuL(i2,gt3,i1)
coup1R = cplChiFucSuR(i2,gt3,i1)
coup2L = cplcFuChiSuL(gt4,i3,i1)
coup2R = cplcFuChiSuR(gt4,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVOlluuSLL=PVOlluuSLL+0.
  PVOlluuSRR=PVOlluuSRR+0.
  PVOlluuSRL=PVOlluuSRL+0.
  PVOlluuSLR=PVOlluuSLR+0.
  PVOlluuVRR=PVOlluuVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuVLL=PVOlluuVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVRL=PVOlluuVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -        & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVOlluuVLR=PVOlluuVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -        & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVOlluuTLL=PVOlluuTLL+0.
  PVOlluuTLR=PVOlluuTLR+0.
  PVOlluuTRL=PVOlluuTRL+0.
  PVOlluuTRR=PVOlluuTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 PVOlluuSLL=oo16pi2*PVOlluuSLL
PVOlluuSRR=oo16pi2*PVOlluuSRR
PVOlluuSRL=oo16pi2*PVOlluuSRL
PVOlluuSLR=oo16pi2*PVOlluuSLR
PVOlluuVRR=oo16pi2*PVOlluuVRR
PVOlluuVLL=oo16pi2*PVOlluuVLL
PVOlluuVRL=oo16pi2*PVOlluuVRL
PVOlluuVLR=oo16pi2*PVOlluuVLR
PVOlluuTLL=oo16pi2*PVOlluuTLL
PVOlluuTLR=oo16pi2*PVOlluuTLR
PVOlluuTRL=oo16pi2*PVOlluuTRL
PVOlluuTRR=oo16pi2*PVOlluuTRR
Iname=Iname-1

End Subroutine CalculatePengV2L2u 

Subroutine CalculateTreeS2L2u(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,              & 
& cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,cplcFdFuHpmR,cplcFdFuVWmL,            & 
& cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,cplcFuChiSuR,cplcFuFdcHpmL,        & 
& cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,         & 
& cplcFuFuhhR,cplcFuFuVGL,cplcFuFuVGR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFucSuL,cplChiFucSuR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL,cplGluFucSuR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplSdcHpmcSu,cplSdcSdVG,           & 
& cplSdcSdVP,cplSdcSdVZ,cplSdcSucVWm,cplSucSuVP,cplSucSuVZ,TSOlluuSLL,TSOlluuSRR,        & 
& TSOlluuSRL,TSOlluuSLR,TSOlluuVRR,TSOlluuVLL,TSOlluuVRL,TSOlluuVLR,TSOlluuTLL,          & 
& TSOlluuTLR,TSOlluuTRL,TSOlluuTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeS2L2u 
! 'PreSARAH' output has been generated  at 19:45 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),& 
& cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),             & 
& cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),      & 
& cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),         & 
& cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVGL(3,3),             & 
& cplcFuFuVGR(3,3),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),  & 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFucSuL(10,3,6),cplChiFucSuR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL(3,6),           & 
& cplGluFucSuR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplSdcHpmcSu(6,8,6),cplSdcSdVG(6,6), & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSdcSucVWm(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TSOlluuSLL 
Complex(dp), Intent(out) :: TSOlluuSRR 
Complex(dp), Intent(out) :: TSOlluuSRL 
Complex(dp), Intent(out) :: TSOlluuSLR 
Complex(dp), Intent(out) :: TSOlluuVRR 
Complex(dp), Intent(out) :: TSOlluuVLL 
Complex(dp), Intent(out) :: TSOlluuVRL 
Complex(dp), Intent(out) :: TSOlluuVLR 
Complex(dp), Intent(out) :: TSOlluuTLL 
Complex(dp), Intent(out) :: TSOlluuTLR 
Complex(dp), Intent(out) :: TSOlluuTRL 
Complex(dp), Intent(out) :: TSOlluuTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeS2L2u' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFu(gt3)  
MassEx32=MFu2(gt3) 
MassEx4=MFu(gt4)  
MassEx42=MFu2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], UpQuark, bar[UpQuark]} 
 ! ------------------------------ 
 
TSOlluuSLL=0._dp 
TSOlluuSRR=0._dp 
TSOlluuSRL=0._dp 
TSOlluuSLR=0._dp 
TSOlluuVRR=0._dp 
TSOlluuVLL=0._dp 
TSOlluuVRL=0._dp 
TSOlluuVLR=0._dp 
TSOlluuTLL=0._dp 
TSOlluuTLR=0._dp 
TSOlluuTRL=0._dp 
TSOlluuTRR=0._dp 
!---------------------------------------- 
! Scalar Tree Contributions            
!---------------------------------------- 
! -- conj[Sd] - Tree            
! Propagator: VZ
! InsertionOrder: 2
chargefactor = 1 
Do iProp=1,6
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,gt3,iProp)
coup1R = cplChaFucSdR(gt1,gt3,iProp)
coup2L = cplcChacFuSdL(gt2,gt4,iProp)
coup2R = cplcChacFuSdR(gt2,gt4,iProp)
! Propagator and inverse propagator mass 
MP = MSd(iProp)
MP2 = MSd2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSOlluuSLL=TSOlluuSLL-0.5*coup1L*coup2L*IMP2
  TSOlluuSRR=TSOlluuSRR-0.5*coup1R*coup2R*IMP2
  TSOlluuSRL=TSOlluuSRL+ 0.
  TSOlluuSLR=TSOlluuSLR+ 0.
  TSOlluuVRR=TSOlluuVRR+ 0.5*coup1R*coup2L*IMP2
  TSOlluuVLL=TSOlluuVLL+ 0.5*coup1L*coup2R*IMP2
  TSOlluuVRL=TSOlluuVRL+ 0.
  TSOlluuVLR=TSOlluuVLR+ 0.
  TSOlluuTLL=TSOlluuTLL-0.125*coup1L*coup2L*IMP2
  TSOlluuTLR=TSOlluuTLR+ 0.
  TSOlluuTRL=TSOlluuTRL+ 0.
  TSOlluuTRR=TSOlluuTRR-0.125*coup1R*coup2R*IMP2
 End if 
End Do 


 ! -- hh - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,gt1,iProp)
coup1R = cplcChaChahhR(gt2,gt1,iProp)
coup2L = cplcFuFuhhL(gt4,gt3,iProp)
coup2R = cplcFuFuhhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSOlluuSLL=TSOlluuSLL+ 1*coup1L*coup2L*IMP2
  TSOlluuSRR=TSOlluuSRR+ 1*coup1R*coup2R*IMP2
  TSOlluuSRL=TSOlluuSRL+ 1*coup1R*coup2L*IMP2
  TSOlluuSLR=TSOlluuSLR+ 1*coup1L*coup2R*IMP2
  TSOlluuVRR=TSOlluuVRR+ 0.
  TSOlluuVLL=TSOlluuVLL+ 0.
  TSOlluuVRL=TSOlluuVRL+ 0.
  TSOlluuVLR=TSOlluuVLR+ 0.
  TSOlluuTLL=TSOlluuTLL+ 0.
  TSOlluuTLR=TSOlluuTLR+ 0.
  TSOlluuTRL=TSOlluuTRL+ 0.
  TSOlluuTRR=TSOlluuTRR+ 0.
 End if 
End Do 


 ! -- Ah - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (((iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,gt1,iProp)
coup1R = cplcChaChaAhR(gt2,gt1,iProp)
coup2L = cplcFuFuAhL(gt4,gt3,iProp)
coup2R = cplcFuFuAhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSOlluuSLL=TSOlluuSLL+ 1*coup1L*coup2L*IMP2
  TSOlluuSRR=TSOlluuSRR+ 1*coup1R*coup2R*IMP2
  TSOlluuSRL=TSOlluuSRL+ 1*coup1R*coup2L*IMP2
  TSOlluuSLR=TSOlluuSLR+ 1*coup1L*coup2R*IMP2
  TSOlluuVRR=TSOlluuVRR+ 0.
  TSOlluuVLL=TSOlluuVLL+ 0.
  TSOlluuVRL=TSOlluuVRL+ 0.
  TSOlluuVLR=TSOlluuVLR+ 0.
  TSOlluuTLL=TSOlluuTLL+ 0.
  TSOlluuTLR=TSOlluuTLR+ 0.
  TSOlluuTRL=TSOlluuTRL+ 0.
  TSOlluuTRR=TSOlluuTRR+ 0.
 End if 
End Do 


 Iname=Iname-1

End Subroutine CalculateTreeS2L2u 

Subroutine CalculateTreeV2L2u(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,             & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,MGlu,MGlu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,              & 
& MSu2,MVWm,MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,         & 
& cplAhHpmcHpm,cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,           & 
& cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,   & 
& cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,              & 
& cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdChiSdL,     & 
& cplcFdChiSdR,cplcFdFdAhL,cplcFdFdAhR,cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,              & 
& cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,cplcFdFuHpmL,cplcFdFuHpmR,cplcFdFuVWmL,            & 
& cplcFdFuVWmR,cplcFdGluSdL,cplcFdGluSdR,cplcFuChiSuL,cplcFuChiSuR,cplcFuFdcHpmL,        & 
& cplcFuFdcHpmR,cplcFuFdcVWmL,cplcFuFdcVWmR,cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,         & 
& cplcFuFuhhR,cplcFuFuVGL,cplcFuFuVGR,cplcFuFuVPL,cplcFuFuVPR,cplcFuFuVZL,               & 
& cplcFuFuVZR,cplcFuGluSuL,cplcFuGluSuR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,        & 
& cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,   & 
& cplChiChihhR,cplChiChiVZL,cplChiChiVZR,cplChiFucSuL,cplChiFucSuR,cplcHpmVPVWm,         & 
& cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL,cplGluFucSuR,cplhhcHpmVWm,         & 
& cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,      & 
& cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,cplSdcHpmcSu,cplSdcSdVG,           & 
& cplSdcSdVP,cplSdcSdVZ,cplSdcSucVWm,cplSucSuVP,cplSucSuVZ,TVOlluuSLL,TVOlluuSRR,        & 
& TVOlluuSRL,TVOlluuSLR,TVOlluuVRR,TVOlluuVLL,TVOlluuVRL,TVOlluuVLR,TVOlluuTLL,          & 
& TVOlluuTLR,TVOlluuTRL,TVOlluuTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeV2L2u 
! 'PreSARAH' output has been generated  at 19:46 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),MGlu,MGlu2,Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),              & 
& MSu2(6),MVWm,MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdChiSdL(3,10,6),cplcFdChiSdR(3,10,6),     & 
& cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),           & 
& cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFdFuHpmL(3,3,8),& 
& cplcFdFuHpmR(3,3,8),cplcFdFuVWmL(3,3),cplcFdFuVWmR(3,3),cplcFdGluSdL(3,6),             & 
& cplcFdGluSdR(3,6),cplcFuChiSuL(3,10,6),cplcFuChiSuR(3,10,6),cplcFuFdcHpmL(3,3,8),      & 
& cplcFuFdcHpmR(3,3,8),cplcFuFdcVWmL(3,3),cplcFuFdcVWmR(3,3),cplcFuFuAhL(3,3,8),         & 
& cplcFuFuAhR(3,3,8),cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVGL(3,3),             & 
& cplcFuFuVGR(3,3),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),  & 
& cplcFuGluSuL(3,6),cplcFuGluSuR(3,6),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),           & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplChiFucSuL(10,3,6),cplChiFucSuR(10,3,6),     & 
& cplcHpmVPVWm(8),cplcHpmVWmVZ(8),cplcVWmVPVWm,cplcVWmVWmVZ,cplGluFucSuL(3,6),           & 
& cplGluFucSuR(3,6),cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),& 
& cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8),cplHpmcHpmVP(8,8),  & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),cplSdcHpmcSu(6,8,6),cplSdcSdVG(6,6), & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSdcSucVWm(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TVOlluuSLL 
Complex(dp), Intent(out) :: TVOlluuSRR 
Complex(dp), Intent(out) :: TVOlluuSRL 
Complex(dp), Intent(out) :: TVOlluuSLR 
Complex(dp), Intent(out) :: TVOlluuVRR 
Complex(dp), Intent(out) :: TVOlluuVLL 
Complex(dp), Intent(out) :: TVOlluuVRL 
Complex(dp), Intent(out) :: TVOlluuVLR 
Complex(dp), Intent(out) :: TVOlluuTLL 
Complex(dp), Intent(out) :: TVOlluuTLR 
Complex(dp), Intent(out) :: TVOlluuTRL 
Complex(dp), Intent(out) :: TVOlluuTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeV2L2u' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MFu(gt3)  
MassEx32=MFu2(gt3) 
MassEx4=MFu(gt4)  
MassEx42=MFu2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], UpQuark, bar[UpQuark]} 
 ! ------------------------------ 
 
TVOlluuSLL=0._dp 
TVOlluuSRR=0._dp 
TVOlluuSRL=0._dp 
TVOlluuSLR=0._dp 
TVOlluuVRR=0._dp 
TVOlluuVLL=0._dp 
TVOlluuVRL=0._dp 
TVOlluuVLR=0._dp 
TVOlluuTLL=0._dp 
TVOlluuTLR=0._dp 
TVOlluuTRL=0._dp 
TVOlluuTRR=0._dp 
!---------------------------------------- 
! Vector Tree Contributions            
!---------------------------------------- 
! -- VZ - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(gt2,gt1)
coup1R = cplcChaChaVZR(gt2,gt1)
coup2L = cplcFuFuVZL(gt4,gt3)
coup2R = cplcFuFuVZR(gt4,gt3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TVOlluuSLL=TVOlluuSLL+ 0.
  TVOlluuSRR=TVOlluuSRR+ 0.
  TVOlluuSRL=TVOlluuSRL+ 0.
  TVOlluuSLR=TVOlluuSLR+ 0.
  TVOlluuVRR=TVOlluuVRR-1*coup1R*coup2R*IMP2
  TVOlluuVLL=TVOlluuVLL-1*coup1L*coup2L*IMP2
  TVOlluuVRL=TVOlluuVRL-1*coup1R*coup2L*IMP2
  TVOlluuVLR=TVOlluuVLR-1*coup1L*coup2R*IMP2
  TVOlluuTLL=TVOlluuTLL+ 0.
  TVOlluuTLR=TVOlluuTLR+ 0.
  TVOlluuTRL=TVOlluuTRL+ 0.
  TVOlluuTRR=TVOlluuTRR+ 0.
 End if 


 Iname=Iname-1

End Subroutine CalculateTreeV2L2u 

Subroutine CalculateBox4L(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,MChi,            & 
& MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,MVWm2,              & 
& MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,            & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,BO4lSLL,BO4lSRR,BO4lSRL,BO4lSLR,           & 
& BO4lVRR,BO4lVLL,BO4lVRL,BO4lVLR,BO4lTLL,BO4lTLR,BO4lTRL,BO4lTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process Box4L 
! 'PreSARAH' output has been generated  at 18:46 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: BO4lSLL 
Complex(dp), Intent(out) :: BO4lSRR 
Complex(dp), Intent(out) :: BO4lSRL 
Complex(dp), Intent(out) :: BO4lSLR 
Complex(dp), Intent(out) :: BO4lVRR 
Complex(dp), Intent(out) :: BO4lVLL 
Complex(dp), Intent(out) :: BO4lVRL 
Complex(dp), Intent(out) :: BO4lVLR 
Complex(dp), Intent(out) :: BO4lTLL 
Complex(dp), Intent(out) :: BO4lTLR 
Complex(dp), Intent(out) :: BO4lTRL 
Complex(dp), Intent(out) :: BO4lTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateBox4L' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
BO4lSLL=0._dp 
BO4lSRR=0._dp 
BO4lSRL=0._dp 
BO4lSLR=0._dp 
BO4lVRR=0._dp 
BO4lVLL=0._dp 
BO4lVRL=0._dp 
BO4lVLR=0._dp 
BO4lTLL=0._dp 
BO4lTLR=0._dp 
BO4lTRL=0._dp 
BO4lTRR=0._dp 
!----------------------------- 
! Box Contributions            
!----------------------------- 
! Cha,Ah,Cha,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLL=BO4lVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Cha,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLL=BO4lVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Cha,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Cha,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,Ah,Cha,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLL=BO4lVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Cha,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLL=BO4lVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Cha,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Cha,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Fd,Su,Fd,Su
chargefactor = 3 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,3
  Do i2=1,6
    Do i3=1,3
      Do i4=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MSu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i4)
coup1R = cplcFdChaSuR(i1,gt1,i4)
coup2L = cplcChaFdcSuL(gt2,i1,i2)
coup2R = cplcChaFdcSuR(gt2,i1,i2)
coup3L = cplcFdChaSuL(i3,gt3,i2)
coup3R = cplcFdChaSuR(i3,gt3,i2)
coup4L = cplcChaFdcSuL(gt4,i3,i4)
coup4R = cplcChaFdcSuR(gt4,i3,i4)
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i4)
mS12 = MSu2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MSu(i2)
mS22 = MSu2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLL=BO4lVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,Ah,Cha,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Cha,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Cha,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRR=BO4lVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -               & 
&  3.*int2)
  BO4lVLL=BO4lVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -               & 
&  3.*int2)
  BO4lVRL=BO4lVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Cha,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRR=BO4lVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -               & 
&  3.*int2)
  BO4lVLL=BO4lVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -               & 
&  3.*int2)
  BO4lVRL=BO4lVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,Cha,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Cha,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Cha,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRR=BO4lVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -               & 
&  3.*int2)
  BO4lVLL=BO4lVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -               & 
&  3.*int2)
  BO4lVRL=BO4lVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Cha,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRR=BO4lVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -               & 
&  3.*int2)
  BO4lVLL=BO4lVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -               & 
&  3.*int2)
  BO4lVRL=BO4lVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Chi,conj[Hpm],Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplChiChacHpmL(i3,gt3,i2)
coup3R = cplChiChacHpmR(i3,gt3,i2)
coup4L = cplcChaChiHpmL(gt4,i3,i4)
coup4R = cplcChaChiHpmR(gt4,i3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLL=BO4lVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,conj[VWm],Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,10
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplChiChacVWmL(i3,gt3)
coup3R = cplChiChacVWmR(i3,gt3)
coup4L = cplcChaChiHpmL(gt4,i3,i4)
coup4R = cplcChaChiHpmR(gt4,i3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! bar[Fu],conj[Sd],bar[Fu],conj[Sd]
chargefactor = 3 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,3
  Do i2=1,6
    Do i3=1,3
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(gt2,i1,i2)
coup2R = cplcChacFuSdR(gt2,i1,i2)
coup3L = cplChaFucSdL(gt3,i3,i2)
coup3R = cplChaFucSdR(gt3,i3,i2)
coup4L = cplcChacFuSdL(gt4,i3,i4)
coup4R = cplcChacFuSdR(gt4,i3,i4)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLL=BO4lVLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,conj[Hpm],Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplChiChacHpmL(i3,gt3,i2)
coup3R = cplChiChacHpmR(i3,gt3,i2)
coup4L = cplcChaChiVWmL(gt4,i3)
coup4R = cplcChaChiVWmR(gt4,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSRR=BO4lSRR+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 - 2.*int2)
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 - 2.*int2)
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Chi,conj[VWm],Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,10
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplChiChacVWmL(i3,gt3)
coup3R = cplChiChacVWmR(i3,gt3)
coup4L = cplcChaChiVWmL(gt4,i3)
coup4R = cplcChaChiVWmR(gt4,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRR=BO4lVRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -               & 
&  3.*int2)
  BO4lVLL=BO4lVLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -               & 
&  3.*int2)
  BO4lVRL=BO4lVRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,Ah,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLR=BO4lSLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLL=BO4lTLL+0.
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,Ah,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRR=BO4lVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLL=BO4lVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRL=BO4lVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRR=BO4lVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLL=BO4lVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRL=BO4lVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRR=BO4lVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLL=BO4lVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRL=BO4lVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRL=BO4lSRL - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLR=BO4lSLR - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRR=BO4lVRR+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLL=BO4lVLL+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRL=BO4lVRL+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Chi,Hpm,Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt4,i3,i4)
coup2R = cplcChaChiHpmR(gt4,i3,i4)
coup3L = cplChiChacHpmL(i1,gt3,i2)
coup3R = cplChiChacHpmR(i1,gt3,i2)
coup4L = cplcChaChiHpmL(gt2,i3,i2)
coup4R = cplcChaChiHpmR(gt2,i3,i2)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLL=BO4lSLL+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRR=BO4lSRR+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRL=BO4lSRL - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLR=BO4lSLR - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRR=BO4lVRR - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLL=BO4lVLL - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRL=BO4lVRL - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLR=BO4lVLR - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLL=BO4lTLL+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,VWm,Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 3
Do i1=1,10
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt4,i3,i4)
coup2R = cplcChaChiHpmR(gt4,i3,i4)
coup3L = cplChiChacVWmL(i1,gt3)
coup3R = cplChiChacVWmR(i1,gt3)
coup4L = cplcChaChiVWmL(gt2,i3)
coup4R = cplcChaChiVWmR(gt2,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -               & 
&  8.*int2)
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -               & 
&  8.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 - 2.*int2)
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 - 2.*int2)
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLL=BO4lTLL - 0.25*chargefactor*coup1L*coup2L*coup3L*coup4R*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 0.25*chargefactor*coup1R*coup2R*coup3R*coup4L*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Chi,Hpm,Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 3
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChacHpmL(i1,gt3,i2)
coup3R = cplChiChacHpmR(i1,gt3,i2)
coup4L = cplcChaChiHpmL(gt2,i3,i2)
coup4R = cplcChaChiHpmR(gt2,i3,i2)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLL=BO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -               & 
&  8.*int2)
  BO4lSRR=BO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -               & 
&  8.*int2)
  BO4lSRL=BO4lSRL+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lSLR=BO4lSLR+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lVRR=BO4lVRR+chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 - 2.*int2)
  BO4lVLL=BO4lVLL+chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 - 2.*int2)
  BO4lVRL=BO4lVRL+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLR=BO4lVLR+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLL=BO4lTLL - 0.25*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR - 0.25*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Chi,VWm,Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 3
Do i1=1,10
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChacVWmL(i1,gt3)
coup3R = cplChiChacVWmR(i1,gt3)
coup4L = cplcChaChiVWmL(gt2,i3)
coup4R = cplcChaChiVWmR(gt2,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLL=BO4lSLL - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRR=BO4lSRR - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRL=BO4lSRL - 8.*chargefactor*coup1R*coup2R*coup3L*coup4L*(int1 -               & 
&  3.*int2)
  BO4lSLR=BO4lSLR - 8.*chargefactor*coup1L*coup2L*coup3R*coup4R*(int1 -               & 
&  3.*int2)
  BO4lVRR=BO4lVRR - 2.*chargefactor*coup1R*coup2R*coup3R*coup4R*int3
  BO4lVLL=BO4lVLL - 2.*chargefactor*coup1L*coup2L*coup3L*coup4L*int3
  BO4lVRL=BO4lVRL - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLR=BO4lVLR - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLL=BO4lTLL+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLR=BO4lTLR+0.
  BO4lTRL=BO4lTRL+0.
  BO4lTRR=BO4lTRR+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 BO4lSLL=oo16pi2*BO4lSLL 
BO4lSRR=oo16pi2*BO4lSRR 
BO4lSRL=oo16pi2*BO4lSRL 
BO4lSLR=oo16pi2*BO4lSLR 
BO4lVRR=oo16pi2*BO4lVRR 
BO4lVLL=oo16pi2*BO4lVLL 
BO4lVRL=oo16pi2*BO4lVRL 
BO4lVLR=oo16pi2*BO4lVLR 
BO4lTLL=oo16pi2*BO4lTLL 
BO4lTLR=oo16pi2*BO4lTLR 
BO4lTRL=oo16pi2*BO4lTRL 
BO4lTRR=oo16pi2*BO4lTRR 
Iname=Iname-1

End Subroutine CalculateBox4L 

Subroutine CalculatePengS4L(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,               & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,PSO4lSLL,PSO4lSRR,PSO4lSRL,PSO4lSLR,       & 
& PSO4lVRR,PSO4lVLL,PSO4lVRL,PSO4lVLR,PSO4lTLL,PSO4lTLR,PSO4lTRL,PSO4lTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengS4L 
! 'PreSARAH' output has been generated  at 18:47 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PSO4lSLL 
Complex(dp), Intent(out) :: PSO4lSRR 
Complex(dp), Intent(out) :: PSO4lSRL 
Complex(dp), Intent(out) :: PSO4lSLR 
Complex(dp), Intent(out) :: PSO4lVRR 
Complex(dp), Intent(out) :: PSO4lVLL 
Complex(dp), Intent(out) :: PSO4lVRL 
Complex(dp), Intent(out) :: PSO4lVLR 
Complex(dp), Intent(out) :: PSO4lTLL 
Complex(dp), Intent(out) :: PSO4lTLR 
Complex(dp), Intent(out) :: PSO4lTRL 
Complex(dp), Intent(out) :: PSO4lTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengS4L' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
PSO4lSLL=0._dp 
PSO4lSRR=0._dp 
PSO4lSRL=0._dp 
PSO4lSLR=0._dp 
PSO4lVRR=0._dp 
PSO4lVLL=0._dp 
PSO4lVRL=0._dp 
PSO4lVLR=0._dp 
PSO4lTLL=0._dp 
PSO4lTLR=0._dp 
PSO4lTRL=0._dp 
PSO4lTRR=0._dp 
!---------------------------------------- 
! Scalar Wave Contributions            
!---------------------------------------- 
! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLL=PSO4lSLL+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLL=PSO4lSLL+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRR=PSO4lSRR+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRL=PSO4lSRL+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(-           & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLR=PSO4lSLR+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(-           & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 !---------------------------------------- 
! Scalar Penguin Contributions            
!---------------------------------------- 
! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSO4lSLL=PSO4lSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSO4lSLL=PSO4lSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplhhSucSu(iProp,i3,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,iProp)
coup3R = cplcFuFuhhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSO4lSLL=PSO4lSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSO4lSLL=PSO4lSLL+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt3,i2)
coup1R = cplcFdChaSuR(i1,gt3,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplhhSucSu(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i2,i1)
coup1R = cplChaFucSdR(gt3,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,iProp)
coup3R = cplcFuFuhhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt3)
coup1R = cplChiChacVWmR(i2,gt3)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplAhSucSu(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuAhL(i2,i3,iProp)
coup3R = cplcFuFuAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +              & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLL=PSO4lSLL - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRR=PSO4lSRR - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSRL=PSO4lSRL - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lSLR=PSO4lSLR - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +         & 
&  int2*mF12)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt3,i2)
coup1R = cplcFdChaSuR(i1,gt3,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplAhSucSu(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i2,i1)
coup1R = cplChaFucSdR(gt3,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = cplcFuFuAhL(i2,i3,iProp)
coup3R = cplcFuFuAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLL=PSO4lSLL+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3R*int1 +             & 
&  coup3L*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3L*int1 +             & 
&  coup3R*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt3)
coup1R = cplChiChacVWmR(i2,gt3)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLL=PSO4lSLL+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSRR=PSO4lSRR+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lSRL=PSO4lSRL+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3L*(Finite -       & 
&  2.*int1) - 2.*coup3R*int2*mF1*mF2)
  PSO4lSLR=PSO4lSLR+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3R*(Finite -       & 
&  2.*int1) - 2.*coup3L*int2*mF1*mF2)
  PSO4lVRR=PSO4lVRR+0.
  PSO4lVLL=PSO4lVLL+0.
  PSO4lVRL=PSO4lVRL+0.
  PSO4lVLR=PSO4lVLR+0.
  PSO4lTLL=PSO4lTLL+0.
  PSO4lTLR=PSO4lTLR+0.
  PSO4lTRL=PSO4lTRL+0.
  PSO4lTRR=PSO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 PSO4lSLL=oo16pi2*PSO4lSLL 
PSO4lSRR=oo16pi2*PSO4lSRR 
PSO4lSRL=oo16pi2*PSO4lSRL 
PSO4lSLR=oo16pi2*PSO4lSLR 
PSO4lVRR=oo16pi2*PSO4lVRR 
PSO4lVLL=oo16pi2*PSO4lVLL 
PSO4lVRL=oo16pi2*PSO4lVRL 
PSO4lVLR=oo16pi2*PSO4lVLR 
PSO4lTLL=oo16pi2*PSO4lTLL 
PSO4lTLR=oo16pi2*PSO4lTLR 
PSO4lTRL=oo16pi2*PSO4lTRL 
PSO4lTRR=oo16pi2*PSO4lTRR 
Iname=Iname-1

End Subroutine CalculatePengS4L 

Subroutine CalculatePengV4L(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,               & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,PVO4lSLL,PVO4lSRR,PVO4lSRL,PVO4lSLR,       & 
& PVO4lVRR,PVO4lVLL,PVO4lVRL,PVO4lVLR,PVO4lTLL,PVO4lTLR,PVO4lTRL,PVO4lTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengV4L 
! 'PreSARAH' output has been generated  at 18:49 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PVO4lSLL 
Complex(dp), Intent(out) :: PVO4lSRR 
Complex(dp), Intent(out) :: PVO4lSRL 
Complex(dp), Intent(out) :: PVO4lSLR 
Complex(dp), Intent(out) :: PVO4lVRR 
Complex(dp), Intent(out) :: PVO4lVLL 
Complex(dp), Intent(out) :: PVO4lVRL 
Complex(dp), Intent(out) :: PVO4lVLR 
Complex(dp), Intent(out) :: PVO4lTLL 
Complex(dp), Intent(out) :: PVO4lTLR 
Complex(dp), Intent(out) :: PVO4lTRL 
Complex(dp), Intent(out) :: PVO4lTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengV4L' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
PVO4lSLL=0._dp 
PVO4lSRR=0._dp 
PVO4lSRL=0._dp 
PVO4lSLR=0._dp 
PVO4lVRR=0._dp 
PVO4lVLL=0._dp 
PVO4lVRL=0._dp 
PVO4lVLR=0._dp 
PVO4lTLL=0._dp 
PVO4lTLR=0._dp 
PVO4lTRL=0._dp 
PVO4lTRR=0._dp 
!---------------------------------------- 
! Vector Wave Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -   & 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -   & 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -   & 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -   & 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -   & 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -   & 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -   & 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -   & 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLL=PVO4lVLL+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRL=PVO4lVRL+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-               & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLR=PVO4lVLR+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-               & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 !---------------------------------------- 
! Vector Penguin Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV22, mV12)
  int3=C0check(mF12, mV22, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV12, mV22)
  int3=C0check(mF12, mV12, mV22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-1.*Finite +        & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt3,i2)
coup1R = cplcFdChaSuR(i1,gt3,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLL=PVO4lVLL+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRL=PVO4lVRL+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLR=PVO4lVLR+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i2,i1)
coup1R = cplChaFucSdR(gt3,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mS12)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR+chargefactor*coup1R*coup2L*coup4R*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL+chargefactor*coup1L*coup2R*coup4L*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL+chargefactor*coup1L*coup2R*coup4R*IMP2*(coup3R*(int1 -            & 
&  2.*int2) - 1.*coup3L*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR+chargefactor*coup1R*coup2L*coup4L*IMP2*(coup3L*(int1 -            & 
&  2.*int2) - 1.*coup3R*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt3)
coup1R = cplChiChacVWmR(i2,gt3)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0C0check(mF22, mF12, mV12)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLL=PVO4lSLL+0.
  PVO4lSRR=PVO4lSRR+0.
  PVO4lSRL=PVO4lSRL+0.
  PVO4lSLR=PVO4lSLR+0.
  PVO4lVRR=PVO4lVRR - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lVLL=PVO4lVLL - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lVRL=PVO4lVRL - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3R*int3*mF1*mF2)
  PVO4lVLR=PVO4lVLR - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*(Finite -     & 
&  2.*int1 + 4.*int2) + 2.*coup3L*int3*mF1*mF2)
  PVO4lTLL=PVO4lTLL+0.
  PVO4lTLR=PVO4lTLR+0.
  PVO4lTRL=PVO4lTRL+0.
  PVO4lTRR=PVO4lTRR+0.
  End if 
End if 
   End Do 
  End Do 


 PVO4lSLL=oo16pi2*PVO4lSLL
PVO4lSRR=oo16pi2*PVO4lSRR
PVO4lSRL=oo16pi2*PVO4lSRL
PVO4lSLR=oo16pi2*PVO4lSLR
PVO4lVRR=oo16pi2*PVO4lVRR
PVO4lVLL=oo16pi2*PVO4lVLL
PVO4lVRL=oo16pi2*PVO4lVRL
PVO4lVLR=oo16pi2*PVO4lVLR
PVO4lTLL=oo16pi2*PVO4lTLL
PVO4lTLR=oo16pi2*PVO4lTLR
PVO4lTRL=oo16pi2*PVO4lTRL
PVO4lTRR=oo16pi2*PVO4lTRR
Iname=Iname-1

End Subroutine CalculatePengV4L 

Subroutine CalculateTreeS4L(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,               & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,TSO4lSLL,TSO4lSRR,TSO4lSRL,TSO4lSLR,       & 
& TSO4lVRR,TSO4lVLL,TSO4lVRL,TSO4lVLR,TSO4lTLL,TSO4lTLR,TSO4lTRL,TSO4lTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeS4L 
! 'PreSARAH' output has been generated  at 18:49 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TSO4lSLL 
Complex(dp), Intent(out) :: TSO4lSRR 
Complex(dp), Intent(out) :: TSO4lSRL 
Complex(dp), Intent(out) :: TSO4lSLR 
Complex(dp), Intent(out) :: TSO4lVRR 
Complex(dp), Intent(out) :: TSO4lVLL 
Complex(dp), Intent(out) :: TSO4lVRL 
Complex(dp), Intent(out) :: TSO4lVLR 
Complex(dp), Intent(out) :: TSO4lTLL 
Complex(dp), Intent(out) :: TSO4lTLR 
Complex(dp), Intent(out) :: TSO4lTRL 
Complex(dp), Intent(out) :: TSO4lTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeS4L' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
TSO4lSLL=0._dp 
TSO4lSRR=0._dp 
TSO4lSRL=0._dp 
TSO4lSLR=0._dp 
TSO4lVRR=0._dp 
TSO4lVLL=0._dp 
TSO4lVRL=0._dp 
TSO4lVLR=0._dp 
TSO4lTLL=0._dp 
TSO4lTLR=0._dp 
TSO4lTRL=0._dp 
TSO4lTRR=0._dp 
!---------------------------------------- 
! Scalar Tree Contributions            
!---------------------------------------- 
! -- hh - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,gt1,iProp)
coup1R = cplcChaChahhR(gt2,gt1,iProp)
coup2L = cplcChaChahhL(gt4,gt3,iProp)
coup2R = cplcChaChahhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSO4lSLL=TSO4lSLL+ 1*coup1L*coup2L*IMP2
  TSO4lSRR=TSO4lSRR+ 1*coup1R*coup2R*IMP2
  TSO4lSRL=TSO4lSRL+ 1*coup1R*coup2L*IMP2
  TSO4lSLR=TSO4lSLR+ 1*coup1L*coup2R*IMP2
  TSO4lVRR=TSO4lVRR+ 0.
  TSO4lVLL=TSO4lVLL+ 0.
  TSO4lVRL=TSO4lVRL+ 0.
  TSO4lVLR=TSO4lVLR+ 0.
  TSO4lTLL=TSO4lTLL+ 0.
  TSO4lTLR=TSO4lTLR+ 0.
  TSO4lTRL=TSO4lTRL+ 0.
  TSO4lTRR=TSO4lTRR+ 0.
 End if 
End Do 


 ! -- Ah - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (((iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,gt1,iProp)
coup1R = cplcChaChaAhR(gt2,gt1,iProp)
coup2L = cplcChaChaAhL(gt4,gt3,iProp)
coup2R = cplcChaChaAhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSO4lSLL=TSO4lSLL+ 1*coup1L*coup2L*IMP2
  TSO4lSRR=TSO4lSRR+ 1*coup1R*coup2R*IMP2
  TSO4lSRL=TSO4lSRL+ 1*coup1R*coup2L*IMP2
  TSO4lSLR=TSO4lSLR+ 1*coup1L*coup2R*IMP2
  TSO4lVRR=TSO4lVRR+ 0.
  TSO4lVLL=TSO4lVLL+ 0.
  TSO4lVRL=TSO4lVRL+ 0.
  TSO4lVLR=TSO4lVLR+ 0.
  TSO4lTLL=TSO4lTLL+ 0.
  TSO4lTLR=TSO4lTLR+ 0.
  TSO4lTRL=TSO4lTRL+ 0.
  TSO4lTRR=TSO4lTRR+ 0.
 End if 
End Do 


 Iname=Iname-1

End Subroutine CalculateTreeS4L 

Subroutine CalculateTreeV4L(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,               & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,TVO4lSLL,TVO4lSRR,TVO4lSRL,TVO4lSLR,       & 
& TVO4lVRR,TVO4lVLL,TVO4lVRL,TVO4lVLR,TVO4lTLL,TVO4lTLR,TVO4lTRL,TVO4lTRR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeV4L 
! 'PreSARAH' output has been generated  at 18:49 on 4.3.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TVO4lSLL 
Complex(dp), Intent(out) :: TVO4lSRR 
Complex(dp), Intent(out) :: TVO4lSRL 
Complex(dp), Intent(out) :: TVO4lSLR 
Complex(dp), Intent(out) :: TVO4lVRR 
Complex(dp), Intent(out) :: TVO4lVLL 
Complex(dp), Intent(out) :: TVO4lVRL 
Complex(dp), Intent(out) :: TVO4lVLR 
Complex(dp), Intent(out) :: TVO4lTLL 
Complex(dp), Intent(out) :: TVO4lTLR 
Complex(dp), Intent(out) :: TVO4lTRL 
Complex(dp), Intent(out) :: TVO4lTRR 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeV4L' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
TVO4lSLL=0._dp 
TVO4lSRR=0._dp 
TVO4lSRL=0._dp 
TVO4lSLR=0._dp 
TVO4lVRR=0._dp 
TVO4lVLL=0._dp 
TVO4lVRL=0._dp 
TVO4lVLR=0._dp 
TVO4lTLL=0._dp 
TVO4lTLR=0._dp 
TVO4lTRL=0._dp 
TVO4lTRR=0._dp 
!---------------------------------------- 
! Vector Tree Contributions            
!---------------------------------------- 
! -- VZ - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(gt2,gt1)
coup1R = cplcChaChaVZR(gt2,gt1)
coup2L = cplcChaChaVZL(gt4,gt3)
coup2R = cplcChaChaVZR(gt4,gt3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TVO4lSLL=TVO4lSLL+ 0.
  TVO4lSRR=TVO4lSRR+ 0.
  TVO4lSRL=TVO4lSRL+ 0.
  TVO4lSLR=TVO4lSLR+ 0.
  TVO4lVRR=TVO4lVRR-1*coup1R*coup2R*IMP2
  TVO4lVLL=TVO4lVLL-1*coup1L*coup2L*IMP2
  TVO4lVRL=TVO4lVRL-1*coup1R*coup2L*IMP2
  TVO4lVLR=TVO4lVLR-1*coup1L*coup2R*IMP2
  TVO4lTLL=TVO4lTLL+ 0.
  TVO4lTLR=TVO4lTLR+ 0.
  TVO4lTRL=TVO4lTRL+ 0.
  TVO4lTRR=TVO4lTRR+ 0.
 End if 


 Iname=Iname-1

End Subroutine CalculateTreeV4L 

Subroutine CalculateBox4Lcross(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,            & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,BO4lSLLcross,BO4lSRRcross,BO4lSRLcross,    & 
& BO4lSLRcross,BO4lVRRcross,BO4lVLLcross,BO4lVRLcross,BO4lVLRcross,BO4lTLLcross,         & 
& BO4lTLRcross,BO4lTRLcross,BO4lTRRcross)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process Box4Lcross 
! 'PreSARAH' output has been generated  at 13:53 on 1.7.2014 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: BO4lSLLcross 
Complex(dp), Intent(out) :: BO4lSRRcross 
Complex(dp), Intent(out) :: BO4lSRLcross 
Complex(dp), Intent(out) :: BO4lSLRcross 
Complex(dp), Intent(out) :: BO4lVRRcross 
Complex(dp), Intent(out) :: BO4lVLLcross 
Complex(dp), Intent(out) :: BO4lVRLcross 
Complex(dp), Intent(out) :: BO4lVLRcross 
Complex(dp), Intent(out) :: BO4lTLLcross 
Complex(dp), Intent(out) :: BO4lTLRcross 
Complex(dp), Intent(out) :: BO4lTRLcross 
Complex(dp), Intent(out) :: BO4lTRRcross 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateBox4Lcross' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
BO4lSLLcross=0._dp 
BO4lSRRcross=0._dp 
BO4lSRLcross=0._dp 
BO4lSLRcross=0._dp 
BO4lVRRcross=0._dp 
BO4lVLLcross=0._dp 
BO4lVRLcross=0._dp 
BO4lVLRcross=0._dp 
BO4lTLLcross=0._dp 
BO4lTLRcross=0._dp 
BO4lTRLcross=0._dp 
BO4lTRRcross=0._dp 
!----------------------------- 
! Box Contributions            
!----------------------------- 
! Cha,Ah,Cha,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Cha,Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Cha,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Cha,Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChaAhL(gt4,i3,i4)
coup4R = cplcChaChaAhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Hpm,Chi,Hpm,Chi
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,10
    Do i3=1,8
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplChiChacHpmL(i2,gt3,i3)
coup3R = cplChiChacHpmR(i2,gt3,i3)
coup4L = cplcChaChiHpmL(gt4,i4,i3)
coup4R = cplcChaChiHpmR(gt4,i4,i3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Hpm,Chi,VWm,Chi
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,10
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplChiChacVWmL(i2,gt3)
coup3R = cplChiChacVWmR(i2,gt3)
coup4L = cplcChaChiVWmL(gt4,i4)
coup4R = cplcChaChiVWmR(gt4,i4)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mV2 = MVWm
mV22 = MVWm2
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 - & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 - & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -         & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +     & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! VWm,Chi,Hpm,Chi
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,10
    Do i3=1,8
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplChiChacHpmL(i2,gt3,i3)
coup3R = cplChiChacHpmR(i2,gt3,i3)
coup4L = cplcChaChiHpmL(gt4,i4,i3)
coup4R = cplcChaChiHpmR(gt4,i4,i3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 - & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 - & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +     & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -         & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VWm,Chi,VWm,Chi
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 1
  Do i2=1,10
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplChiChacVWmL(i2,gt3)
coup3R = cplChiChacVWmR(i2,gt3)
coup4L = cplcChaChiVWmL(gt4,i4)
coup4R = cplcChaChiVWmR(gt4,i4)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mV2 = MVWm
mV22 = MVWm2
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=C0D0check(mF22, mF12, mV22, mV12)
  int2=D00check(mF22, mF12, mV12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross+8.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross+8.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross+8.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross+8.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
   End Do 
End Do 


 ! Sd,Fu,Sd,Fu
chargefactor = 3 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
    Do i3=1,6
      Do i4=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3)).Or.(MFu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i4,i1)
coup1R = cplChaFucSdR(gt1,i4,i1)
coup2L = cplcChacFuSdL(gt2,i2,i1)
coup2R = cplcChacFuSdR(gt2,i2,i1)
coup3L = cplChaFucSdL(gt3,i2,i3)
coup3R = cplChaFucSdR(gt3,i2,i3)
coup4L = cplcChacFuSdL(gt4,i4,i3)
coup4R = cplcChacFuSdR(gt4,i4,i3)
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i4)
mF12 = MFu2(i4)
mS2 = MSd(i3)
mS22 = MSd2(i3)
mF2 = MFu(i2)
mF22 = MFu2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,Ah,Cha,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,Cha,hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,Cha,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,Cha,hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChahhL(gt4,i3,i4)
coup4R = cplcChaChahhR(gt4,i3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Fd,Su,Fd,Su
chargefactor = 3 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,3
  Do i2=1,6
    Do i3=1,3
      Do i4=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3)).Or.(MSu2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i4)
coup1R = cplcFdChaSuR(i1,gt1,i4)
coup2L = cplcChaFdcSuL(gt2,i1,i2)
coup2R = cplcChaFdcSuR(gt2,i1,i2)
coup3L = cplcFdChaSuL(i3,gt3,i2)
coup3R = cplcFdChaSuR(i3,gt3,i2)
coup4L = cplcChaFdcSuL(gt4,i3,i4)
coup4R = cplcChaFdcSuR(gt4,i3,i4)
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i4)
mS12 = MSu2(i4)
mF2 = MFd(i3)
mF22 = MFd2(i3)
mS2 = MSu(i2)
mS22 = MSu2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,Ah,Cha,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Cha,VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Cha,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Cha,VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChaVPL(gt4,i3)
coup4R = cplcChaChaVPR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,Cha,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(i3,gt3,i2)
coup3R = cplcChaChaAhR(i3,gt3,i2)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,Cha,VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(i3,gt3,i2)
coup3R = cplcChaChahhR(i3,gt3,i2)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,Cha,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(i3,gt3)
coup3R = cplcChaChaVPR(i3,gt3)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,Cha,VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = cplcChaChaVZL(gt4,i3)
coup4R = cplcChaChaVZR(gt4,i3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Ah,bar[Cha],Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i2,i1)
coup2R = cplcChaChaAhR(gt2,i2,i1)
coup3L = cplcChaChaAhL(i2,gt3,i3)
coup3R = cplcChaChaAhR(i2,gt3,i3)
coup4L = cplcChaChaAhL(gt4,i4,i3)
coup4R = cplcChaChaAhR(gt4,i4,i3)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Ah,bar[Cha],hh,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i2,i1)
coup2R = cplcChaChaAhR(gt2,i2,i1)
coup3L = cplcChaChahhL(i2,gt3,i3)
coup3R = cplcChaChahhR(i2,gt3,i3)
coup4L = cplcChaChahhL(gt4,i4,i3)
coup4R = cplcChaChahhR(gt4,i4,i3)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Ah,bar[Cha],VP,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i2,i1)
coup2R = cplcChaChaAhR(gt2,i2,i1)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChaVPL(gt4,i4)
coup4R = cplcChaChaVPR(gt4,i4)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 - & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 - & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -         & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +     & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Ah,bar[Cha],VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i2,i1)
coup2R = cplcChaChaAhR(gt2,i2,i1)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChaVZL(gt4,i4)
coup4R = cplcChaChaVZR(gt4,i4)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 - & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 - & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -         & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +     & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! hh,bar[Cha],Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt2,i2,i1)
coup2R = cplcChaChahhR(gt2,i2,i1)
coup3L = cplcChaChaAhL(i2,gt3,i3)
coup3R = cplcChaChaAhR(i2,gt3,i3)
coup4L = cplcChaChaAhL(gt4,i4,i3)
coup4R = cplcChaChaAhR(gt4,i4,i3)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! hh,bar[Cha],hh,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt2,i2,i1)
coup2R = cplcChaChahhR(gt2,i2,i1)
coup3L = cplcChaChahhL(i2,gt3,i3)
coup3R = cplcChaChahhR(i2,gt3,i3)
coup4L = cplcChaChahhL(gt4,i4,i3)
coup4R = cplcChaChahhR(gt4,i4,i3)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! hh,bar[Cha],VP,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt2,i2,i1)
coup2R = cplcChaChahhR(gt2,i2,i1)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChaVPL(gt4,i4)
coup4R = cplcChaChaVPR(gt4,i4)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 - & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 - & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -         & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +     & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! hh,bar[Cha],VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 1
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt2,i2,i1)
coup2R = cplcChaChahhR(gt2,i2,i1)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChaVZL(gt4,i4)
coup4R = cplcChaChaVZR(gt4,i4)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mS12)
  int2=D00check(mF22, mF12, mS12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2R*coup3R*coup4L*int2 - & 
&  1.*coup1L*coup2L*coup3L*coup4R*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2L*coup3L*coup4R*int2 - & 
&  1.*coup1R*coup2R*coup3R*coup4L*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2R*coup3R*coup4L -         & 
&  1.*coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1R*coup2R*coup3L*coup4R*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2R*coup3R*coup4L +     & 
&  coup1L*coup2L*coup3L*coup4R)*int2 - 2.*coup1L*coup2L*coup3R*coup4L*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2L*coup3L*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2R*coup3R*coup4L*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2R*coup3R*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2L*coup3L*coup4R*int2)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! VP,bar[Cha],Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVPL(gt2,i2)
coup2R = cplcChaChaVPR(gt2,i2)
coup3L = cplcChaChaAhL(i2,gt3,i3)
coup3R = cplcChaChaAhR(i2,gt3,i3)
coup4L = cplcChaChaAhL(gt4,i4,i3)
coup4R = cplcChaChaAhR(gt4,i4,i3)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 - & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 - & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +     & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -         & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VP,bar[Cha],hh,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVPL(gt2,i2)
coup2R = cplcChaChaVPR(gt2,i2)
coup3L = cplcChaChahhL(i2,gt3,i3)
coup3R = cplcChaChahhR(i2,gt3,i3)
coup4L = cplcChaChahhL(gt4,i4,i3)
coup4R = cplcChaChahhR(gt4,i4,i3)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 - & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 - & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +     & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -         & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VP,bar[Cha],VP,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 1
  Do i2=1,5
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVPL(gt2,i2)
coup2R = cplcChaChaVPR(gt2,i2)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChaVPL(gt4,i4)
coup4R = cplcChaChaVPR(gt4,i4)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mV12)
  int2=D00check(mF22, mF12, mV12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross+8.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross+8.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross+8.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross+8.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
   End Do 
End Do 


 ! VP,bar[Cha],VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 1
  Do i2=1,5
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVPL(gt2,i2)
coup2R = cplcChaChaVPR(gt2,i2)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChaVZL(gt4,i4)
coup4R = cplcChaChaVZR(gt4,i4)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mV12)
  int2=D00check(mF22, mF12, mV12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross+8.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross+8.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross+8.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross+8.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
   End Do 
End Do 


 ! VZ,bar[Cha],Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVZL(gt2,i2)
coup2R = cplcChaChaVZR(gt2,i2)
coup3L = cplcChaChaAhL(i2,gt3,i3)
coup3R = cplcChaChaAhR(i2,gt3,i3)
coup4L = cplcChaChaAhL(gt4,i4,i3)
coup4R = cplcChaChaAhR(gt4,i4,i3)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 - & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 - & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +     & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -         & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VZ,bar[Cha],hh,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 1
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVZL(gt2,i2)
coup2R = cplcChaChaVZR(gt2,i2)
coup3L = cplcChaChahhL(i2,gt3,i3)
coup3R = cplcChaChahhR(i2,gt3,i3)
coup4L = cplcChaChahhL(gt4,i4,i3)
coup4R = cplcChaChahhR(gt4,i4,i3)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mS22, mV12)
  int2=D00check(mF22, mF12, mV12, mS22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.25*chargefactor*(-3.*coup1R*coup2L*coup3R*coup4R*int2 - & 
&  1.*coup1L*coup2R*coup3L*coup4L*(4.*int1 + 13.*int2))
  BO4lSRRcross=BO4lSRRcross+0.25*chargefactor*(-3.*coup1L*coup2R*coup3L*coup4L*int2 - & 
&  1.*coup1R*coup2L*coup3R*coup4R*(4.*int1 + 13.*int2))
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2R*coup3L*coup4L +     & 
&  coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1R*coup2L*coup3L*coup4L*int3)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2R*coup3L*coup4L -         & 
&  1.*coup1R*coup2L*coup3R*coup4R)*int2 - 2.*coup1L*coup2R*coup3R*coup4R*int3)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -     & 
&  2.*int2)
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -     & 
&  2.*int2)
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(coup1L*coup2R*coup3L*coup4L*(4.*int1 -& 
&  21.*int2) + 5.*coup1R*coup2L*coup3R*coup4R*int2)
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(coup1R*coup2L*coup3R*coup4R*(4.*int1 -& 
&  21.*int2) + 5.*coup1L*coup2R*coup3L*coup4L*int2)
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VZ,bar[Cha],VP,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 1
  Do i2=1,5
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVZL(gt2,i2)
coup2R = cplcChaChaVZR(gt2,i2)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChaVPL(gt4,i4)
coup4R = cplcChaChaVPR(gt4,i4)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mV12)
  int2=D00check(mF22, mF12, mV12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross+8.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross+8.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross+8.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross+8.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
   End Do 
End Do 


 ! VZ,bar[Cha],VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 1
  Do i2=1,5
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVZL(gt2,i2)
coup2R = cplcChaChaVZR(gt2,i2)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChaVZL(gt4,i4)
coup4R = cplcChaChaVZR(gt4,i4)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=C0D0check(mF22, mF12, mV22, mV12)
  int2=D00check(mF22, mF12, mV12, mV22)
  int3=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross+8.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross+8.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross+8.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross+8.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
   End Do 
End Do 


 ! conj[Su],bar[Fd],conj[Su],bar[Fd]
chargefactor = 3 
! Generic diagram: SFFS,  InsertionOrder: 1
Do i1=1,6
  Do i2=1,3
    Do i3=1,6
      Do i4=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3)).Or.(MFd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i4,gt1,i1)
coup1R = cplcFdChaSuR(i4,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i2,i1)
coup2R = cplcChaFdcSuR(gt2,i2,i1)
coup3L = cplcFdChaSuL(i2,gt3,i3)
coup3R = cplcFdChaSuR(i2,gt3,i3)
coup4L = cplcChaFdcSuL(gt4,i4,i3)
coup4R = cplcChaFdcSuR(gt4,i4,i3)
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i4)
mF12 = MFd2(i4)
mS2 = MSu(i3)
mS22 = MSu2(i3)
mF2 = MFd(i2)
mF22 = MFd2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,conj[Hpm],Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplChiChacHpmL(i3,gt3,i2)
coup3R = cplChiChacHpmR(i3,gt3,i2)
coup4L = cplcChaChiHpmL(gt4,i3,i4)
coup4R = cplcChaChiHpmR(gt4,i3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,conj[VWm],Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 1
Do i1=1,10
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplChiChacVWmL(i3,gt3)
coup3R = cplChiChacVWmR(i3,gt3)
coup4L = cplcChaChiHpmL(gt4,i3,i4)
coup4R = cplcChaChiHpmR(gt4,i3,i4)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*int2
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! bar[Fu],conj[Sd],bar[Fu],conj[Sd]
chargefactor = 3 
! Generic diagram: FSSF,  InsertionOrder: 1
Do i1=1,3
  Do i2=1,6
    Do i3=1,3
      Do i4=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3)).Or.(MSd2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i4)
coup1R = cplChaFucSdR(gt1,i1,i4)
coup2L = cplcChacFuSdL(gt2,i1,i2)
coup2R = cplcChacFuSdR(gt2,i1,i2)
coup3L = cplChaFucSdL(gt3,i3,i2)
coup3R = cplChaFucSdR(gt3,i3,i2)
coup4L = cplcChacFuSdL(gt4,i3,i4)
coup4R = cplcChacFuSdR(gt4,i3,i4)
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i4)
mS12 = MSd2(i4)
mF2 = MFu(i3)
mF22 = MFu2(i3)
mS2 = MSd(i2)
mS22 = MSd2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,conj[Hpm],Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 1
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i2)
coup2R = cplcChaChiHpmR(gt2,i1,i2)
coup3L = cplChiChacHpmL(i3,gt3,i2)
coup3R = cplChiChacHpmR(i3,gt3,i2)
coup4L = cplcChaChiVWmL(gt4,i3)
coup4R = cplcChaChiVWmR(gt4,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross+2.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSRRcross=BO4lSRRcross+2.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*(int1 -       & 
&  2.*int2)
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*(int1 -       & 
&  2.*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Chi,conj[VWm],Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 1
Do i1=1,10
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3L = cplChiChacVWmL(i3,gt3)
coup3R = cplChiChacVWmR(i3,gt3)
coup4L = cplcChaChiVWmL(gt4,i3)
coup4R = cplcChaChiVWmR(gt4,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int3
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int3
  BO4lVRRcross=BO4lVRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVLLcross=BO4lVLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lVRLcross=BO4lVRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Cha],Ah
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MAh2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i4)
coup1R = cplcChaChaAhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaAhL(i3,gt3,i4)
coup4R = cplcChaChaAhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i4)
mS12 = MAh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Hpm,Chi,conj[Hpm],Chi
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 2
Do i1=1,8
  Do i2=1,10
    Do i3=1,8
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplcChaChiHpmL(gt4,i2,i3)
coup3R = cplcChaChiHpmR(gt4,i2,i3)
coup4L = cplChiChacHpmL(i4,gt3,i3)
coup4R = cplChiChacHpmR(i4,gt3,i3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mS12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 0.5*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLLcross=BO4lVLLcross - 0.5*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Hpm,Chi,conj[VWm],Chi
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 2
Do i1=1,8
  Do i2=1,10
      Do i4=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i4,gt1,i1)
coup1R = cplChiChacHpmR(i4,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i2,i1)
coup2R = cplcChaChiHpmR(gt2,i2,i1)
coup3L = cplcChaChiVWmL(gt4,i2)
coup3R = cplcChaChiVWmR(gt4,i2)
coup4L = cplChiChacVWmL(i4,gt3)
coup4R = cplChiChacVWmR(i4,gt3)
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i4)
mF12 = MChi2(i4)
mV2 = MVWm
mV22 = MVWm2
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mS12, mV22)
  int2=MMD0(mF1, mF2, mF12, mF22, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross - 8.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 8.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 2.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 2.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! VWm,Chi,conj[Hpm],Chi
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 2
  Do i2=1,10
    Do i3=1,8
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplcChaChiHpmL(gt4,i2,i3)
coup3R = cplcChaChiHpmR(gt4,i2,i3)
coup4L = cplChiChacHpmL(i4,gt3,i3)
coup4R = cplChiChacHpmR(i4,gt3,i3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mV12, mS22)
  int2=MMD0(mF1, mF2, mF12, mF22, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross - 8.*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 8.*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int1
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*int2
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*int2
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VWm,Chi,conj[VWm],Chi
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 2
  Do i2=1,10
      Do i4=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i4,gt1)
coup1R = cplChiChacVWmR(i4,gt1)
coup2L = cplcChaChiVWmL(gt2,i2)
coup2R = cplcChaChiVWmR(gt2,i2)
coup3L = cplcChaChiVWmL(gt4,i2)
coup3R = cplcChaChiVWmR(gt4,i2)
coup4L = cplChiChacVWmL(i4,gt3)
coup4R = cplChiChacVWmR(i4,gt3)
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i4)
mF12 = MChi2(i4)
mV2 = MVWm
mV22 = MVWm2
mF2 = MChi(i2)
mF22 = MChi2(i2)
  int1=D00check(mF12, mF22, mV12, mV22)
  int2=MMD0(mF1, mF2, mF12, mF22, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross+8.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+8.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRLcross=BO4lSRLcross+32.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLRcross=BO4lSLRcross+32.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRRcross=BO4lVRRcross - 2.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross - 2.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
   End Do 
End Do 


 ! Cha,Ah,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,hh,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Cha,VP,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,VZ,bar[Cha],hh
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
      Do i4=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(Mhh2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i4)
coup1R = cplcChaChahhR(i1,gt1,i4)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChahhL(i3,gt3,i4)
coup4R = cplcChaChahhR(i3,gt3,i4)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i4)
mS12 = Mhh2(i4)
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Cha,Ah,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Cha],VP
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i1,gt1)
coup1R = cplcChaChaVPR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVPL(i3,gt3)
coup4R = cplcChaChaVPR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,Ah,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i2)
coup2R = cplcChaChaAhR(gt2,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,i2)
coup3R = cplcChaChaAhR(gt4,i3,i2)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = MAh(i2)
mS22 = MAh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,hh,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 2
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i2)
coup2R = cplcChaChahhR(gt2,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,i2)
coup3R = cplcChaChahhR(gt4,i3,i2)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mS2 = Mhh(i2)
mS22 = Mhh2(i2)
  int1=D00check(mF12, mF22, mS22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Cha,VP,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVPL(gt2,i1)
coup2R = cplcChaChaVPR(gt2,i1)
coup3L = cplcChaChaVPL(gt4,i3)
coup3R = cplcChaChaVPR(gt4,i3)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = 0.
mV22 = 0._dp
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Cha,VZ,bar[Cha],VZ
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 2
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(i3,gt3)
coup4R = cplcChaChaVZR(i3,gt3)
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mF2 = MCha(i3)
mF22 = MCha2(i3)
mV2 = MVZ
mV22 = MVZ2
  int1=D00check(mF12, mF22, mV22, mV12)
  int2=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSLRcross=BO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+4.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+4.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  End if 
End if 
    End Do 
  End Do 


 ! Ah,Cha,Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt4,i4,i3)
coup2R = cplcChaChaAhR(gt4,i4,i3)
coup3L = cplcChaChaAhL(i2,gt3,i1)
coup3R = cplcChaChaAhR(i2,gt3,i1)
coup4L = cplcChaChaAhL(gt2,i2,i3)
coup4R = cplcChaChaAhR(gt2,i2,i3)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Ah,Cha,hh,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt4,i4,i3)
coup2R = cplcChaChahhR(gt4,i4,i3)
coup3L = cplcChaChaAhL(i2,gt3,i1)
coup3R = cplcChaChaAhR(i2,gt3,i1)
coup4L = cplcChaChahhL(gt2,i2,i3)
coup4R = cplcChaChahhR(gt2,i2,i3)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Ah,Cha,VP,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaVPL(gt4,i4)
coup2R = cplcChaChaVPR(gt4,i4)
coup3L = cplcChaChaAhL(i2,gt3,i1)
coup3R = cplcChaChaAhR(i2,gt3,i1)
coup4L = cplcChaChaVPL(gt2,i2)
coup4R = cplcChaChaVPR(gt2,i2)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(3.*coup1R*coup2L*coup3R*coup4L +     & 
&  13.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(13.*coup1R*coup2L*coup3R*coup4L +    & 
&  3.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2L*coup3R*coup4L -         & 
&  1.*coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1R*coup2R*coup3L*coup4L*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2L*coup3R*coup4L +     & 
&  coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1L*coup2L*coup3R*coup4R*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(5.*coup1R*coup2L*coup3R*coup4L -     & 
&  21.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(-21.*coup1R*coup2L*coup3R*coup4L +   & 
&  5.*coup1L*coup2R*coup3L*coup4R)*int1
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Ah,Cha,VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i4,gt1,i1)
coup1R = cplcChaChaAhR(i4,gt1,i1)
coup2L = cplcChaChaVZL(gt4,i4)
coup2R = cplcChaChaVZR(gt4,i4)
coup3L = cplcChaChaAhL(i2,gt3,i1)
coup3R = cplcChaChaAhR(i2,gt3,i1)
coup4L = cplcChaChaVZL(gt2,i2)
coup4R = cplcChaChaVZR(gt2,i2)
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(3.*coup1R*coup2L*coup3R*coup4L +     & 
&  13.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(13.*coup1R*coup2L*coup3R*coup4L +    & 
&  3.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2L*coup3R*coup4L -         & 
&  1.*coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1R*coup2R*coup3L*coup4L*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2L*coup3R*coup4L +     & 
&  coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1L*coup2L*coup3R*coup4R*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(5.*coup1R*coup2L*coup3R*coup4L -     & 
&  21.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(-21.*coup1R*coup2L*coup3R*coup4L +   & 
&  5.*coup1L*coup2R*coup3L*coup4R)*int1
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! hh,Cha,Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChaAhL(gt4,i4,i3)
coup2R = cplcChaChaAhR(gt4,i4,i3)
coup3L = cplcChaChahhL(i2,gt3,i1)
coup3R = cplcChaChahhR(i2,gt3,i1)
coup4L = cplcChaChaAhL(gt2,i2,i3)
coup4R = cplcChaChaAhR(gt2,i2,i3)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! hh,Cha,hh,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFS,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChahhL(gt4,i4,i3)
coup2R = cplcChaChahhR(gt4,i4,i3)
coup3L = cplcChaChahhL(i2,gt3,i1)
coup3R = cplcChaChahhR(i2,gt3,i1)
coup4L = cplcChaChahhL(gt2,i2,i3)
coup4R = cplcChaChahhR(gt2,i2,i3)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mS22)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int1
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int1
  BO4lVRLcross=BO4lVRLcross+0.5*chargefactor*coup1R*coup2R*coup3L*coup4L*int2
  BO4lVLRcross=BO4lVLRcross+0.5*chargefactor*coup1L*coup2L*coup3R*coup4R*int2
  BO4lTLLcross=BO4lTLLcross - 0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! hh,Cha,VP,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChaVPL(gt4,i4)
coup2R = cplcChaChaVPR(gt4,i4)
coup3L = cplcChaChahhL(i2,gt3,i1)
coup3R = cplcChaChahhR(i2,gt3,i1)
coup4L = cplcChaChaVPL(gt2,i2)
coup4R = cplcChaChaVPR(gt2,i2)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(3.*coup1R*coup2L*coup3R*coup4L +     & 
&  13.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(13.*coup1R*coup2L*coup3R*coup4L +    & 
&  3.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2L*coup3R*coup4L -         & 
&  1.*coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1R*coup2R*coup3L*coup4L*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2L*coup3R*coup4L +     & 
&  coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1L*coup2L*coup3R*coup4R*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(5.*coup1R*coup2L*coup3R*coup4L -     & 
&  21.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(-21.*coup1R*coup2L*coup3R*coup4L +   & 
&  5.*coup1L*coup2R*coup3L*coup4R)*int1
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! hh,Cha,VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: SFFV,  InsertionOrder: 3
Do i1=1,8
  Do i2=1,5
      Do i4=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i4,gt1,i1)
coup1R = cplcChaChahhR(i4,gt1,i1)
coup2L = cplcChaChaVZL(gt4,i4)
coup2R = cplcChaChaVZR(gt4,i4)
coup3L = cplcChaChahhL(i2,gt3,i1)
coup3R = cplcChaChahhR(i2,gt3,i1)
coup4L = cplcChaChaVZL(gt2,i2)
coup4R = cplcChaChaVZR(gt2,i2)
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mS12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mS12, mV22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(3.*coup1R*coup2L*coup3R*coup4L +     & 
&  13.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(13.*coup1R*coup2L*coup3R*coup4L +    & 
&  3.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(coup1R*coup2L*coup3R*coup4L -         & 
&  1.*coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1R*coup2R*coup3L*coup4L*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(-1.*coup1R*coup2L*coup3R*coup4L +     & 
&  coup1L*coup2R*coup3L*coup4R)*int1 - 2.*coup1L*coup2L*coup3R*coup4R*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(5.*coup1R*coup2L*coup3R*coup4L -     & 
&  21.*coup1L*coup2R*coup3L*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(-21.*coup1R*coup2L*coup3R*coup4L +   & 
&  5.*coup1L*coup2R*coup3L*coup4R)*int1
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! VP,Cha,Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 3
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaAhL(gt4,i4,i3)
coup2R = cplcChaChaAhR(gt4,i4,i3)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChaAhL(gt2,i2,i3)
coup4R = cplcChaChaAhR(gt2,i2,i3)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(13.*coup1L*coup2L*coup3L*coup4L +    & 
&  3.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(3.*coup1L*coup2L*coup3L*coup4L +     & 
&  13.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2L*coup3L*coup4L +     & 
&  coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1R*coup2L*coup3L*coup4R*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2L*coup3L*coup4L -         & 
&  1.*coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1L*coup2R*coup3R*coup4L*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(-21.*coup1L*coup2L*coup3L*coup4L +   & 
&  5.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(5.*coup1L*coup2L*coup3L*coup4L -     & 
&  21.*coup1R*coup2R*coup3R*coup4R)*int1
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VP,Cha,hh,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 3
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChahhL(gt4,i4,i3)
coup2R = cplcChaChahhR(gt4,i4,i3)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChahhL(gt2,i2,i3)
coup4R = cplcChaChahhR(gt2,i2,i3)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(13.*coup1L*coup2L*coup3L*coup4L +    & 
&  3.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(3.*coup1L*coup2L*coup3L*coup4L +     & 
&  13.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2L*coup3L*coup4L +     & 
&  coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1R*coup2L*coup3L*coup4R*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2L*coup3L*coup4L -         & 
&  1.*coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1L*coup2R*coup3R*coup4L*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(-21.*coup1L*coup2L*coup3L*coup4L +   & 
&  5.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(5.*coup1L*coup2L*coup3L*coup4L -     & 
&  21.*coup1R*coup2R*coup3R*coup4R)*int1
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VP,Cha,VP,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 3
  Do i2=1,5
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVPL(gt4,i4)
coup2R = cplcChaChaVPR(gt4,i4)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChaVPL(gt2,i2)
coup4R = cplcChaChaVPR(gt2,i2)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSRLcross=BO4lSRLcross - 8.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 8.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  End if 
End if 
   End Do 
End Do 


 ! VP,Cha,VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 3
  Do i2=1,5
      Do i4=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i4,gt1)
coup1R = cplcChaChaVPR(i4,gt1)
coup2L = cplcChaChaVZL(gt4,i4)
coup2R = cplcChaChaVZR(gt4,i4)
coup3L = cplcChaChaVPL(i2,gt3)
coup3R = cplcChaChaVPR(i2,gt3)
coup4L = cplcChaChaVZL(gt2,i2)
coup4R = cplcChaChaVZR(gt2,i2)
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSRLcross=BO4lSRLcross - 8.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 8.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  End if 
End if 
   End Do 
End Do 


 ! VZ,Cha,Ah,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 3
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaAhL(gt4,i4,i3)
coup2R = cplcChaChaAhR(gt4,i4,i3)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChaAhL(gt2,i2,i3)
coup4R = cplcChaChaAhR(gt2,i2,i3)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = MAh(i3)
mS22 = MAh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(13.*coup1L*coup2L*coup3L*coup4L +    & 
&  3.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(3.*coup1L*coup2L*coup3L*coup4L +     & 
&  13.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2L*coup3L*coup4L +     & 
&  coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1R*coup2L*coup3L*coup4R*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2L*coup3L*coup4L -         & 
&  1.*coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1L*coup2R*coup3R*coup4L*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(-21.*coup1L*coup2L*coup3L*coup4L +   & 
&  5.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(5.*coup1L*coup2L*coup3L*coup4L -     & 
&  21.*coup1R*coup2R*coup3R*coup4R)*int1
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VZ,Cha,hh,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFS,  InsertionOrder: 3
  Do i2=1,5
    Do i3=1,8
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChahhL(gt4,i4,i3)
coup2R = cplcChaChahhR(gt4,i4,i3)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChahhL(gt2,i2,i3)
coup4R = cplcChaChahhR(gt2,i2,i3)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mS22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mS22)
  BO4lSLLcross=BO4lSLLcross - 0.25*chargefactor*(13.*coup1L*coup2L*coup3L*coup4L +    & 
&  3.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRRcross=BO4lSRRcross - 0.25*chargefactor*(3.*coup1L*coup2L*coup3L*coup4L +     & 
&  13.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lSRLcross=BO4lSRLcross+chargefactor*(0.75*(-1.*coup1L*coup2L*coup3L*coup4L +     & 
&  coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1R*coup2L*coup3L*coup4R*int2)
  BO4lSLRcross=BO4lSLRcross+chargefactor*(0.75*(coup1L*coup2L*coup3L*coup4L -         & 
&  1.*coup1R*coup2R*coup3R*coup4R)*int1 - 2.*coup1L*coup2R*coup3R*coup4L*int2)
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.0625*chargefactor*(-21.*coup1L*coup2L*coup3L*coup4L +   & 
&  5.*coup1R*coup2R*coup3R*coup4R)*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.0625*chargefactor*(5.*coup1L*coup2L*coup3L*coup4L -     & 
&  21.*coup1R*coup2R*coup3R*coup4R)*int1
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! VZ,Cha,VP,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 3
  Do i2=1,5
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVPL(gt4,i4)
coup2R = cplcChaChaVPR(gt4,i4)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChaVPL(gt2,i2)
coup4R = cplcChaChaVPR(gt2,i2)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = 0.
mV22 = 0._dp
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSRLcross=BO4lSRLcross - 8.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 8.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  End if 
End if 
   End Do 
End Do 


 ! VZ,Cha,VZ,bar[Cha]
chargefactor = 1 
! Generic diagram: VFFV,  InsertionOrder: 3
  Do i2=1,5
      Do i4=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MCha2(i4).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i4.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i4,gt1)
coup1R = cplcChaChaVZR(i4,gt1)
coup2L = cplcChaChaVZL(gt4,i4)
coup2R = cplcChaChaVZR(gt4,i4)
coup3L = cplcChaChaVZL(i2,gt3)
coup3R = cplcChaChaVZR(i2,gt3)
coup4L = cplcChaChaVZL(gt2,i2)
coup4R = cplcChaChaVZR(gt2,i2)
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i4)
mF12 = MCha2(i4)
mV2 = MVZ
mV22 = MVZ2
mF2 = MCha(i2)
mF22 = MCha2(i2)
  int1=D00check(mF22, mF12, mV12, mV22)
  int2=MMD0(mF1, mF2, mF22, mF12, mV12, mV22)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lSRLcross=BO4lSRLcross - 8.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lSLRcross=BO4lSLRcross - 8.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lVRRcross=BO4lVRRcross+16.*chargefactor*coup1R*coup2R*coup3R*coup4R*int1
  BO4lVLLcross=BO4lVLLcross+16.*chargefactor*coup1L*coup2L*coup3L*coup4L*int1
  BO4lVRLcross=BO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int2
  BO4lVLRcross=BO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int2
  BO4lTLLcross=BO4lTLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  End if 
End if 
   End Do 
End Do 


 ! Chi,Hpm,Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSSF,  InsertionOrder: 3
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt4,i3,i4)
coup2R = cplcChaChiHpmR(gt4,i3,i4)
coup3L = cplChiChacHpmL(i1,gt3,i2)
coup3R = cplChiChacHpmR(i1,gt3,i2)
coup4L = cplcChaChiHpmL(gt2,i3,i2)
coup4R = cplcChaChiHpmR(gt2,i3,i2)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=D00check(mF12, mF22, mS22, mS12)
  int2=MMD0(mF1, mF2, mF12, mF22, mS22, mS12)
  BO4lSLLcross=BO4lSLLcross+0.5*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lSRRcross=BO4lSRRcross+0.5*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  BO4lSRLcross=BO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lSLRcross=BO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lVRRcross=BO4lVRRcross - 0.5*chargefactor*coup1R*coup2L*coup3R*coup4L*int2
  BO4lVLLcross=BO4lVLLcross - 0.5*chargefactor*coup1L*coup2R*coup3L*coup4R*int2
  BO4lVRLcross=BO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup3L*coup4L*int1
  BO4lVLRcross=BO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup3R*coup4R*int1
  BO4lTLLcross=BO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3L*coup4L*int2
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3R*coup4R*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Chi,VWm,Chi,conj[Hpm]
chargefactor = 1 
! Generic diagram: FSVF,  InsertionOrder: 3
Do i1=1,10
    Do i3=1,10
      Do i4=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MHpm2(i4).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i4.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i4)
coup1R = cplChiChacHpmR(i1,gt1,i4)
coup2L = cplcChaChiHpmL(gt4,i3,i4)
coup2R = cplcChaChiHpmR(gt4,i3,i4)
coup3L = cplChiChacVWmL(i1,gt3)
coup3R = cplChiChacVWmR(i1,gt3)
coup4L = cplcChaChiVWmL(gt2,i3)
coup4R = cplcChaChiVWmR(gt2,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i4)
mS12 = MHpm2(i4)
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mS12, mF12)
  int2=D00check(mF12, mF22, mV22, mS12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mS12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -     & 
&  8.*int2)
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -     & 
&  8.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -          & 
&  2.*int2)
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -          & 
&  2.*int2)
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lTLLcross=BO4lTLLcross - 0.25*chargefactor*coup1L*coup2L*coup3L*coup4R*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.25*chargefactor*coup1R*coup2R*coup3R*coup4L*int1
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Chi,Hpm,Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVSF,  InsertionOrder: 3
Do i1=1,10
  Do i2=1,8
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChacHpmL(i1,gt3,i2)
coup3R = cplChiChacHpmR(i1,gt3,i2)
coup4L = cplcChaChiHpmL(gt2,i3,i2)
coup4R = cplcChaChiHpmR(gt2,i3,i2)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mS2 = MHpm(i2)
mS22 = MHpm2(i2)
  int1=C0D0check(mF22, mS22, mV12, mF12)
  int2=D00check(mF12, mF22, mS22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mS22, mV12)
  BO4lSLLcross=BO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3L*coup4L*(int1 -     & 
&  8.*int2)
  BO4lSRRcross=BO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3R*coup4R*(int1 -     & 
&  8.*int2)
  BO4lSRLcross=BO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3L*coup4R*int3
  BO4lSLRcross=BO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3R*coup4L*int3
  BO4lVRRcross=BO4lVRRcross+chargefactor*coup1R*coup2R*coup3R*coup4L*(int1 -          & 
&  2.*int2)
  BO4lVLLcross=BO4lVLLcross+chargefactor*coup1L*coup2L*coup3L*coup4R*(int1 -          & 
&  2.*int2)
  BO4lVRLcross=BO4lVRLcross+chargefactor*coup1R*coup2L*coup3L*coup4L*int3
  BO4lVLRcross=BO4lVLRcross+chargefactor*coup1L*coup2R*coup3R*coup4R*int3
  BO4lTLLcross=BO4lTLLcross - 0.25*chargefactor*coup1L*coup2R*coup3L*coup4L*int1
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross - 0.25*chargefactor*coup1R*coup2L*coup3R*coup4R*int1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Chi,VWm,Chi,conj[VWm]
chargefactor = 1 
! Generic diagram: FVVF,  InsertionOrder: 3
Do i1=1,10
    Do i3=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChacVWmL(i1,gt3)
coup3R = cplChiChacVWmR(i1,gt3)
coup4L = cplcChaChiVWmL(gt2,i3)
coup4R = cplcChaChiVWmR(gt2,i3)
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mF2 = MChi(i3)
mF22 = MChi2(i3)
mV2 = MVWm
mV22 = MVWm2
  int1=C0D0check(mF22, mV22, mV12, mF12)
  int2=D00check(mF12, mF22, mV22, mV12)
  int3=MMD0(mF1, mF2, mF12, mF22, mV22, mV12)
  BO4lSLLcross=BO4lSLLcross - 4.*chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lSRRcross=BO4lSRRcross - 4.*chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  BO4lSRLcross=BO4lSRLcross - 8.*chargefactor*coup1R*coup2R*coup3L*coup4L*(int1 -     & 
&  3.*int2)
  BO4lSLRcross=BO4lSLRcross - 8.*chargefactor*coup1L*coup2L*coup3R*coup4R*(int1 -     & 
&  3.*int2)
  BO4lVRRcross=BO4lVRRcross - 2.*chargefactor*coup1R*coup2R*coup3R*coup4R*int3
  BO4lVLLcross=BO4lVLLcross - 2.*chargefactor*coup1L*coup2L*coup3L*coup4L*int3
  BO4lVRLcross=BO4lVRLcross - 4.*chargefactor*coup1R*coup2L*coup3L*coup4R*int1
  BO4lVLRcross=BO4lVLRcross - 4.*chargefactor*coup1L*coup2R*coup3R*coup4L*int1
  BO4lTLLcross=BO4lTLLcross+chargefactor*coup1L*coup2R*coup3L*coup4R*int3
  BO4lTLRcross=BO4lTLRcross+0.
  BO4lTRLcross=BO4lTRLcross+0.
  BO4lTRRcross=BO4lTRRcross+chargefactor*coup1R*coup2L*coup3R*coup4L*int3
  End if 
End if 
    End Do 
  End Do 


 BO4lSLLcross=oo16pi2*BO4lSLLcross 
BO4lSRRcross=oo16pi2*BO4lSRRcross 
BO4lSRLcross=oo16pi2*BO4lSRLcross 
BO4lSLRcross=oo16pi2*BO4lSLRcross 
BO4lVRRcross=oo16pi2*BO4lVRRcross 
BO4lVLLcross=oo16pi2*BO4lVLLcross 
BO4lVRLcross=oo16pi2*BO4lVRLcross 
BO4lVLRcross=oo16pi2*BO4lVLRcross 
BO4lTLLcross=oo16pi2*BO4lTLLcross 
BO4lTLRcross=oo16pi2*BO4lTLRcross 
BO4lTRLcross=oo16pi2*BO4lTRLcross 
BO4lTRRcross=oo16pi2*BO4lTRRcross 
Iname=Iname-1

End Subroutine CalculateBox4Lcross 

Subroutine CalculatePengS4Lcross(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,          & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,PSO4lSLLcross,PSO4lSRRcross,               & 
& PSO4lSRLcross,PSO4lSLRcross,PSO4lVRRcross,PSO4lVLLcross,PSO4lVRLcross,PSO4lVLRcross,   & 
& PSO4lTLLcross,PSO4lTLRcross,PSO4lTRLcross,PSO4lTRRcross)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengS4Lcross 
! 'PreSARAH' output has been generated  at 10:53 on 13.6.2014 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PSO4lSLLcross 
Complex(dp), Intent(out) :: PSO4lSRRcross 
Complex(dp), Intent(out) :: PSO4lSRLcross 
Complex(dp), Intent(out) :: PSO4lSLRcross 
Complex(dp), Intent(out) :: PSO4lVRRcross 
Complex(dp), Intent(out) :: PSO4lVLLcross 
Complex(dp), Intent(out) :: PSO4lVRLcross 
Complex(dp), Intent(out) :: PSO4lVLRcross 
Complex(dp), Intent(out) :: PSO4lTLLcross 
Complex(dp), Intent(out) :: PSO4lTLRcross 
Complex(dp), Intent(out) :: PSO4lTRLcross 
Complex(dp), Intent(out) :: PSO4lTRRcross 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengS4Lcross' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
PSO4lSLLcross=0._dp 
PSO4lSRRcross=0._dp 
PSO4lSRLcross=0._dp 
PSO4lSLRcross=0._dp 
PSO4lVRRcross=0._dp 
PSO4lVLLcross=0._dp 
PSO4lVRLcross=0._dp 
PSO4lVLRcross=0._dp 
PSO4lTLLcross=0._dp 
PSO4lTLRcross=0._dp 
PSO4lTRLcross=0._dp 
PSO4lTRRcross=0._dp 
!---------------------------------------- 
! Scalar Wave Contributions            
!---------------------------------------- 
! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,iProp)
coup3R = cplcChaChahhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt4,i3,iProp)
coup3R = cplcChaChahhR(gt4,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,bar[Cha], Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcChaChaAhL(i2,i3,i1)
coup2R = cplcChaChaAhR(i2,i3,i1)
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = Conjg(-cplcChaChaVZR(i1,i3))
coup2R = Conjg(-cplcChaChaVZL(i1,i3))
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,conj[Hpm], Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplChiChacHpmL(i1,i3,i2)
coup2R = cplChiChacHpmR(i1,i3,i2)
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,conj[VWm], Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,i3))
coup2R = Conjg(-cplChiChacVWmL(i1,i3))
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 11
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup3L = cplcChaChahhL(i3,gt3,iProp)
coup3R = cplcChaChahhR(i3,gt3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup2L = cplcChaChaAhL(i3,i1,i2)
coup2R = cplcChaChaAhR(i3,i1,i2)
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup2L = Conjg(-cplcChaChaVZR(i3,i2))
coup2R = Conjg(-cplcChaChaVZL(i3,i2))
coup1L = Conjg(-cplcChaChaVZR(i2,gt3))
coup1R = Conjg(-cplcChaChaVZL(i2,gt3))
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup2L = cplcChaChiHpmL(i3,i2,i1)
coup2R = cplcChaChiHpmR(i3,i2,i1)
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup2L = Conjg(-cplcChaChiVWmR(i3,i2))
coup2R = Conjg(-cplcChaChiVWmL(i3,i2))
coup1L = Conjg(-cplChiChacVWmR(i2,gt3))
coup1R = Conjg(-cplChiChacVWmL(i2,gt3))
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 12
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(gt2,i3,iProp)
coup3R = cplcChaChahhR(gt2,i3,iProp)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx12 + coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx12 + coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 5
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx42 + coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx42 + coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt1,iProp)
coup3R = cplcChaChaAhR(i3,gt1,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaAhL(gt4,i3,iProp)
coup3R = cplcChaChaAhR(gt4,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(chargefactor*coup3L*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(chargefactor*coup3R*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(-1.*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(-1.*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+(-1.*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lSLRcross=PSO4lSLRcross+(-1.*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,bar[Cha], Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcChaChaAhL(i2,i3,i1)
coup2R = cplcChaChaAhR(i2,i3,i1)
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = Conjg(-cplcChaChaVZR(i1,i3))
coup2R = Conjg(-cplcChaChaVZL(i1,i3))
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,conj[Hpm], Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplChiChacHpmL(i1,i3,i2)
coup2R = cplChiChacHpmR(i1,i3,i2)
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,conj[VWm], Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 11
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,i3))
coup2R = Conjg(-cplChiChacVWmL(i1,i3))
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1L*MassEx2*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1R*MassEx2*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 11
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup3L = cplcChaChaAhL(i3,gt3,iProp)
coup3R = cplcChaChaAhR(i3,gt3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx22 + coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx22 + coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup2L = cplcChaChaAhL(i3,i1,i2)
coup2R = cplcChaChaAhR(i3,i1,i2)
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup2L = Conjg(-cplcChaChaVZR(i3,i2))
coup2R = Conjg(-cplcChaChaVZL(i3,i2))
coup1L = Conjg(-cplcChaChaVZR(i2,gt3))
coup1R = Conjg(-cplcChaChaVZL(i2,gt3))
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup2L = cplcChaChiHpmL(i3,i2,i1)
coup2R = cplcChaChiHpmR(i3,i2,i1)
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 12
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup2L = Conjg(-cplcChaChiVWmR(i3,i2))
coup2R = Conjg(-cplcChaChiVWmL(i3,i2))
coup1L = Conjg(-cplChiChacVWmR(i2,gt3))
coup1R = Conjg(-cplChiChacVWmL(i2,gt3))
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(-0.125*chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-& 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(-0.125*chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-& 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 12
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaAhL(gt2,i3,iProp)
coup3R = cplcChaChaAhR(gt2,i3,iProp)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+(0.5*chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRRcross=PSO4lSRRcross+(0.5*chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+(0.5*chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lVLRcross=PSO4lVLRcross+(0.5*chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PSO4lTLLcross=PSO4lTLLcross+(0.125*chargefactor*coup3L*coup4L*IMP2*(-               & 
& 1.*coup1L*coup2R*int2*MassEx32 + coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin +& 
&  coup1L*coup2L*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+(0.125*chargefactor*coup3R*coup4R*IMP2*(-               & 
& 1.*coup1R*coup2L*int2*MassEx32 + coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin +& 
&  coup1R*coup2R*int1*mF1*MFin))/(MassEx32 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 !---------------------------------------- 
! Scalar Penguin Contributions            
!---------------------------------------- 
! -- hh - Penguins            
! Propagator: hh, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplhhSucSu(iProp,i3,i2)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,iProp)
coup3R = cplcFuFuhhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt3,iProp)
coup4R = cplcChaChahhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSO4lSLLcross=PSO4lSLLcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mV12)
  PSO4lSLLcross=PSO4lSLLcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplhhSucSu(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,iProp)
coup3R = cplcFuFuhhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt3,iProp)
coup4R = cplcChaChahhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplhhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplhhcHpmVWm(iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplhhHpmcVWm(iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSO4lSLLcross=PSO4lSLLcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = cplhhSdcSd(iProp,i2,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,iProp)
coup3R = cplcFdFdhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChahhL(i3,i2,iProp)
coup3R = cplcChaChahhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSO4lSLLcross=PSO4lSLLcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt3,i2)
coup1R = cplcFdChaSuR(i1,gt3,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplhhSucSu(iProp,i3,i2)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i2,i1)
coup1R = cplChaFucSdR(gt3,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,iProp)
coup3R = cplcFuFuhhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChiChacVWmL(i2,gt3)
coup1R = cplChiChacVWmR(i2,gt3)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt2,gt1,iProp)
coup4R = cplcChaChahhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Ah,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcChaChaAhL(i3,gt3,i1)
coup2R = cplcChaChaAhR(i3,gt3,i1)
coup3L = cplcChaChahhL(i2,i3,iProp)
coup3R = cplcChaChahhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup2L = cplcChaChaAhL(i1,gt3,i3)
coup2R = cplcChaChaAhR(i1,gt3,i3)
coup3 = cplAhAhhh(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh,Ah
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChaAhL(i1,gt3,i3)
coup2R = cplcChaChaAhR(i1,gt3,i3)
coup3 = cplAhhhhh(i3,iProp,i2)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = cplcChaChaAhL(i1,gt3,i3)
coup2R = cplcChaChaAhR(i1,gt3,i3)
coup3 = -cplAhhhVZ(i3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah,hh
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,gt3,i3)
coup2R = cplcChaChahhR(i1,gt3,i3)
coup3 = cplAhhhhh(i2,iProp,i3)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,hh,hh
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,gt3,i3)
coup2R = cplcChaChahhR(i1,gt3,i3)
coup3 = cplhhhhhh(iProp,i3,i2)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup2L = Conjg(-cplcChaChaVZR(i1,gt3))
coup2R = Conjg(-cplcChaChaVZL(i1,gt3))
coup3 = -cplAhhhVZ(i2,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Cha,VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = Conjg(-cplcChaChaVZR(i1,gt3))
coup2R = Conjg(-cplcChaChaVZL(i1,gt3))
coup3 = cplhhVZVZ(iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,conj[Hpm],conj[Hpm]
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplChiChacHpmL(i1,gt3,i3)
coup2R = cplChiChacHpmR(i1,gt3,i3)
coup3 = cplhhHpmcHpm(iProp,i3,i2)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,conj[VWm],conj[Hpm]
! Generic diagram: FVS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = cplChiChacHpmL(i1,gt3,i3)
coup2R = cplChiChacHpmR(i1,gt3,i3)
coup3 = -cplhhHpmcVWm(iProp,i3)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,conj[Hpm],conj[VWm]
! Generic diagram: FSV,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = Conjg(-cplChiChacVWmR(i1,gt3))
coup2R = Conjg(-cplChiChacVWmL(i1,gt3))
coup3 = -cplhhcHpmVWm(iProp,i2)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: hh, Loop particles: Chi,conj[VWm],conj[VWm]
! Generic diagram: FVV,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,gt3))
coup2R = Conjg(-cplChiChacVWmL(i1,gt3))
coup3 = cplhhcVWmVWm(iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
End Do 


 ! Propagator: hh, Loop particles: Fd,Su,Su
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup2L = cplcFdChaSuL(i1,gt3,i3)
coup2R = cplcFdChaSuR(i1,gt3,i3)
coup3 = cplhhSucSu(iProp,i2,i3)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: hh,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i2,i1)
coup1R = cplcChaChahhR(gt2,i2,i1)
coup2L = cplcChaChahhL(i3,gt3,i1)
coup2R = cplcChaChahhR(i3,gt3,i1)
coup3L = cplcChaChahhL(i2,i3,iProp)
coup3R = cplcChaChahhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Hpm,Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup2L = cplChiChacHpmL(i3,gt3,i1)
coup2R = cplChiChacHpmR(i3,gt3,i1)
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: Sd,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup2L = cplChaFucSdL(gt3,i3,i1)
coup2R = cplChaFucSdR(gt3,i3,i1)
coup3L = cplcFuFuhhL(i3,i2,iProp)
coup3R = cplcFuFuhhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VWm,Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i2))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i2))
coup2L = Conjg(-cplChiChacVWmR(i3,gt3))
coup2R = Conjg(-cplChiChacVWmL(i3,gt3))
coup3L = cplChiChihhL(i3,i2,iProp)
coup3R = cplChiChihhR(i3,i2,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: VZ,bar[Cha],bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i2))
coup1R = Conjg(-cplcChaChaVZL(gt2,i2))
coup2L = Conjg(-cplcChaChaVZR(i3,gt3))
coup2R = Conjg(-cplcChaChaVZL(i3,gt3))
coup3L = cplcChaChahhL(i2,i3,iProp)
coup3R = cplcChaChahhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: bar[Fu],conj[Sd],conj[Sd]
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplChaFucSdL(gt3,i1,i3)
coup2R = cplChaFucSdR(gt3,i1,i3)
coup3 = cplhhSdcSd(iProp,i3,i2)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: hh, Loop particles: conj[Su],bar[Fd],bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i2,i1)
coup1R = cplcChaFdcSuR(gt2,i2,i1)
coup2L = cplcFdChaSuL(i3,gt3,i1)
coup2R = cplcFdChaSuR(i3,gt3,i1)
coup3L = cplcFdFdhhL(i2,i3,iProp)
coup3R = cplcFdFdhhR(i2,i3,iProp)
coup4L = cplcChaChahhL(gt4,gt1,iProp)
coup4R = cplcChaChahhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! -- Ah - Penguins            
! Propagator: Ah, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplAhSucSu(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuAhL(i2,i3,iProp)
coup3R = cplcFuFuAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt3,iProp)
coup4R = cplcChaChaAhR(gt4,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mS22, mV12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mV22, mS12)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplAhSucSu(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = cplcFuFuAhL(i2,i3,iProp)
coup3R = cplcFuFuAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt3,iProp)
coup4R = cplcChaChaAhR(gt2,gt3,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplAhHpmcHpm(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplAhcHpmVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplAhHpmcVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = cplAhSdcSd(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdAhL(i3,i2,iProp)
coup3R = cplcFdFdAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChaAhL(i3,i2,iProp)
coup3R = cplcChaChaAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +    & 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross - 1.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSLRcross=PSO4lSLRcross - 1.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt3,i2)
coup1R = cplcFdChaSuR(i1,gt3,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplAhSucSu(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i2,i1)
coup1R = cplChaFucSdR(gt3,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = cplcFuFuAhL(i2,i3,iProp)
coup3R = cplcFuFuAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mS12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSLRcross=PSO4lSLRcross+chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt3)
coup1R = cplChiChacVWmR(i2,gt3)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt2,gt1,iProp)
coup4R = cplcChaChaAhR(gt2,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF22, mF12, mV12)
  PSO4lSLLcross=PSO4lSLLcross+2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-            & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lSLRcross=PSO4lSLRcross+2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-            & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.
  PSO4lVLRcross=PSO4lVLRcross+0.
  PSO4lTLLcross=PSO4lTLLcross+0.
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Ah,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcChaChaAhL(i3,gt3,i1)
coup2R = cplcChaChaAhR(i3,gt3,i1)
coup3L = cplcChaChaAhL(i2,i3,iProp)
coup3R = cplcChaChaAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup2L = cplcChaChaAhL(i1,gt3,i3)
coup2R = cplcChaChaAhR(i1,gt3,i3)
coup3 = cplAhAhAh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh,Ah
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChaAhL(i1,gt3,i3)
coup2R = cplcChaChaAhR(i1,gt3,i3)
coup3 = cplAhAhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,Ah,hh
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,gt3,i3)
coup2R = cplcChaChahhR(i1,gt3,i3)
coup3 = cplAhAhhh(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh,hh
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,gt3,i3)
coup2R = cplcChaChahhR(i1,gt3,i3)
coup3 = cplAhhhhh(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,VZ,hh
! Generic diagram: FVS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = cplcChaChahhL(i1,gt3,i3)
coup2R = cplcChaChahhR(i1,gt3,i3)
coup3 = cplAhhhVZ(iProp,i3)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Cha,hh,VZ
! Generic diagram: FSV,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = Conjg(-cplcChaChaVZR(i1,gt3))
coup2R = Conjg(-cplcChaChaVZL(i1,gt3))
coup3 = cplAhhhVZ(iProp,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,conj[Hpm],conj[Hpm]
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplChiChacHpmL(i1,gt3,i3)
coup2R = cplChiChacHpmR(i1,gt3,i3)
coup3 = cplAhHpmcHpm(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,conj[VWm],conj[Hpm]
! Generic diagram: FVS,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = cplChiChacHpmL(i1,gt3,i3)
coup2R = cplChiChacHpmR(i1,gt3,i3)
coup3 = -cplAhHpmcVWm(iProp,i3)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS22, mV12)
  int2=C0check(mF12, mV12, mS22)
  PSO4lSLLcross=PSO4lSLLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+0.5*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross+0.5*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross - 0.125*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross - 0.125*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Chi,conj[Hpm],conj[VWm]
! Generic diagram: FSV,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = Conjg(-cplChiChacVWmR(i1,gt3))
coup2R = Conjg(-cplChiChacVWmL(i1,gt3))
coup3 = -cplAhcHpmVWm(iProp,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mS12, mV22)
  int2=C0check(mF12, mS12, mV22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(int1 +& 
&  int2*mF12)
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(int1 +& 
&  int2*mF12)
  End if 
End if 
    End Do 
   End Do 
End Do 


 ! Propagator: Ah, Loop particles: Fd,Su,Su
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup2L = cplcFdChaSuL(i1,gt3,i3)
coup2R = cplcFdChaSuR(i1,gt3,i3)
coup3 = cplAhSucSu(iProp,i2,i3)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: hh,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i2,i1)
coup1R = cplcChaChahhR(gt2,i2,i1)
coup2L = cplcChaChahhL(i3,gt3,i1)
coup2R = cplcChaChahhR(i3,gt3,i1)
coup3L = cplcChaChaAhL(i2,i3,iProp)
coup3R = cplcChaChaAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Hpm,Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup2L = cplChiChacHpmL(i3,gt3,i1)
coup2R = cplChiChacHpmR(i3,gt3,i1)
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: Sd,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup2L = cplChaFucSdL(gt3,i3,i1)
coup2R = cplChaFucSdR(gt3,i3,i1)
coup3L = cplcFuFuAhL(i3,i2,iProp)
coup3R = cplcFuFuAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VWm,Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i2))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i2))
coup2L = Conjg(-cplChiChacVWmR(i3,gt3))
coup2R = Conjg(-cplChiChacVWmL(i3,gt3))
coup3L = cplChiChiAhL(i3,i2,iProp)
coup3R = cplChiChiAhR(i3,i2,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: VZ,bar[Cha],bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
Do iProp=1,8
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i2))
coup1R = Conjg(-cplcChaChaVZL(gt2,i2))
coup2L = Conjg(-cplcChaChaVZR(i3,gt3))
coup2R = Conjg(-cplcChaChaVZL(i3,gt3))
coup3L = cplcChaChaAhL(i2,i3,iProp)
coup3R = cplcChaChaAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mV12)
  PSO4lSLLcross=PSO4lSLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRRcross=PSO4lSRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(2.*coup3R*int2*mF1*mF2 +& 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lVLRcross=PSO4lVLRcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(2.*coup3L*int2*mF1*mF2 +& 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  PSO4lTLLcross=PSO4lTLLcross+0.25*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - 2.*(int1 + int2*mV12)))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.25*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: bar[Fu],conj[Sd],conj[Sd]
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplChaFucSdL(gt3,i1,i3)
coup2R = cplChaFucSdR(gt3,i1,i3)
coup3 = cplAhSdcSd(iProp,i3,i2)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mS22)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 ! Propagator: Ah, Loop particles: conj[Su],bar[Fd],bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do iProp=1,8
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i2,i1)
coup1R = cplcChaFdcSuR(gt2,i2,i1)
coup2L = cplcFdChaSuL(i3,gt3,i1)
coup2R = cplcFdChaSuR(i3,gt3,i1)
coup3L = cplcFdFdAhL(i2,i3,iProp)
coup3R = cplcFdFdAhR(i2,i3,iProp)
coup4L = cplcChaChaAhL(gt4,gt1,iProp)
coup4R = cplcChaChaAhR(gt4,gt1,iProp)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C0check(mF12, mF22, mS12)
  PSO4lSLLcross=PSO4lSLLcross - 0.5*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lSRRcross=PSO4lSRRcross - 0.5*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lSRLcross=PSO4lSRLcross+0.
  PSO4lSLRcross=PSO4lSLRcross+0.
  PSO4lVRRcross=PSO4lVRRcross+0.
  PSO4lVLLcross=PSO4lVLLcross+0.
  PSO4lVRLcross=PSO4lVRLcross - 0.5*chargefactor*coup1L*coup2L*coup4R*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lVLRcross=PSO4lVLRcross - 0.5*chargefactor*coup1R*coup2R*coup4L*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  PSO4lTLLcross=PSO4lTLLcross+0.125*chargefactor*coup1L*coup2L*coup4L*IMP2*(coup3L*int2*mF1*mF2 +& 
&  coup3R*(int1 + int2*mS12))
  PSO4lTLRcross=PSO4lTLRcross+0.
  PSO4lTRLcross=PSO4lTRLcross+0.
  PSO4lTRRcross=PSO4lTRRcross+0.125*chargefactor*coup1R*coup2R*coup4R*IMP2*(coup3R*int2*mF1*mF2 +& 
&  coup3L*(int1 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 
End Do 


 PSO4lSLLcross=oo16pi2*PSO4lSLLcross 
PSO4lSRRcross=oo16pi2*PSO4lSRRcross 
PSO4lSRLcross=oo16pi2*PSO4lSRLcross 
PSO4lSLRcross=oo16pi2*PSO4lSLRcross 
PSO4lVRRcross=oo16pi2*PSO4lVRRcross 
PSO4lVLLcross=oo16pi2*PSO4lVLLcross 
PSO4lVRLcross=oo16pi2*PSO4lVRLcross 
PSO4lVLRcross=oo16pi2*PSO4lVLRcross 
PSO4lTLLcross=oo16pi2*PSO4lTLLcross 
PSO4lTLRcross=oo16pi2*PSO4lTLRcross 
PSO4lTRLcross=oo16pi2*PSO4lTRLcross 
PSO4lTRRcross=oo16pi2*PSO4lTRRcross 
Iname=Iname-1

End Subroutine CalculatePengS4Lcross 

Subroutine CalculatePengV4Lcross(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,          & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,PVO4lSLLcross,PVO4lSRRcross,               & 
& PVO4lSRLcross,PVO4lSLRcross,PVO4lVRRcross,PVO4lVLLcross,PVO4lVRLcross,PVO4lVLRcross,   & 
& PVO4lTLLcross,PVO4lTLRcross,PVO4lTRLcross,PVO4lTRRcross)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process PengV4Lcross 
! 'PreSARAH' output has been generated  at 10:55 on 13.6.2014 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: PVO4lSLLcross 
Complex(dp), Intent(out) :: PVO4lSRRcross 
Complex(dp), Intent(out) :: PVO4lSRLcross 
Complex(dp), Intent(out) :: PVO4lSLRcross 
Complex(dp), Intent(out) :: PVO4lVRRcross 
Complex(dp), Intent(out) :: PVO4lVLLcross 
Complex(dp), Intent(out) :: PVO4lVRLcross 
Complex(dp), Intent(out) :: PVO4lVLRcross 
Complex(dp), Intent(out) :: PVO4lTLLcross 
Complex(dp), Intent(out) :: PVO4lTLRcross 
Complex(dp), Intent(out) :: PVO4lTRLcross 
Complex(dp), Intent(out) :: PVO4lTRRcross 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculatePengV4Lcross' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
PVO4lSLLcross=0._dp 
PVO4lSRRcross=0._dp 
PVO4lSRLcross=0._dp 
PVO4lSLRcross=0._dp 
PVO4lVRRcross=0._dp 
PVO4lVLLcross=0._dp 
PVO4lVRLcross=0._dp 
PVO4lVLRcross=0._dp 
PVO4lTLLcross=0._dp 
PVO4lTLRcross=0._dp 
PVO4lTRLcross=0._dp 
PVO4lTRRcross=0._dp 
!---------------------------------------- 
! Vector Wave Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 5
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 5
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 5
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx12 +& 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx12 +& 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx12 -& 
&  1.*coup1L*coup2L*int1*MassEx1*mF1 + coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx12 -& 
&  1.*coup1R*coup2R*int1*MassEx1*mF1 + coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 5
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx1*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx1*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx1*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx1*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 6
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx42 +& 
&  coup1R*coup2R*int1*MassEx4*mF1 - 1.*coup1R*coup2L*int2*MassEx4*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx42 +& 
&  coup1L*coup2L*int1*MassEx4*mF1 - 1.*coup1L*coup2R*int2*MassEx4*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 7
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 7
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 7
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt4,i3)
coup3R = cplcChaChaVZR(gt4,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt4,i1,i2)
coup1R = cplcChaChaAhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt4,i2,i1)
coup1R = cplcChaChiHpmR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 8
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt4,i2)
coup1R = cplcChaChiVWmR(gt4,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 8
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt4,i2,i1)
coup1R = cplcChacFuSdR(gt4,i2,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt4,i1,i2)
coup1R = cplcChaChahhR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 8
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt4,i1,i2)
coup1R = cplcChaFdcSuR(gt4,i1,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*coup2L*int2*MassEx42 -& 
&  1.*coup1L*coup2L*int1*MassEx4*mF1 + coup1L*coup2R*int2*MassEx4*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*coup2R*int2*MassEx42 -& 
&  1.*coup1R*coup2R*int1*MassEx4*mF1 + coup1R*coup2L*int2*MassEx4*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx42 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 8
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt4,i1)
coup1R = cplcChaChaVZR(gt4,i1)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt4)
MFin2 = MCha2(i3)-MCha2(gt4)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+(chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx4*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lVLRcross=PVO4lVLRcross+(chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx4*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx42 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx42 - 1.*MFin2)
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,bar[Cha], Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 11
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcChaChaAhL(i2,i3,i1)
coup2R = cplcChaChaAhR(i2,i3,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 11
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = Conjg(-cplcChaChaVZR(i1,i3))
coup2R = Conjg(-cplcChaChaVZL(i1,i3))
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,conj[Hpm], Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplChiChacHpmL(i1,i3,i2)
coup2R = cplChiChacHpmR(i1,i3,i2)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,conj[VWm], Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 11
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,i3))
coup2R = Conjg(-cplChiChacVWmL(i1,i3))
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx2*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx2*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx2*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx2*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 11
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 11
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup3L = cplcChaChaVZL(i3,gt3)
coup3R = cplcChaChaVZR(i3,gt3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1R*coup2L*int2*MassEx22 +& 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1L*coup2R*int2*MassEx22 +& 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*coup2R*int2*MassEx22 -& 
&  1.*coup1R*coup2R*int1*MassEx2*mF1 + coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*coup2L*int2*MassEx22 -& 
&  1.*coup1L*coup2L*int1*MassEx2*mF1 + coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 12
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup2L = cplcChaChaAhL(i3,i1,i2)
coup2R = cplcChaChaAhR(i3,i1,i2)
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 12
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup2L = Conjg(-cplcChaChaVZR(i3,i2))
coup2R = Conjg(-cplcChaChaVZL(i3,i2))
coup1L = Conjg(-cplcChaChaVZR(i2,gt3))
coup1R = Conjg(-cplcChaChaVZL(i2,gt3))
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup2L = cplcChaChiHpmL(i3,i2,i1)
coup2R = cplcChaChiHpmR(i3,i2,i1)
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 12
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup2L = Conjg(-cplcChaChiVWmR(i3,i2))
coup2R = Conjg(-cplcChaChiVWmL(i3,i2))
coup1L = Conjg(-cplChiChacVWmR(i2,gt3))
coup1R = Conjg(-cplChiChacVWmL(i2,gt3))
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mV12)
  int2=B1(0._dp, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(-2.*chargefactor*coup3L*coup4R*IMP2*(coup1R*MassEx3*(- & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(-2.*chargefactor*coup3R*coup4L*IMP2*(coup1L*MassEx3*(- & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1L*MassEx3*(-     & 
& 2.*coup2R*(Finite - 2.*int1)*mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1R*MassEx3*(-     & 
& 2.*coup2L*(Finite - 2.*int1)*mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)& 
& *MassEx32 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 12
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 12
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt3)
MFin2 = MCha2(i3)-MCha2(gt3)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mS12)
  int2=B1(0._dp, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+(2.*chargefactor*coup3L*coup4R*IMP2*(-1.*coup1L*coup2R*int2*MassEx32 +& 
&  coup1R*coup2R*int1*MassEx3*mF1 - 1.*coup1R*coup2L*int2*MassEx3*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lSLRcross=PVO4lSLRcross+(2.*chargefactor*coup3R*coup4L*IMP2*(-1.*coup1R*coup2L*int2*MassEx32 +& 
&  coup1L*coup2L*int1*MassEx3*mF1 - 1.*coup1L*coup2R*int2*MassEx3*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRRcross=PVO4lVRRcross+(chargefactor*coup3R*coup4R*IMP2*(coup1R*coup2L*int2*MassEx32 -& 
&  1.*coup1L*coup2L*int1*MassEx3*mF1 + coup1L*coup2R*int2*MassEx3*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVLLcross=PVO4lVLLcross+(chargefactor*coup3L*coup4L*IMP2*(coup1L*coup2R*int2*MassEx32 -& 
&  1.*coup1R*coup2R*int1*MassEx3*mF1 + coup1R*coup2L*int2*MassEx3*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx32 - 1.*MFin2)
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 !---------------------------------------- 
! Vector Penguin Contributions            
!---------------------------------------- 
! --  VZ - Penguins            
! Propagator: VZ, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV22, mV12)
  int3=C0check(mF12, mV22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLRcross=PVO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt4,gt3)
coup4R = cplcChaChaVZR(gt4,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLRcross=PVO4lVLRcross - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV22, mV12)
  int3=C0check(mF12, mV22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(Finite -& 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lSLRcross=PVO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(Finite -& 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lSLRcross=PVO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 3
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 4.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross - 4.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 3
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 3
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt3)
coup4R = cplcChaChaVZR(gt2,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+2.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lSLRcross=PVO4lSLRcross+2.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt3,i1)
coup1R = cplcChaChaAhR(i2,gt3,i1)
coup2L = cplcChaChaAhL(gt4,i3,i1)
coup2R = cplcChaChaAhR(gt4,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiHpmL(gt4,i1,i3)
coup2R = cplcChaChiHpmR(gt4,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt3,i2)
coup1R = cplChiChacHpmR(i1,gt3,i2)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = cplHpmcVWmVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt3)
coup1R = cplChiChacVWmR(i1,gt3)
coup2L = cplcChaChiVWmL(gt4,i1)
coup2R = cplcChaChiVWmR(gt4,i1)
coup3 = -cplcVWmVWmVZ
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV12, mV22)
  int3=C0check(mF12, mV12, mV22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-         & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i1,i2)
coup1R = cplChaFucSdR(gt3,i1,i2)
coup2L = cplcChacFuSdL(gt4,i1,i3)
coup2R = cplcChacFuSdR(gt4,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt3,i1)
coup1R = cplcChaChahhR(i2,gt3,i1)
coup2L = cplcChaChahhL(gt4,i3,i1)
coup2R = cplcChaChahhR(gt4,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt3,i1)
coup1R = cplcFdChaSuR(i2,gt3,i1)
coup2L = cplcChaFdcSuL(gt4,i3,i1)
coup2R = cplcChaFdcSuR(gt4,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt3)
coup1R = cplcChaChaVZR(i2,gt3)
coup2L = cplcChaChaVZL(gt4,i3)
coup2R = cplcChaChaVZR(gt4,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLRcross=PVO4lVLRcross - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaAhL(gt4,i1,i3)
coup2R = cplcChaChaAhR(gt4,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt3,i2)
coup1R = cplcChaChaAhR(i1,gt3,i2)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt3)
coup1R = cplcChaChaVZR(i1,gt3)
coup2L = cplcChaChahhL(gt4,i1,i3)
coup2R = cplcChaChahhR(gt4,i1,i3)
coup3 = cplhhVZVZ(i3)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt3,i2)
coup1R = cplcChaChahhR(i1,gt3,i2)
coup2L = cplcChaChaVZL(gt4,i1)
coup2R = cplcChaChaVZR(gt4,i1)
coup3 = cplhhVZVZ(i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt3,i2)
coup1R = cplcFdChaSuR(i1,gt3,i2)
coup2L = cplcChaFdcSuL(gt4,i1,i3)
coup2R = cplcChaFdcSuR(gt4,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLRcross=PVO4lVLRcross+2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt3,i1)
coup1R = cplChiChacHpmR(i2,gt3,i1)
coup2L = cplcChaChiHpmL(gt4,i3,i1)
coup2R = cplcChaChiHpmR(gt4,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 4
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt3,i2,i1)
coup1R = cplChaFucSdR(gt3,i2,i1)
coup2L = cplcChacFuSdL(gt4,i3,i1)
coup2R = cplcChacFuSdR(gt4,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mS12)
  int3=C0check(mF22, mF12, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2L*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2R*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLRcross=PVO4lVLRcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 4
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt3)
coup1R = cplChiChacVWmR(i2,gt3)
coup2L = cplcChaChiVWmL(gt4,i3)
coup2R = cplcChaChiVWmR(gt4,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = cplcChaChaVZL(gt2,gt1)
coup4R = cplcChaChaVZR(gt2,gt1)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF22, mF12, mV12)
  int3=C0check(mF22, mF12, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+0.
  PVO4lSLRcross=PVO4lSLRcross+0.
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross - 1.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLRcross=PVO4lVLRcross - 1.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Ah,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,i2,i1)
coup1R = cplcChaChaAhR(gt2,i2,i1)
coup2L = cplcChaChaAhL(i3,gt3,i1)
coup2R = cplcChaChaAhR(i3,gt3,i1)
coup3L = Conjg(-cplcChaChaVZR(i2,i3))
coup3R = Conjg(-cplcChaChaVZL(i2,i3))
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF12, mF22, mS12)
  int3=C0check(mF12, mF22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh,Ah
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = cplcChaChaAhL(i1,gt3,i3)
coup2R = cplcChaChaAhR(i1,gt3,i3)
coup3 = -cplAhhhVZ(i3,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,Ah,hh
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
coup2L = cplcChaChahhL(i1,gt3,i3)
coup2R = cplcChaChahhR(i1,gt3,i3)
coup3 = cplAhhhVZ(i2,i3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,VZ,hh
! Generic diagram: FVS,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i1))
coup1R = Conjg(-cplcChaChaVZL(gt2,i1))
coup2L = cplcChaChahhL(i1,gt3,i3)
coup2R = cplcChaChahhR(i1,gt3,i3)
coup3 = cplhhVZVZ(i3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Cha,hh,VZ
! Generic diagram: FSV,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
coup2L = Conjg(-cplcChaChaVZR(i1,gt3))
coup2R = Conjg(-cplcChaChaVZL(i1,gt3))
coup3 = cplhhVZVZ(i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,conj[Hpm],conj[Hpm]
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = cplChiChacHpmL(i1,gt3,i3)
coup2R = cplChiChacHpmR(i1,gt3,i3)
coup3 = cplHpmcHpmVZ(i3,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,conj[VWm],conj[Hpm]
! Generic diagram: FVS,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = cplChiChacHpmL(i1,gt3,i3)
coup2R = cplChiChacHpmR(i1,gt3,i3)
coup3 = cplHpmcVWmVZ(i3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mV12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Chi,conj[Hpm],conj[VWm]
! Generic diagram: FSV,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i1,i2)
coup1R = cplcChaChiHpmR(gt2,i1,i2)
coup2L = Conjg(-cplChiChacVWmR(i1,gt3))
coup2R = Conjg(-cplChiChacVWmL(i1,gt3))
coup3 = cplcHpmVWmVZ(i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C0check(mF12, mS12, mV22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1*mF1
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1*mF1
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1*mF1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 


 ! Propagator: VZ, Loop particles: Chi,conj[VWm],conj[VWm]
! Generic diagram: FVV,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,gt3))
coup2R = Conjg(-cplChiChacVWmL(i1,gt3))
coup3 = cplcVWmVWmVZ
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mV12, mV22)
  int2=C00_3m(mF12, mV12, mV22)
  int3=C0check(mF12, mV12, mV22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+2.*chargefactor*coup1L*coup2L*coup3*coup4R*IMP2*(-      & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lSLRcross=PVO4lSLRcross+2.*chargefactor*coup1R*coup2R*coup3*coup4L*IMP2*(-      & 
& 1.*Finite + 2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1R*coup2R*coup3*coup4R*IMP2*(Finite -  & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1L*coup2L*coup3*coup4L*IMP2*(Finite -  & 
&  2.*(int1 + 2.*int2 + int3*mF12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 


 ! Propagator: VZ, Loop particles: Fd,Su,Su
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
coup2L = cplcFdChaSuL(i1,gt3,i3)
coup2R = cplcFdChaSuR(i1,gt3,i3)
coup3 = -cplSucSuVZ(i2,i3)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: hh,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,i2,i1)
coup1R = cplcChaChahhR(gt2,i2,i1)
coup2L = cplcChaChahhL(i3,gt3,i1)
coup2R = cplcChaChahhR(i3,gt3,i1)
coup3L = Conjg(-cplcChaChaVZR(i2,i3))
coup3R = Conjg(-cplcChaChaVZL(i2,i3))
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF12, mF22, mS12)
  int3=C0check(mF12, mF22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Hpm,Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
coup2L = cplChiChacHpmL(i3,gt3,i1)
coup2R = cplChiChacHpmR(i3,gt3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF12, mF22, mS12)
  int3=C0check(mF12, mF22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: Sd,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
coup2L = cplChaFucSdL(gt3,i3,i1)
coup2R = cplChaFucSdR(gt3,i3,i1)
coup3L = cplcFuFuVZL(i3,i2)
coup3R = cplcFuFuVZR(i3,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF12, mF22, mS12)
  int3=C0check(mF12, mF22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VWm,Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt2,i2))
coup1R = Conjg(-cplcChaChiVWmL(gt2,i2))
coup2L = Conjg(-cplChiChacVWmR(i3,gt3))
coup2R = Conjg(-cplChiChacVWmL(i3,gt3))
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF12, mF22, mV12)
  int3=C0check(mF12, mF22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+2.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lSLRcross=PVO4lSLRcross+2.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: VZ,bar[Cha],bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 6
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChaVZR(gt2,i2))
coup1R = Conjg(-cplcChaChaVZL(gt2,i2))
coup2L = Conjg(-cplcChaChaVZR(i3,gt3))
coup2R = Conjg(-cplcChaChaVZL(i3,gt3))
coup3L = Conjg(-cplcChaChaVZR(i2,i3))
coup3R = Conjg(-cplcChaChaVZL(i2,i3))
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF12, mF22, mV12)
  int3=C0check(mF12, mF22, mV12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+2.*chargefactor*coup1L*coup2L*coup4R*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lSLRcross=PVO4lSLRcross+2.*chargefactor*coup1R*coup2R*coup4L*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRRcross=PVO4lVRRcross - 1.*chargefactor*coup1R*coup2R*coup4R*IMP2*(2.*coup3L*int3*mF1*mF2 +& 
&  coup3R*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVLLcross=PVO4lVLLcross - 1.*chargefactor*coup1L*coup2L*coup4L*IMP2*(2.*coup3R*int3*mF1*mF2 +& 
&  coup3L*(Finite - 2.*(int1 - 2.*int2 + int3*mV12)))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: bar[Fu],conj[Sd],conj[Sd]
! Generic diagram: FSS,  InsertionOrder: 6
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt2,i1,i2)
coup1R = cplcChacFuSdR(gt2,i1,i2)
coup2L = cplChaFucSdL(gt3,i1,i3)
coup2R = cplChaFucSdR(gt3,i1,i3)
coup3 = cplSdcSdVZ(i3,i2)
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=C00_3m(mF12, mS12, mS22)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross+4.*chargefactor*coup1R*coup2L*coup3*coup4R*IMP2*int1
  PVO4lSLRcross=PVO4lSLRcross+4.*chargefactor*coup1L*coup2R*coup3*coup4L*IMP2*int1
  PVO4lVRRcross=PVO4lVRRcross - 2.*chargefactor*coup1L*coup2R*coup3*coup4R*IMP2*int1
  PVO4lVLLcross=PVO4lVLLcross - 2.*chargefactor*coup1R*coup2L*coup3*coup4L*IMP2*int1
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Propagator: VZ, Loop particles: conj[Su],bar[Fd],bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 6
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt2,i2,i1)
coup1R = cplcChaFdcSuR(gt2,i2,i1)
coup2L = cplcFdChaSuL(i3,gt3,i1)
coup2R = cplcFdChaSuR(i3,gt3,i1)
coup3L = Conjg(-cplcFdFdVZR(i2,i3))
coup3R = Conjg(-cplcFdFdVZL(i2,i3))
coup4L = Conjg(-cplcChaChaVZR(gt4,gt1))
coup4R = Conjg(-cplcChaChaVZL(gt4,gt1))
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  int1=B0(0._dp, mF12, mF22)
  int2=C00_3m(mF12, mF22, mS12)
  int3=C0check(mF12, mF22, mS12)
  PVO4lSLLcross=PVO4lSLLcross+0.
  PVO4lSRRcross=PVO4lSRRcross+0.
  PVO4lSRLcross=PVO4lSRLcross - 2.*chargefactor*coup1R*coup2L*coup4R*IMP2*(-          & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lSLRcross=PVO4lSLRcross - 2.*chargefactor*coup1L*coup2R*coup4L*IMP2*(-          & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRRcross=PVO4lVRRcross+chargefactor*coup1L*coup2R*coup4R*IMP2*(-               & 
& 1.*coup3R*int3*mF1*mF2 + coup3L*(int1 - 2.*int2 + int3*mS12))
  PVO4lVLLcross=PVO4lVLLcross+chargefactor*coup1R*coup2L*coup4L*IMP2*(-               & 
& 1.*coup3L*int3*mF1*mF2 + coup3R*(int1 - 2.*int2 + int3*mS12))
  PVO4lVRLcross=PVO4lVRLcross+0.
  PVO4lVLRcross=PVO4lVLRcross+0.
  PVO4lTLLcross=PVO4lTLLcross+0.
  PVO4lTLRcross=PVO4lTLRcross+0.
  PVO4lTRLcross=PVO4lTRLcross+0.
  PVO4lTRRcross=PVO4lTRRcross+0.
  End if 
End if 
    End Do 
   End Do 
  End Do 


 PVO4lSLLcross=oo16pi2*PVO4lSLLcross
PVO4lSRRcross=oo16pi2*PVO4lSRRcross
PVO4lSRLcross=oo16pi2*PVO4lSRLcross
PVO4lSLRcross=oo16pi2*PVO4lSLRcross
PVO4lVRRcross=oo16pi2*PVO4lVRRcross
PVO4lVLLcross=oo16pi2*PVO4lVLLcross
PVO4lVRLcross=oo16pi2*PVO4lVRLcross
PVO4lVLRcross=oo16pi2*PVO4lVLRcross
PVO4lTLLcross=oo16pi2*PVO4lTLLcross
PVO4lTLRcross=oo16pi2*PVO4lTLRcross
PVO4lTRLcross=oo16pi2*PVO4lTRLcross
PVO4lTRRcross=oo16pi2*PVO4lTRRcross
Iname=Iname-1

End Subroutine CalculatePengV4Lcross 

Subroutine CalculateTreeS4Lcross(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,          & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,TSO4lSLLcross,TSO4lSRRcross,               & 
& TSO4lSRLcross,TSO4lSLRcross,TSO4lVRRcross,TSO4lVLLcross,TSO4lVRLcross,TSO4lVLRcross,   & 
& TSO4lTLLcross,TSO4lTLRcross,TSO4lTRLcross,TSO4lTRRcross)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeS4Lcross 
! 'PreSARAH' output has been generated  at 12:17 on 4.11.2014 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TSO4lSLLcross 
Complex(dp), Intent(out) :: TSO4lSRRcross 
Complex(dp), Intent(out) :: TSO4lSRLcross 
Complex(dp), Intent(out) :: TSO4lSLRcross 
Complex(dp), Intent(out) :: TSO4lVRRcross 
Complex(dp), Intent(out) :: TSO4lVLLcross 
Complex(dp), Intent(out) :: TSO4lVRLcross 
Complex(dp), Intent(out) :: TSO4lVLRcross 
Complex(dp), Intent(out) :: TSO4lTLLcross 
Complex(dp), Intent(out) :: TSO4lTLRcross 
Complex(dp), Intent(out) :: TSO4lTRLcross 
Complex(dp), Intent(out) :: TSO4lTRRcross 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeS4Lcross' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
TSO4lSLLcross=0._dp 
TSO4lSRRcross=0._dp 
TSO4lSRLcross=0._dp 
TSO4lSLRcross=0._dp 
TSO4lVRRcross=0._dp 
TSO4lVLLcross=0._dp 
TSO4lVRLcross=0._dp 
TSO4lVLRcross=0._dp 
TSO4lTLLcross=0._dp 
TSO4lTLRcross=0._dp 
TSO4lTRLcross=0._dp 
TSO4lTRRcross=0._dp 
!---------------------------------------- 
! Scalar Tree Contributions            
!---------------------------------------- 
! -- hh - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt2,gt1,iProp)
coup1R = cplcChaChahhR(gt2,gt1,iProp)
coup2L = cplcChaChahhL(gt4,gt3,iProp)
coup2R = cplcChaChahhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSO4lSLLcross=TSO4lSLLcross+ 1*coup1L*coup2L*IMP2
  TSO4lSRRcross=TSO4lSRRcross+ 1*coup1R*coup2R*IMP2
  TSO4lSRLcross=TSO4lSRLcross+ 1*coup1R*coup2L*IMP2
  TSO4lSLRcross=TSO4lSLRcross+ 1*coup1L*coup2R*IMP2
  TSO4lVRRcross=TSO4lVRRcross+ 0.
  TSO4lVLLcross=TSO4lVLLcross+ 0.
  TSO4lVRLcross=TSO4lVRLcross+ 0.
  TSO4lVLRcross=TSO4lVLRcross+ 0.
  TSO4lTLLcross=TSO4lTLLcross+ 0.
  TSO4lTLRcross=TSO4lTLRcross+ 0.
  TSO4lTRLcross=TSO4lTRLcross+ 0.
  TSO4lTRRcross=TSO4lTRRcross+ 0.
 End if 
End Do 


 ! Propagator: VZ
! InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt4,gt1,iProp)
coup1R = cplcChaChahhR(gt4,gt1,iProp)
coup2L = cplcChaChahhL(gt2,gt3,iProp)
coup2R = cplcChaChahhR(gt2,gt3,iProp)
! Propagator and inverse propagator mass 
MP = Mhh(iProp)
MP2 = Mhh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSO4lSLLcross=TSO4lSLLcross-0.5*coup1L*coup2L*IMP2
  TSO4lSRRcross=TSO4lSRRcross-0.5*coup1R*coup2R*IMP2
  TSO4lSRLcross=TSO4lSRLcross+ 0.
  TSO4lSLRcross=TSO4lSLRcross+ 0.
  TSO4lVRRcross=TSO4lVRRcross+ 0.
  TSO4lVLLcross=TSO4lVLLcross+ 0.
  TSO4lVRLcross=TSO4lVRLcross-0.5*coup1R*coup2L*IMP2
  TSO4lVLRcross=TSO4lVLRcross-0.5*coup1L*coup2R*IMP2
  TSO4lTLLcross=TSO4lTLLcross+ 0.125*coup1L*coup2L*IMP2
  TSO4lTLRcross=TSO4lTLRcross+ 0.
  TSO4lTRLcross=TSO4lTRLcross+ 0.
  TSO4lTRRcross=TSO4lTRRcross+ 0.125*coup1R*coup2R*IMP2
 End if 
End Do 


 ! -- Ah - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
Do iProp=1,8
If (((iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt2,gt1,iProp)
coup1R = cplcChaChaAhR(gt2,gt1,iProp)
coup2L = cplcChaChaAhL(gt4,gt3,iProp)
coup2R = cplcChaChaAhR(gt4,gt3,iProp)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSO4lSLLcross=TSO4lSLLcross+ 1*coup1L*coup2L*IMP2
  TSO4lSRRcross=TSO4lSRRcross+ 1*coup1R*coup2R*IMP2
  TSO4lSRLcross=TSO4lSRLcross+ 1*coup1R*coup2L*IMP2
  TSO4lSLRcross=TSO4lSLRcross+ 1*coup1L*coup2R*IMP2
  TSO4lVRRcross=TSO4lVRRcross+ 0.
  TSO4lVLLcross=TSO4lVLLcross+ 0.
  TSO4lVRLcross=TSO4lVRLcross+ 0.
  TSO4lVLRcross=TSO4lVLRcross+ 0.
  TSO4lTLLcross=TSO4lTLLcross+ 0.
  TSO4lTLRcross=TSO4lTLRcross+ 0.
  TSO4lTRLcross=TSO4lTRLcross+ 0.
  TSO4lTRRcross=TSO4lTRRcross+ 0.
 End if 
End Do 


 ! Propagator: VZ
! InsertionOrder: 3
chargefactor = 1 
Do iProp=1,8
If (((iProp.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt4,gt1,iProp)
coup1R = cplcChaChaAhR(gt4,gt1,iProp)
coup2L = cplcChaChaAhL(gt2,gt3,iProp)
coup2R = cplcChaChaAhR(gt2,gt3,iProp)
! Propagator and inverse propagator mass 
MP = MAh(iProp)
MP2 = MAh2(iProp)
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TSO4lSLLcross=TSO4lSLLcross-0.5*coup1L*coup2L*IMP2
  TSO4lSRRcross=TSO4lSRRcross-0.5*coup1R*coup2R*IMP2
  TSO4lSRLcross=TSO4lSRLcross+ 0.
  TSO4lSLRcross=TSO4lSLRcross+ 0.
  TSO4lVRRcross=TSO4lVRRcross+ 0.
  TSO4lVLLcross=TSO4lVLLcross+ 0.
  TSO4lVRLcross=TSO4lVRLcross-0.5*coup1R*coup2L*IMP2
  TSO4lVLRcross=TSO4lVLRcross-0.5*coup1L*coup2R*IMP2
  TSO4lTLLcross=TSO4lTLLcross+ 0.125*coup1L*coup2L*IMP2
  TSO4lTLRcross=TSO4lTLRcross+ 0.
  TSO4lTRLcross=TSO4lTRLcross+ 0.
  TSO4lTRRcross=TSO4lTRRcross+ 0.125*coup1R*coup2R*IMP2
 End if 
End Do 


 Iname=Iname-1

End Subroutine CalculateTreeS4Lcross 

Subroutine CalculateTreeV4Lcross(gt1,gt2,gt3,gt4,OnlySM,MAh,MAh2,MCha,MCha2,          & 
& MChi,MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,               & 
& MVWm2,MVZ,MVZ2,cplAhAhAh,cplAhAhhh,cplAhcHpmVWm,cplAhhhhh,cplAhhhVZ,cplAhHpmcHpm,      & 
& cplAhHpmcVWm,cplAhSdcSd,cplAhSucSu,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,          & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdAhL,cplcFdFdAhR,         & 
& cplcFdFdhhL,cplcFdFdhhR,cplcFdFdVPL,cplcFdFdVPR,cplcFdFdVZL,cplcFdFdVZR,               & 
& cplcFuFuAhL,cplcFuFuAhR,cplcFuFuhhL,cplcFuFuhhR,cplcFuFuVPL,cplcFuFuVPR,               & 
& cplcFuFuVZL,cplcFuFuVZR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChiAhL,cplChiChiAhR,cplChiChihhL,cplChiChihhR,     & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVPVWm,cplcHpmVWmVZ,cplcVWmVPVWm,cplcVWmVWmVZ,         & 
& cplhhcHpmVWm,cplhhcVWmVWm,cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,              & 
& cplhhSucSu,cplhhVZVZ,cplHpmcHpmVP,cplHpmcHpmVZ,cplHpmcVWmVP,cplHpmcVWmVZ,              & 
& cplSdcSdVP,cplSdcSdVZ,cplSucSuVP,cplSucSuVZ,TVO4lSLLcross,TVO4lSRRcross,               & 
& TVO4lSRLcross,TVO4lSLRcross,TVO4lVRRcross,TVO4lVLLcross,TVO4lVRLcross,TVO4lVLRcross,   & 
& TVO4lTLLcross,TVO4lTLRcross,TVO4lTRLcross,TVO4lTRRcross)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process TreeV4Lcross 
! 'PreSARAH' output has been generated  at 12:17 on 4.11.2014 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhAh(8,8,8),cplAhAhhh(8,8,8),cplAhcHpmVWm(8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),  & 
& cplAhHpmcHpm(8,8,8),cplAhHpmcVWm(8,8),cplAhSdcSd(8,6,6),cplAhSucSu(8,6,6),             & 
& cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),   & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdAhL(3,3,8),cplcFdFdAhR(3,3,8),         & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),               & 
& cplcFdFdVZL(3,3),cplcFdFdVZR(3,3),cplcFuFuAhL(3,3,8),cplcFuFuAhR(3,3,8),               & 
& cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),               & 
& cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiAhL(10,10,8),cplChiChiAhR(10,10,8),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVPVWm(8),cplcHpmVWmVZ(8),               & 
& cplcVWmVPVWm,cplcVWmVWmVZ,cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),          & 
& cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),             & 
& cplhhVZVZ(8),cplHpmcHpmVP(8,8),cplHpmcHpmVZ(8,8),cplHpmcVWmVP(8),cplHpmcVWmVZ(8),      & 
& cplSdcSdVP(6,6),cplSdcSdVZ(6,6),cplSucSuVP(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3,gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx4, MassEx12,MassEx22,MassEx32,MassEx42 
Complex(dp), Intent(out) :: TVO4lSLLcross 
Complex(dp), Intent(out) :: TVO4lSRRcross 
Complex(dp), Intent(out) :: TVO4lSRLcross 
Complex(dp), Intent(out) :: TVO4lSLRcross 
Complex(dp), Intent(out) :: TVO4lVRRcross 
Complex(dp), Intent(out) :: TVO4lVLLcross 
Complex(dp), Intent(out) :: TVO4lVRLcross 
Complex(dp), Intent(out) :: TVO4lVLRcross 
Complex(dp), Intent(out) :: TVO4lTLLcross 
Complex(dp), Intent(out) :: TVO4lTLRcross 
Complex(dp), Intent(out) :: TVO4lTRLcross 
Complex(dp), Intent(out) :: TVO4lTRRcross 
Complex(dp) :: vertex1L, vertex1R, vertex2L, vertex2R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateTreeV4Lcross' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MCha(gt3)  
MassEx32=MCha2(gt3) 
MassEx4=MCha(gt4)  
MassEx42=MCha2(gt4) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], ChargedLepton, bar[ChargedLepton]} 
 ! ------------------------------ 
 
TVO4lSLLcross=0._dp 
TVO4lSRRcross=0._dp 
TVO4lSRLcross=0._dp 
TVO4lSLRcross=0._dp 
TVO4lVRRcross=0._dp 
TVO4lVLLcross=0._dp 
TVO4lVRLcross=0._dp 
TVO4lVLRcross=0._dp 
TVO4lTLLcross=0._dp 
TVO4lTLRcross=0._dp 
TVO4lTRLcross=0._dp 
TVO4lTRRcross=0._dp 
!---------------------------------------- 
! Vector Tree Contributions            
!---------------------------------------- 
! -- VZ - Tree            
! Propagator: VZ
! InsertionOrder: 1
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(gt2,gt1)
coup1R = cplcChaChaVZR(gt2,gt1)
coup2L = cplcChaChaVZL(gt4,gt3)
coup2R = cplcChaChaVZR(gt4,gt3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TVO4lSLLcross=TVO4lSLLcross+ 0.
  TVO4lSRRcross=TVO4lSRRcross+ 0.
  TVO4lSRLcross=TVO4lSRLcross+ 0.
  TVO4lSLRcross=TVO4lSLRcross+ 0.
  TVO4lVRRcross=TVO4lVRRcross-1*coup1R*coup2R*IMP2
  TVO4lVLLcross=TVO4lVLLcross-1*coup1L*coup2L*IMP2
  TVO4lVRLcross=TVO4lVRLcross-1*coup1R*coup2L*IMP2
  TVO4lVLRcross=TVO4lVLRcross-1*coup1L*coup2R*IMP2
  TVO4lTLLcross=TVO4lTLLcross+ 0.
  TVO4lTLRcross=TVO4lTLRcross+ 0.
  TVO4lTRLcross=TVO4lTRLcross+ 0.
  TVO4lTRRcross=TVO4lTRRcross+ 0.
 End if 


 ! Propagator: VZ
! InsertionOrder: 3
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(gt4,gt1)
coup1R = cplcChaChaVZR(gt4,gt1)
coup2L = cplcChaChaVZL(gt2,gt3)
coup2R = cplcChaChaVZR(gt2,gt3)
! Propagator and inverse propagator mass 
MP = MVZ
MP2 = MVZ2
IMP = 1._dp/MP  
IMP2 = 1._dp/MP2 
! Amplitude 
  TVO4lSLLcross=TVO4lSLLcross+ 0.
  TVO4lSRRcross=TVO4lSRRcross+ 0.
  TVO4lSRLcross=TVO4lSRLcross+ 2*coup1R*coup2L*IMP2
  TVO4lSLRcross=TVO4lSLRcross+ 2*coup1L*coup2R*IMP2
  TVO4lVRRcross=TVO4lVRRcross-1*coup1R*coup2R*IMP2
  TVO4lVLLcross=TVO4lVLLcross-1*coup1L*coup2L*IMP2
  TVO4lVRLcross=TVO4lVRLcross+ 0.
  TVO4lVLRcross=TVO4lVLRcross+ 0.
  TVO4lTLLcross=TVO4lTLLcross+ 0.
  TVO4lTLRcross=TVO4lTLRcross+ 0.
  TVO4lTRLcross=TVO4lTRLcross+ 0.
  TVO4lTRRcross=TVO4lTRRcross+ 0.
 End if 


 Iname=Iname-1

End Subroutine CalculateTreeV4Lcross 

Subroutine CalculateGamma2l(gt1,gt2,gt3,OnlySM,MAh,MAh2,MCha,MCha2,MChi,              & 
& MChi2,MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,MVWm2,              & 
& MVZ,MVZ2,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,        & 
& cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,  & 
& cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,              & 
& cplcFdChaSuL,cplcFdChaSuR,cplcFdFdVPL,cplcFdFdVPR,cplcFuFuVPL,cplcFuFuVPR,             & 
& cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR, & 
& cplcHpmVPVWm,cplcVWmVPVWm,cplHpmcHpmVP,cplHpmcVWmVP,cplSdcSdVP,cplSucSuVP,             & 
& OA2lSL,OA2lSR,OA1L,OA1R)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process Gamma2l 
! 'PreSARAH' output has been generated  at 11:48 on 2.2.2015 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),  & 
& cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),       & 
& cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),   & 
& cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),   & 
& cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdVPL(3,3),cplcFdFdVPR(3,3),             & 
& cplcFuFuVPL(3,3),cplcFuFuVPR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),             & 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplcHpmVPVWm(8),cplcVWmVPVWm,cplHpmcHpmVP(8,8),cplHpmcVWmVP(8),cplSdcSdVP(6,6),        & 
& cplSucSuVP(6,6)

Integer,Intent(in) :: gt1, gt2,gt3 
Integer :: gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx12,MassEx22,MassEx32 
Complex(dp), Intent(out) :: OA2lSL 
Complex(dp), Intent(out) :: OA2lSR 
Complex(dp), Intent(out) :: OA1L 
Complex(dp), Intent(out) :: OA1R 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateGamma2l' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=0.  
MassEx32=0._dp 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {bar[ChargedLepton], ChargedLepton, Photon} 
 ! ------------------------------ 
 
OA2lSL=0._dp 
OA2lSR=0._dp 
OA1L=0._dp 
OA1R=0._dp 
!---------------------------------------- 
! Tree Contributions                      
!---------------------------------------- 
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVPL(gt1,gt2)
coup1R = cplcChaChaVPR(gt1,gt2)
! Amplitude 
  OA2lSL=OA2lSL+ 0.
  OA2lSR=OA2lSR+ 0.
  OA1L=OA1L+ 0.
  OA1R=OA1R+ 0.
 End if 


 !---------------------------------------- 
! Wave Contributions                      
!---------------------------------------- 
! Loop particles: Ah,bar[Cha], Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt1,i2,i1)
coup1R = cplcChaChaAhR(gt1,i2,i1)
coup2L = cplcChaChaAhL(i2,i3,i1)
coup2R = cplcChaChaAhR(i2,i3,i1)
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt1,i1,i2)
coup1R = cplcChaChahhR(gt1,i1,i2)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Cha,VP, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = Conjg(-cplcChaChaVPR(gt1,i1))
coup1R = Conjg(-cplcChaChaVPL(gt1,i1))
coup2L = Conjg(-cplcChaChaVPR(i1,i3))
coup2R = Conjg(-cplcChaChaVPL(i1,i3))
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChaVZR(gt1,i1))
coup1R = Conjg(-cplcChaChaVZL(gt1,i1))
coup2L = Conjg(-cplcChaChaVZR(i1,i3))
coup2R = Conjg(-cplcChaChaVZL(i1,i3))
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Chi,conj[Hpm], Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt1,i1,i2)
coup1R = cplcChaChiHpmR(gt1,i1,i2)
coup2L = cplChiChacHpmL(i1,i3,i2)
coup2R = cplChiChacHpmR(i1,i3,i2)
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,conj[VWm], Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt1,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt1,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,i3))
coup2R = Conjg(-cplChiChacVWmL(i1,i3))
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt1,i1,i2)
coup1R = cplcChaFdcSuR(gt1,i1,i2)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt1,i2,i1)
coup1R = cplcChacFuSdR(gt1,i2,i1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup3L = Conjg(-cplcChaChaVPR(i3,gt2))
coup3R = Conjg(-cplcChaChaVPL(i3,gt2))
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],Ah, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = cplcChaChaAhL(i3,i1,i2)
coup2R = cplcChaChaAhR(i3,i1,i2)
coup1L = cplcChaChaAhL(i1,gt2,i2)
coup1R = cplcChaChaAhR(i1,gt2,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup1L = cplcChaChahhL(i2,gt2,i1)
coup1R = cplcChaChahhR(i2,gt2,i1)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VP,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = Conjg(-cplcChaChaVPR(i3,i2))
coup2R = Conjg(-cplcChaChaVPL(i3,i2))
coup1L = Conjg(-cplcChaChaVPR(i2,gt2))
coup1R = Conjg(-cplcChaChaVPL(i2,gt2))
! Masses in loop
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = Conjg(-cplcChaChaVZR(i3,i2))
coup2R = Conjg(-cplcChaChaVZL(i3,i2))
coup1L = Conjg(-cplcChaChaVZR(i2,gt2))
coup1R = Conjg(-cplcChaChaVZL(i2,gt2))
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: conj[Hpm],Chi, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = cplcChaChiHpmL(i3,i2,i1)
coup2R = cplcChaChiHpmR(i3,i2,i1)
coup1L = cplChiChacHpmL(i2,gt2,i1)
coup1R = cplChiChacHpmR(i2,gt2,i1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[VWm],Chi, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = Conjg(-cplcChaChiVWmR(i3,i2))
coup2R = Conjg(-cplcChaChiVWmL(i3,i2))
coup1L = Conjg(-cplChiChacVWmR(i2,gt2))
coup1R = Conjg(-cplChiChacVWmL(i2,gt2))
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup1L = cplcFdChaSuL(i2,gt2,i1)
coup1R = cplcFdChaSuR(i2,gt2,i1)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = Conjg(-cplcChaChaVPR(gt1,i3))
coup3R = Conjg(-cplcChaChaVPL(gt1,i3))
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup1L = cplChaFucSdL(gt2,i1,i2)
coup1R = cplChaFucSdR(gt2,i1,i2)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  OA2lSL=OA2lSL+0.
  OA2lSR=OA2lSR+0.
  OA1L=OA1L+0.
  OA1R=OA1R+0.
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 !---------------------------------------- 
! Triangle Contributions                  
!---------------------------------------- 
! Loop particles: Ah,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(gt1,i2,i1)
coup1R = cplcChaChaAhR(gt1,i2,i1)
coup2L = cplcChaChaAhL(i3,gt2,i1)
coup2R = cplcChaChaAhR(i3,gt2,i1)
coup3L = Conjg(-cplcChaChaVPR(i2,i3))
coup3R = Conjg(-cplcChaChaVPL(i2,i3))
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=C0C1C2(mF22, mF12, mS12)
  int2=C12g(mF22, mF12, mS12)
  int3=C1g(mF22, mF12, mS12)
  int4=C2C12C22(mF22, mF12, mS12)
  OA2lSL=OA2lSL+2.*chargefactor*(coup1L*coup2R*coup3R*int2*MassEx1 - 1.*coup1R*(coup2L*coup3L*int4*MassEx2 +& 
&  coup2R*coup3R*int3*mF1 - 1.*coup2R*coup3L*int1*mF2))
  OA2lSR=OA2lSR+2.*chargefactor*(coup1R*coup2L*coup3L*int2*MassEx1 - 1.*coup1L*(coup2R*coup3R*int4*MassEx2 +& 
&  coup2L*coup3L*int3*mF1 - 1.*coup2L*coup3R*int1*mF2))
  OA1L=OA1L+chargefactor*coup1R*coup2L*coup3L*MonopoleSFF(mS12, mF12, mF22)
  OA1R=OA1R+chargefactor*coup1L*coup2R*coup3L*MonopoleSFF(mS12, mF12, mF22)
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,conj[Hpm],conj[Hpm]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt1,i1,i2)
coup1R = cplcChaChiHpmR(gt1,i1,i2)
coup2L = cplChiChacHpmL(i1,gt2,i3)
coup2R = cplChiChacHpmR(i1,gt2,i3)
coup3 = cplHpmcHpmVP(i3,i2)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Amplitude 
  int1=C0C1C2(mF12, mS22, mS12)
  int2=C1C12C11(mF12, mS22, mS12)
  int3=C2C12C22(mF12, mS22, mS12)
  OA2lSL=OA2lSL+2.*chargefactor*coup3*(coup1L*coup2R*int3*MassEx1 + coup1R*coup2L*int2*MassEx2 -& 
&  1.*coup1R*coup2R*int1*mF1)
  OA2lSR=OA2lSR+2.*chargefactor*coup3*(coup1R*coup2L*int3*MassEx1 + coup1L*coup2R*int2*MassEx2 -& 
&  1.*coup1L*coup2L*int1*mF1)
  OA1L=OA1L - 1.*chargefactor*coup1R*coup2L*coup3*MonopoleFSS(mF12, mS12, mS22)
  OA1R=OA1R - 1.*chargefactor*coup1L*coup2R*coup3*MonopoleFSS(mF12, mS12, mS22)
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,conj[VWm],conj[Hpm]
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt1,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt1,i1))
coup2L = cplChiChacHpmL(i1,gt2,i3)
coup2R = cplChiChacHpmR(i1,gt2,i3)
coup3 = cplHpmcVWmVP(i3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Amplitude 
  int1=C2g(mF12, mS22, mV12)
  OA2lSL=OA2lSL - 2.*chargefactor*coup1R*coup2R*coup3*int1
  OA2lSR=OA2lSR - 2.*chargefactor*coup1L*coup2L*coup3*int1
  OA1L=OA1L - 1.*chargefactor*coup1L*coup2L*coup3*MonopoleFVS(mF12, mV12, mS22)
  OA1R=OA1R - 1.*chargefactor*coup1R*coup2R*coup3*MonopoleFVS(mF12, mV12, mS22)
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Chi,conj[Hpm],conj[VWm]
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChiHpmL(gt1,i1,i2)
coup1R = cplcChaChiHpmR(gt1,i1,i2)
coup2L = Conjg(-cplChiChacVWmR(i1,gt2))
coup2R = Conjg(-cplChiChacVWmL(i1,gt2))
coup3 = cplcHpmVPVWm(i2)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Amplitude 
  int1=C1g(mF12, mV22, mS12)
  OA2lSL=OA2lSL - 2.*chargefactor*coup1R*coup2L*coup3*int1
  OA2lSR=OA2lSR - 2.*chargefactor*coup1L*coup2R*coup3*int1
  OA1L=OA1L - 1.*chargefactor*coup1L*coup2R*coup3*MonopoleFSV(mF12, mS12, mV22)
  OA1R=OA1R - 1.*chargefactor*coup1R*coup2L*coup3*MonopoleFSV(mF12, mS12, mV22)
  End if 
End if 
    End Do 
   End Do 


 ! Loop particles: Chi,conj[VWm],conj[VWm]
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChiVWmR(gt1,i1))
coup1R = Conjg(-cplcChaChiVWmL(gt1,i1))
coup2L = Conjg(-cplChiChacVWmR(i1,gt2))
coup2R = Conjg(-cplChiChacVWmL(i1,gt2))
coup3 = -cplcVWmVPVWm
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Amplitude 
  int1=C12C11C2(mF12, mV22, mV12)
  int2=C12C22C1(mF12, mV22, mV12)
  int3=C1C2(mF12, mV22, mV12)
  OA2lSL=OA2lSL+2.*chargefactor*coup3*(coup1L*coup2L*int2*MassEx1 + coup1R*coup2R*int1*MassEx2 +& 
&  3.*coup1R*coup2L*int3*mF1)
  OA2lSR=OA2lSR+2.*chargefactor*coup3*(coup1R*coup2R*int2*MassEx1 + coup1L*coup2L*int1*MassEx2 +& 
&  3.*coup1L*coup2R*int3*mF1)
  OA1L=OA1L - 1.*chargefactor*coup1L*coup2L*coup3*MonopoleFVV(mF12, mV12, mV22)
  OA1R=OA1R - 1.*chargefactor*coup1R*coup2R*coup3*MonopoleFVV(mF12, mV12, mV22)
  End if 
End if 
    End Do 


 ! Loop particles: Fd,Su,Su
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt1,i1,i2)
coup1R = cplcChaFdcSuR(gt1,i1,i2)
coup2L = cplcFdChaSuL(i1,gt2,i3)
coup2R = cplcFdChaSuR(i1,gt2,i3)
coup3 = -cplSucSuVP(i2,i3)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Amplitude 
  int1=C0C1C2(mF12, mS22, mS12)
  int2=C1C12C11(mF12, mS22, mS12)
  int3=C2C12C22(mF12, mS22, mS12)
  OA2lSL=OA2lSL+2.*chargefactor*coup3*(coup1L*coup2R*int3*MassEx1 + coup1R*coup2L*int2*MassEx2 -& 
&  1.*coup1R*coup2R*int1*mF1)
  OA2lSR=OA2lSR+2.*chargefactor*coup3*(coup1R*coup2L*int3*MassEx1 + coup1L*coup2R*int2*MassEx2 -& 
&  1.*coup1L*coup2L*int1*mF1)
  OA1L=OA1L - 1.*chargefactor*coup1R*coup2L*coup3*MonopoleFSS(mF12, mS12, mS22)
  OA1R=OA1R - 1.*chargefactor*coup1L*coup2R*coup3*MonopoleFSS(mF12, mS12, mS22)
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: hh,bar[Cha],bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(gt1,i2,i1)
coup1R = cplcChaChahhR(gt1,i2,i1)
coup2L = cplcChaChahhL(i3,gt2,i1)
coup2R = cplcChaChahhR(i3,gt2,i1)
coup3L = Conjg(-cplcChaChaVPR(i2,i3))
coup3R = Conjg(-cplcChaChaVPL(i2,i3))
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=C0C1C2(mF22, mF12, mS12)
  int2=C12g(mF22, mF12, mS12)
  int3=C1g(mF22, mF12, mS12)
  int4=C2C12C22(mF22, mF12, mS12)
  OA2lSL=OA2lSL+2.*chargefactor*(coup1L*coup2R*coup3R*int2*MassEx1 - 1.*coup1R*(coup2L*coup3L*int4*MassEx2 +& 
&  coup2R*coup3R*int3*mF1 - 1.*coup2R*coup3L*int1*mF2))
  OA2lSR=OA2lSR+2.*chargefactor*(coup1R*coup2L*coup3L*int2*MassEx1 - 1.*coup1L*(coup2R*coup3R*int4*MassEx2 +& 
&  coup2L*coup3L*int3*mF1 - 1.*coup2L*coup3R*int1*mF2))
  OA1L=OA1L+chargefactor*coup1R*coup2L*coup3L*MonopoleSFF(mS12, mF12, mF22)
  OA1R=OA1R+chargefactor*coup1L*coup2R*coup3L*MonopoleSFF(mS12, mF12, mF22)
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Sd,Fu,Fu
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt1,i2,i1)
coup1R = cplcChacFuSdR(gt1,i2,i1)
coup2L = cplChaFucSdL(gt2,i3,i1)
coup2R = cplChaFucSdR(gt2,i3,i1)
coup3L = cplcFuFuVPL(i3,i2)
coup3R = cplcFuFuVPR(i3,i2)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Amplitude 
  int1=C0C1C2(mF22, mF12, mS12)
  int2=C12g(mF22, mF12, mS12)
  int3=C1g(mF22, mF12, mS12)
  int4=C2C12C22(mF22, mF12, mS12)
  OA2lSL=OA2lSL+2.*chargefactor*(coup1L*coup2R*coup3R*int2*MassEx1 - 1.*coup1R*(coup2L*coup3L*int4*MassEx2 +& 
&  coup2R*coup3R*int3*mF1 - 1.*coup2R*coup3L*int1*mF2))
  OA2lSR=OA2lSR+2.*chargefactor*(coup1R*coup2L*coup3L*int2*MassEx1 - 1.*coup1L*(coup2R*coup3R*int4*MassEx2 +& 
&  coup2L*coup3L*int3*mF1 - 1.*coup2L*coup3R*int1*mF2))
  OA1L=OA1L+chargefactor*coup1R*coup2L*coup3L*MonopoleSFF(mS12, mF12, mF22)
  OA1R=OA1R+chargefactor*coup1L*coup2R*coup3L*MonopoleSFF(mS12, mF12, mF22)
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VZ,bar[Cha],bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = Conjg(-cplcChaChaVZR(gt1,i2))
coup1R = Conjg(-cplcChaChaVZL(gt1,i2))
coup2L = Conjg(-cplcChaChaVZR(i3,gt2))
coup2R = Conjg(-cplcChaChaVZL(i3,gt2))
coup3L = Conjg(-cplcChaChaVPR(i2,i3))
coup3R = Conjg(-cplcChaChaVPL(i2,i3))
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=C12C22(mF22, mF12, mV12)
  int2=C2C12(mF22, mF12, mV12)
  int3=C2g(mF22, mF12, mV12)
  OA2lSL=OA2lSL+chargefactor*(4.*coup1L*coup2L*coup3L*int2*MassEx1 - 4.*coup1R*(coup2R*coup3R*int1*MassEx2 +& 
&  coup2L*int3*(coup3L*mF1 + coup3R*mF2)))
  OA2lSR=OA2lSR - 4.*chargefactor*(-1.*coup1R*coup2R*coup3R*int2*MassEx1 +            & 
&  coup1L*(coup2L*coup3L*int1*MassEx2 + coup2R*int3*(coup3R*mF1 + coup3L*mF2)))
  OA1L=OA1L - 1.*chargefactor*coup1L*coup2L*coup3L*MonopoleVFF(mV12, mF12, mF22)
  OA1R=OA1R - 1.*chargefactor*coup1R*coup2R*coup3L*MonopoleVFF(mV12, mF12, mF22)
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: bar[Fu],conj[Sd],conj[Sd]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChacFuSdL(gt1,i1,i2)
coup1R = cplcChacFuSdR(gt1,i1,i2)
coup2L = cplChaFucSdL(gt2,i1,i3)
coup2R = cplChaFucSdR(gt2,i1,i3)
coup3 = cplSdcSdVP(i3,i2)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Amplitude 
  int1=C0C1C2(mF12, mS22, mS12)
  int2=C1C12C11(mF12, mS22, mS12)
  int3=C2C12C22(mF12, mS22, mS12)
  OA2lSL=OA2lSL+2.*chargefactor*coup3*(coup1L*coup2R*int3*MassEx1 + coup1R*coup2L*int2*MassEx2 -& 
&  1.*coup1R*coup2R*int1*mF1)
  OA2lSR=OA2lSR+2.*chargefactor*coup3*(coup1R*coup2L*int3*MassEx1 + coup1L*coup2R*int2*MassEx2 -& 
&  1.*coup1L*coup2L*int1*mF1)
  OA1L=OA1L - 1.*chargefactor*coup1R*coup2L*coup3*MonopoleFSS(mF12, mS12, mS22)
  OA1R=OA1R - 1.*chargefactor*coup1L*coup2R*coup3*MonopoleFSS(mF12, mS12, mS22)
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[Su],bar[Fd],bar[Fd]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaFdcSuL(gt1,i2,i1)
coup1R = cplcChaFdcSuR(gt1,i2,i1)
coup2L = cplcFdChaSuL(i3,gt2,i1)
coup2R = cplcFdChaSuR(i3,gt2,i1)
coup3L = Conjg(-cplcFdFdVPR(i2,i3))
coup3R = Conjg(-cplcFdFdVPL(i2,i3))
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Amplitude 
  int1=C0C1C2(mF22, mF12, mS12)
  int2=C12g(mF22, mF12, mS12)
  int3=C1g(mF22, mF12, mS12)
  int4=C2C12C22(mF22, mF12, mS12)
  OA2lSL=OA2lSL+2.*chargefactor*(coup1L*coup2R*coup3R*int2*MassEx1 - 1.*coup1R*(coup2L*coup3L*int4*MassEx2 +& 
&  coup2R*coup3R*int3*mF1 - 1.*coup2R*coup3L*int1*mF2))
  OA2lSR=OA2lSR+2.*chargefactor*(coup1R*coup2L*coup3L*int2*MassEx1 - 1.*coup1L*(coup2R*coup3R*int4*MassEx2 +& 
&  coup2L*coup3L*int3*mF1 - 1.*coup2L*coup3R*int1*mF2))
  OA1L=OA1L+chargefactor*coup1R*coup2L*coup3L*MonopoleSFF(mS12, mF12, mF22)
  OA1R=OA1R+chargefactor*coup1L*coup2R*coup3L*MonopoleSFF(mS12, mF12, mF22)
  End if 
End if 
    End Do 
   End Do 
  End Do 


 OA2lSL=oo16pi2*OA2lSL 
OA2lSR=oo16pi2*OA2lSR 
OA1L=oo16pi2*OA1L 
OA1R=oo16pi2*OA1R 
Iname=Iname-1

End Subroutine CalculateGamma2l 

Subroutine CalculateH2l(gt1,gt2,gt3,OnlySM,MAh,MAh2,MCha,MCha2,MChi,MChi2,            & 
& MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,MVWm2,MVZ,MVZ2,           & 
& cplAhAhhh,cplAhhhhh,cplAhhhVZ,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,               & 
& cplcChaChaAhR,cplcChaChahhL,cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,   & 
& cplcChaChaVZR,cplcChaChiHpmL,cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,             & 
& cplcChaFdcSuL,cplcChaFdcSuR,cplcFdChaSuL,cplcFdChaSuR,cplcFdFdhhL,cplcFdFdhhR,         & 
& cplcFuFuhhL,cplcFuFuhhR,cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,       & 
& cplChiChacVWmL,cplChiChacVWmR,cplChiChihhL,cplChiChihhR,cplhhcHpmVWm,cplhhcVWmVWm,     & 
& cplhhhhhh,cplhhHpmcHpm,cplhhHpmcVWm,cplhhSdcSd,cplhhSucSu,cplhhVZVZ,OH2lSL,OH2lSR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process H2l 
! 'PreSARAH' output has been generated  at 13:01 on 4.11.2014 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhAhhh(8,8,8),cplAhhhhh(8,8,8),cplAhhhVZ(8,8),cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),& 
& cplcChaChaAhL(5,5,8),cplcChaChaAhR(5,5,8),cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),   & 
& cplcChaChaVPL(5,5),cplcChaChaVPR(5,5),cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),           & 
& cplcChaChiHpmL(5,10,8),cplcChaChiHpmR(5,10,8),cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),& 
& cplcChaFdcSuL(5,3,6),cplcChaFdcSuR(5,3,6),cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),     & 
& cplcFdFdhhL(3,3,8),cplcFdFdhhR(3,3,8),cplcFuFuhhL(3,3,8),cplcFuFuhhR(3,3,8),           & 
& cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8), & 
& cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),cplChiChihhL(10,10,8),cplChiChihhR(10,10,8), & 
& cplhhcHpmVWm(8,8),cplhhcVWmVWm(8),cplhhhhhh(8,8,8),cplhhHpmcHpm(8,8,8),cplhhHpmcVWm(8,8),& 
& cplhhSdcSd(8,6,6),cplhhSucSu(8,6,6),cplhhVZVZ(8)

Integer,Intent(in) :: gt1, gt2,gt3 
Integer :: gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx12,MassEx22,MassEx32 
Complex(dp), Intent(out) :: OH2lSL 
Complex(dp), Intent(out) :: OH2lSR 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateH2l' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=Mhh(gt3)  
MassEx32=Mhh2(gt3) 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], HiggsBoson} 
 ! ------------------------------ 
 
OH2lSL=0._dp 
OH2lSR=0._dp 
!---------------------------------------- 
! Tree Contributions                      
!---------------------------------------- 
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChahhL(gt2,gt1,gt3)
coup1R = cplcChaChahhR(gt2,gt1,gt3)
! Amplitude 
  OH2lSL=OH2lSL-157.91367041742973*coup1L
  OH2lSR=OH2lSR-157.91367041742973*coup1R
 End if 


 !---------------------------------------- 
! Wave Contributions                      
!---------------------------------------- 
! Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx12 - 1.*coup1R*coup2R*int1*MassEx1*mF1 +& 
&  coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx12 - 1.*coup1L*coup2L*int1*MassEx1*mF1 +& 
&  coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx12 - 1.*coup1R*coup2R*int1*MassEx1*mF1 +& 
&  coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx12 - 1.*coup1L*coup2L*int1*MassEx1*mF1 +& 
&  coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mV12)
  int2=B1(MassEx12, mF12, mV12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1R*MassEx1*(-2.*coup2L*(Finite - 2.*int1)   & 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1L*MassEx1*(-2.*coup2R*(Finite - 2.*int1)   & 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx12 - 1.*coup1R*coup2R*int1*MassEx1*mF1 +& 
&  coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx12 - 1.*coup1L*coup2L*int1*MassEx1*mF1 +& 
&  coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx12 - 1.*coup1R*coup2R*int1*MassEx1*mF1 +& 
&  coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx12 - 1.*coup1L*coup2L*int1*MassEx1*mF1 +& 
&  coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx12 - 1.*coup1R*coup2R*int1*MassEx1*mF1 +& 
&  coup1R*coup2L*int2*MassEx1*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx12 - 1.*coup1L*coup2L*int1*MassEx1*mF1 +& 
&  coup1L*coup2R*int2*MassEx1*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx12 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VP,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i2,gt1)
coup1R = cplcChaChaVPR(i2,gt1)
coup2L = cplcChaChaVPL(i3,i2)
coup2R = cplcChaChaVPR(i3,i2)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mV12)
  int2=B1(MassEx12, mF12, mV12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1R*MassEx1*(-2.*coup2L*(Finite - 2.*int1)   & 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1L*MassEx1*(-2.*coup2R*(Finite - 2.*int1)   & 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChahhL(gt2,i3,gt3)
coup3R = cplcChaChahhR(gt2,i3,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mV12)
  int2=B1(MassEx12, mF12, mV12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1R*MassEx1*(-2.*coup2L*(Finite - 2.*int1)   & 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1L*MassEx1*(-2.*coup2R*(Finite - 2.*int1)   & 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx22 - 1.*coup1R*coup2R*int1*MassEx2*mF1 +& 
&  coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx22 - 1.*coup1L*coup2L*int1*MassEx2*mF1 +& 
&  coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx22 - 1.*coup1R*coup2R*int1*MassEx2*mF1 +& 
&  coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx22 - 1.*coup1L*coup2L*int1*MassEx2*mF1 +& 
&  coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mV12)
  int2=B1(MassEx22, mF12, mV12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*MassEx2*(-2.*coup2R*(Finite - 2.*int1)   & 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*MassEx2*(-2.*coup2L*(Finite - 2.*int1)   & 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx22 - 1.*coup1R*coup2R*int1*MassEx2*mF1 +& 
&  coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx22 - 1.*coup1L*coup2L*int1*MassEx2*mF1 +& 
&  coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx22 - 1.*coup1R*coup2R*int1*MassEx2*mF1 +& 
&  coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx22 - 1.*coup1L*coup2L*int1*MassEx2*mF1 +& 
&  coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*coup2R*int2*MassEx22 - 1.*coup1R*coup2R*int1*MassEx2*mF1 +& 
&  coup1R*coup2L*int2*MassEx2*MFin - 1.*coup1L*coup2L*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*coup2L*int2*MassEx22 - 1.*coup1L*coup2L*int1*MassEx2*mF1 +& 
&  coup1L*coup2R*int2*MassEx2*MFin - 1.*coup1R*coup2R*int1*mF1*MFin))/(MassEx22 -        & 
&  1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Cha,VP, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplcChaChaVPL(i1,i3)
coup2R = cplcChaChaVPR(i1,i3)
coup1L = cplcChaChaVPL(gt2,i1)
coup1R = cplcChaChaVPR(gt2,i1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mV12)
  int2=B1(MassEx22, mF12, mV12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*MassEx2*(-2.*coup2R*(Finite - 2.*int1)   & 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*MassEx2*(-2.*coup2L*(Finite - 2.*int1)   & 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChahhL(i3,gt1,gt3)
coup3R = cplcChaChahhR(i3,gt1,gt3)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mV12)
  int2=B1(MassEx22, mF12, mV12)
  OH2lSL=OH2lSL+(chargefactor*coup3L*(coup1L*MassEx2*(-2.*coup2R*(Finite - 2.*int1)   & 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  OH2lSR=OH2lSR+(chargefactor*coup3R*(coup1R*MassEx2*(-2.*coup2L*(Finite - 2.*int1)   & 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 


 !---------------------------------------- 
! Triangle Contributions                  
!---------------------------------------- 
! Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,gt3)
coup3R = cplcChaChahhR(i3,i2,gt3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*(coup3L*int2*mF1*mF2 + coup3R*(int1 + & 
&  int2*mS12))
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*(coup3R*int2*mF1*mF2 + coup3L*(int1 + & 
&  int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplhhHpmcHpm(gt3,i2,i3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplhhcHpmVWm(gt3,i3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Amplitude 
  int1=B0(MassEx32, mS22, mV12)
  int2=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mV12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*(int1 + int2*mF12)
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*(int1 + int2*mF12)
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplhhHpmcVWm(gt3,i2)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Amplitude 
  int1=B0(MassEx32, mS12, mV22)
  int2=C0(0._dp, MassEx32, 0._dp, mF12, mV22, mS12)
  OH2lSL=OH2lSL+chargefactor*coup1L*coup2R*coup3*(int1 + int2*mF12)
  OH2lSR=OH2lSR+chargefactor*coup1R*coup2L*coup3*(int1 + int2*mF12)
  End if 
End if 
    End Do 
   End Do 


 ! Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplhhcVWmVWm(gt3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mV22, mV12)
  OH2lSL=OH2lSL - 4.*chargefactor*coup1L*coup2R*coup3*int1*mF1
  OH2lSR=OH2lSR - 4.*chargefactor*coup1R*coup2L*coup3*int1*mF1
  End if 
End if 
    End Do 


 ! Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = cplhhSdcSd(gt3,i2,i3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChahhL(i3,i2,gt3)
coup3R = cplcChaChahhR(i3,i2,gt3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*(coup3L*int2*mF1*mF2 + coup3R*(int1 + & 
&  int2*mS12))
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*(coup3R*int2*mF1*mF2 + coup3L*(int1 + & 
&  int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdhhL(i3,i2,gt3)
coup3R = cplcFdFdhhR(i3,i2,gt3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*(coup3L*int2*mF1*mF2 + coup3R*(int1 + & 
&  int2*mS12))
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*(coup3R*int2*mF1*mF2 + coup3L*(int1 + & 
&  int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChahhL(i3,i2,gt3)
coup3R = cplcChaChahhR(i3,i2,gt3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  OH2lSL=OH2lSL+2.*chargefactor*coup1L*coup2R*(2.*coup3R*int2*mF1*mF2 +               & 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  OH2lSR=OH2lSR+2.*chargefactor*coup1R*coup2L*(2.*coup3L*int2*mF1*mF2 +               & 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],Ah,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhAhhh(i3,i2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = cplAhhhhh(i3,gt3,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],VZ,Ah
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Amplitude 
  int1=B0(MassEx32, mS22, mV12)
  int2=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mV12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*(int1 + int2*mF12)
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*(int1 + int2*mF12)
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhhh(i2,gt3,i3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],hh,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhhhhh(gt3,i3,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],Ah,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = -cplAhhhVZ(i2,gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Amplitude 
  int1=B0(MassEx32, mS12, mV22)
  int2=C0(0._dp, MassEx32, 0._dp, mF12, mV22, mS12)
  OH2lSL=OH2lSL+chargefactor*coup1L*coup2R*coup3*(int1 + int2*mF12)
  OH2lSR=OH2lSR+chargefactor*coup1R*coup2L*coup3*(int1 + int2*mF12)
  End if 
End if 
    End Do 
   End Do 


 ! Loop particles: bar[Cha],VZ,VZ
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(gt3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mV2 = MVZ
mV22 = MVZ2
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mV22, mV12)
  OH2lSL=OH2lSL - 4.*chargefactor*coup1L*coup2R*coup3*int1*mF1
  OH2lSR=OH2lSR - 4.*chargefactor*coup1R*coup2L*coup3*int1*mF1
  End if 
End if 
    End Do 


 ! Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplhhSucSu(gt3,i3,i2)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChihhL(i3,i2,gt3)
coup3R = cplChiChihhR(i3,i2,gt3)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*(coup3L*int2*mF1*mF2 + coup3R*(int1 + & 
&  int2*mS12))
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*(coup3R*int2*mF1*mF2 + coup3L*(int1 + & 
&  int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = cplcFuFuhhL(i2,i3,gt3)
coup3R = cplcFuFuhhR(i2,i3,gt3)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OH2lSL=OH2lSL - 1.*chargefactor*coup1L*coup2L*(coup3L*int2*mF1*mF2 + coup3R*(int1 + & 
&  int2*mS12))
  OH2lSR=OH2lSR - 1.*chargefactor*coup1R*coup2R*(coup3R*int2*mF1*mF2 + coup3L*(int1 + & 
&  int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChihhL(i3,i2,gt3)
coup3R = cplChiChihhR(i3,i2,gt3)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  OH2lSL=OH2lSL+2.*chargefactor*coup1L*coup2R*(2.*coup3R*int2*mF1*mF2 +               & 
&  coup3L*(-1.*Finite + 2.*(int1 + int2*mV12)))
  OH2lSR=OH2lSR+2.*chargefactor*coup1R*coup2L*(2.*coup3L*int2*mF1*mF2 +               & 
&  coup3R*(-1.*Finite + 2.*(int1 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 


 OH2lSL=oo16pi2*OH2lSL 
OH2lSR=oo16pi2*OH2lSR 
Iname=Iname-1

End Subroutine CalculateH2l 

Subroutine CalculateZ2l(gt1,gt2,gt3,OnlySM,MAh,MAh2,MCha,MCha2,MChi,MChi2,            & 
& MFd,MFd2,MFu,MFu2,Mhh,Mhh2,MHpm,MHpm2,MSd,MSd2,MSu,MSu2,MVWm,MVWm2,MVZ,MVZ2,           & 
& cplAhhhVZ,cplcChacFuSdL,cplcChacFuSdR,cplcChaChaAhL,cplcChaChaAhR,cplcChaChahhL,       & 
& cplcChaChahhR,cplcChaChaVPL,cplcChaChaVPR,cplcChaChaVZL,cplcChaChaVZR,cplcChaChiHpmL,  & 
& cplcChaChiHpmR,cplcChaChiVWmL,cplcChaChiVWmR,cplcChaFdcSuL,cplcChaFdcSuR,              & 
& cplcFdChaSuL,cplcFdChaSuR,cplcFdFdVZL,cplcFdFdVZR,cplcFuFuVZL,cplcFuFuVZR,             & 
& cplChaFucSdL,cplChaFucSdR,cplChiChacHpmL,cplChiChacHpmR,cplChiChacVWmL,cplChiChacVWmR, & 
& cplChiChiVZL,cplChiChiVZR,cplcHpmVWmVZ,cplcVWmVWmVZ,cplhhVZVZ,cplHpmcHpmVZ,            & 
& cplHpmcVWmVZ,cplSdcSdVZ,cplSucSuVZ,OZ2lSL,OZ2lSR,OZ2lVL,OZ2lVR)

! ---------------------------------------------------------------- 
! Code based on automatically generated SARAH extensions by 'PreSARAH' 
! Expressions for amplitudes are obtained by FeynArts/FormCalc 
! Based on user input for process Z2l 
! 'PreSARAH' output has been generated  at 13:02 on 4.11.2014 
! ---------------------------------------------------------------- 
 
Implicit None 
Real(dp),Intent(in) :: MAh(8),MAh2(8),MCha(5),MCha2(5),MChi(10),MChi2(10),MFd(3),MFd2(3),MFu(3),             & 
& MFu2(3),Mhh(8),Mhh2(8),MHpm(8),MHpm2(8),MSd(6),MSd2(6),MSu(6),MSu2(6),MVWm,            & 
& MVWm2,MVZ,MVZ2

Complex(dp),Intent(in) :: cplAhhhVZ(8,8),cplcChacFuSdL(5,3,6),cplcChacFuSdR(5,3,6),cplcChaChaAhL(5,5,8),        & 
& cplcChaChaAhR(5,5,8),cplcChaChahhL(5,5,8),cplcChaChahhR(5,5,8),cplcChaChaVPL(5,5),     & 
& cplcChaChaVPR(5,5),cplcChaChaVZL(5,5),cplcChaChaVZR(5,5),cplcChaChiHpmL(5,10,8),       & 
& cplcChaChiHpmR(5,10,8),cplcChaChiVWmL(5,10),cplcChaChiVWmR(5,10),cplcChaFdcSuL(5,3,6), & 
& cplcChaFdcSuR(5,3,6),cplcFdChaSuL(3,5,6),cplcFdChaSuR(3,5,6),cplcFdFdVZL(3,3),         & 
& cplcFdFdVZR(3,3),cplcFuFuVZL(3,3),cplcFuFuVZR(3,3),cplChaFucSdL(5,3,6),cplChaFucSdR(5,3,6),& 
& cplChiChacHpmL(10,5,8),cplChiChacHpmR(10,5,8),cplChiChacVWmL(10,5),cplChiChacVWmR(10,5),& 
& cplChiChiVZL(10,10),cplChiChiVZR(10,10),cplcHpmVWmVZ(8),cplcVWmVWmVZ,cplhhVZVZ(8),     & 
& cplHpmcHpmVZ(8,8),cplHpmcVWmVZ(8),cplSdcSdVZ(6,6),cplSucSuVZ(6,6)

Integer,Intent(in) :: gt1, gt2,gt3 
Integer :: gt4 
Logical, Intent(in) :: OnlySM 
Integer :: iprop, i1, i2, i3, i4 
Real(dp) :: MassEx1,MassEx2,MassEx3,MassEx12,MassEx22,MassEx32 
Complex(dp), Intent(out) :: OZ2lSL 
Complex(dp), Intent(out) :: OZ2lSR 
Complex(dp), Intent(out) :: OZ2lVL 
Complex(dp), Intent(out) :: OZ2lVR 
Real(dp) ::  MP, MP2, IMP2, IMP, MFin, MFin2, IMFin, IMFin2, Finite  
Real(dp) ::  MS1, MS12, MS2, MS22, MF1, MF12, MF2, MF22, MV1, MV12, MV2, MV22  
Complex(dp) ::  chargefactor  
Complex(dp) ::  coup1L, coup1R, coup2L, coup2R, coup3L, coup3R, coup3, coup4L, coup4R 

Complex(dp) ::  int1,int2,int3,int4,int5,int6,int7,int8 

Iname=Iname+1 
NameOfUnit(Iname)='CalculateZ2l' 

Finite=1._dp 
MassEx1=MCha(gt1)  
MassEx12=MCha2(gt1) 
MassEx2=MCha(gt2)  
MassEx22=MCha2(gt2) 
MassEx3=MVZ  
MassEx32=MVZ2 
! ------------------------------ 
 ! Amplitudes for external states 
 ! {ChargedLepton, bar[ChargedLepton], Zboson} 
 ! ------------------------------ 
 
OZ2lSL=0._dp 
OZ2lSR=0._dp 
OZ2lVL=0._dp 
OZ2lVR=0._dp 
!---------------------------------------- 
! Tree Contributions                      
!---------------------------------------- 
chargefactor = 1 
If ((OnlySM).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(gt2,gt1)
coup1R = cplcChaChaVZR(gt2,gt1)
! Amplitude 
  OZ2lSL=OZ2lSL+ 0.
  OZ2lSR=OZ2lSR+ 0.
  OZ2lVL=OZ2lVL+ 157.91367041742973*coup1L
  OZ2lVR=OZ2lVR+ 157.91367041742973*coup1R
 End if 


 !---------------------------------------- 
! Wave Contributions                      
!---------------------------------------- 
! Loop particles: Ah,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(i3,i2,i1)
coup2R = cplcChaChaAhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1L*coup2R*int2*MassEx12 +               & 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1R*coup2L*int2*MassEx12 +               & 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,Hpm, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(i3,i1,i2)
coup2R = cplcChaChiHpmR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1L*coup2R*int2*MassEx12 +               & 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1R*coup2L*int2*MassEx12 +               & 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,VWm, Internal fermion: bar[Cha]
! Generic diagram: FVF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,5
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(i3,i1)
coup2R = cplcChaChiVWmR(i3,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mV12)
  int2=B1(MassEx12, mF12, mV12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(-1.*chargefactor*coup3L*(coup1R*MassEx1*(-2.*coup2L*(Finite - 2.*int1)& 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(-1.*chargefactor*coup3R*(coup1L*MassEx1*(-2.*coup2R*(Finite - 2.*int1)& 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Fu,Sd, Internal fermion: bar[Cha]
! Generic diagram: FSF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(i3,i1,i2)
coup2R = cplcChacFuSdR(i3,i1,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1L*coup2R*int2*MassEx12 +               & 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1R*coup2L*int2*MassEx12 +               & 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: hh,Cha, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(i3,i2,i1)
coup2R = cplcChaChahhR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1L*coup2R*int2*MassEx12 +               & 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1R*coup2L*int2*MassEx12 +               & 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Su,Fd, Internal fermion: bar[Cha]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(i3,i2,i1)
coup2R = cplcChaFdcSuR(i3,i2,i1)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mS12)
  int2=B1(MassEx12, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1L*coup2R*int2*MassEx12 +               & 
&  coup1R*coup2R*int1*MassEx1*mF1 - 1.*coup1R*coup2L*int2*MassEx1*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1R*coup2L*int2*MassEx12 +               & 
&  coup1L*coup2L*int1*MassEx1*mF1 - 1.*coup1L*coup2R*int2*MassEx1*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VP,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((0._dp.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVPL(i2,gt1)
coup1R = cplcChaChaVPR(i2,gt1)
coup2L = cplcChaChaVPL(i3,i2)
coup2R = cplcChaChaVPR(i3,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mV1 = 0.
mV12 = 0._dp
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mV12)
  int2=B1(MassEx12, mF12, mV12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(-1.*chargefactor*coup3L*(coup1R*MassEx1*(-2.*coup2L*(Finite - 2.*int1)& 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(-1.*chargefactor*coup3R*(coup1L*MassEx1*(-2.*coup2R*(Finite - 2.*int1)& 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: VZ,Cha, Internal fermion: bar[Cha]
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(i3,i2)
coup2R = cplcChaChaVZR(i3,i2)
coup3L = cplcChaChaVZL(gt2,i3)
coup3R = cplcChaChaVZR(gt2,i3)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt1)
MFin2 = MCha2(i3)-MCha2(gt1)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx12, mF12, mV12)
  int2=B1(MassEx12, mF12, mV12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(-1.*chargefactor*coup3L*(coup1R*MassEx1*(-2.*coup2L*(Finite - 2.*int1)& 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(-1.*chargefactor*coup3R*(coup1L*MassEx1*(-2.*coup2R*(Finite - 2.*int1)& 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx12 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx12 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: Cha,Ah, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaAhL(i1,i3,i2)
coup2R = cplcChaChaAhR(i1,i3,i2)
coup1L = cplcChaChaAhL(gt2,i1,i2)
coup1R = cplcChaChaAhR(gt2,i1,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1R*coup2L*int2*MassEx22 +               & 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1L*coup2R*int2*MassEx22 +               & 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Hpm,Chi, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,5
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacHpmL(i2,i3,i1)
coup2R = cplChiChacHpmR(i2,i3,i1)
coup1L = cplcChaChiHpmL(gt2,i2,i1)
coup1R = cplcChaChiHpmR(gt2,i2,i1)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1R*coup2L*int2*MassEx22 +               & 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1L*coup2R*int2*MassEx22 +               & 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VWm,Chi, Internal fermion: Cha
! Generic diagram: VFF,  InsertionOrder: 2
chargefactor = 1 
  Do i2=1,10
    Do i3=1,5
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChiChacVWmL(i2,i3)
coup2R = cplChiChacVWmR(i2,i3)
coup1L = cplcChaChiVWmL(gt2,i2)
coup1R = cplcChaChiVWmR(gt2,i2)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mV12)
  int2=B1(MassEx22, mF12, mV12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(-1.*chargefactor*coup3L*(coup1R*MassEx2*(-2.*coup2L*(Finite - 2.*int1)& 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(-1.*chargefactor*coup3R*(coup1L*MassEx2*(-2.*coup2R*(Finite - 2.*int1)& 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: Sd,Fu, Internal fermion: Cha
! Generic diagram: SFF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,5
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplChaFucSdL(i3,i2,i1)
coup2R = cplChaFucSdR(i3,i2,i1)
coup1L = cplcChacFuSdL(gt2,i2,i1)
coup1R = cplcChacFuSdR(gt2,i2,i1)
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1R*coup2L*int2*MassEx22 +               & 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1L*coup2R*int2*MassEx22 +               & 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Cha,hh, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChahhL(i1,i3,i2)
coup2R = cplcChaChahhR(i1,i3,i2)
coup1L = cplcChaChahhL(gt2,i1,i2)
coup1R = cplcChaChahhR(gt2,i1,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1R*coup2L*int2*MassEx22 +               & 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1L*coup2R*int2*MassEx22 +               & 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Fd,Su, Internal fermion: Cha
! Generic diagram: FSF,  InsertionOrder: 2
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,5
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcFdChaSuL(i1,i3,i2)
coup2R = cplcFdChaSuR(i1,i3,i2)
coup1L = cplcChaFdcSuL(gt2,i1,i2)
coup1R = cplcChaFdcSuR(gt2,i1,i2)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mS12)
  int2=B1(MassEx22, mF12, mS12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(chargefactor*coup3L*(-1.*coup1R*coup2L*int2*MassEx22 +               & 
&  coup1L*coup2L*int1*MassEx2*mF1 - 1.*coup1L*coup2R*int2*MassEx2*MFin + coup1R*coup2R*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(chargefactor*coup3R*(-1.*coup1L*coup2R*int2*MassEx22 +               & 
&  coup1R*coup2R*int1*MassEx2*mF1 - 1.*coup1R*coup2L*int2*MassEx2*MFin + coup1L*coup2L*int1*mF1*MFin))& 
& /(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Cha,VP, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(0._dp.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaVPL(i1,i3)
coup2R = cplcChaChaVPR(i1,i3)
coup1L = cplcChaChaVPL(gt2,i1)
coup1R = cplcChaChaVPR(gt2,i1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = 0.
mV12 = 0._dp
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mV12)
  int2=B1(MassEx22, mF12, mV12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(-1.*chargefactor*coup3L*(coup1R*MassEx2*(-2.*coup2L*(Finite - 2.*int1)& 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(-1.*chargefactor*coup3R*(coup1L*MassEx2*(-2.*coup2R*(Finite - 2.*int1)& 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Cha,VZ, Internal fermion: Cha
! Generic diagram: FVF,  InsertionOrder: 2
chargefactor = 1 
Do i1=1,5
    Do i3=1,5
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup3L = cplcChaChaVZL(i3,gt1)
coup3R = cplcChaChaVZR(i3,gt1)
coup2L = cplcChaChaVZL(i1,i3)
coup2R = cplcChaChaVZR(i1,i3)
coup1L = cplcChaChaVZL(gt2,i1)
coup1R = cplcChaChaVZR(gt2,i1)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
! Mass of internal fermion 
MFin = MCha(i3)-MCha(gt2)
MFin2 = MCha2(i3)-MCha2(gt2)
If (Abs(MFin).gt.10E-10_dp) Then 
MFin = MCha(i3)
MFin2 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx22, mF12, mV12)
  int2=B1(MassEx22, mF12, mV12)
  OZ2lSL=OZ2lSL+0.
  OZ2lSR=OZ2lSR+0.
  OZ2lVL=OZ2lVL+(-1.*chargefactor*coup3L*(coup1R*MassEx2*(-2.*coup2L*(Finite - 2.*int1)& 
& *mF1 + coup2R*(Finite + 2.*int2)*MFin) + coup1L*(coup2L*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2R*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
  OZ2lVR=OZ2lVR+(-1.*chargefactor*coup3R*(coup1L*MassEx2*(-2.*coup2R*(Finite - 2.*int1)& 
& *mF1 + coup2L*(Finite + 2.*int2)*MFin) + coup1R*(coup2R*(Finite + 2.*int2)             & 
& *MassEx22 - 2.*coup2L*(Finite - 2.*int1)*mF1*MFin)))/(MassEx22 - 1.*MFin2)
     End if 
  End if 
End if 
    End Do 
  End Do 


 !---------------------------------------- 
! Triangle Contributions                  
!---------------------------------------- 
! Loop particles: Ah,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((MAh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaAhL(i2,gt1,i1)
coup1R = cplcChaChaAhR(i2,gt1,i1)
coup2L = cplcChaChaAhL(gt2,i3,i1)
coup2R = cplcChaChaAhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
! Masses in loop
mS1 = MAh(i1)
mS12 = MAh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int3=Cget("C00 ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int4=Cget("C1  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int5=Cget("C2  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OZ2lSL=OZ2lSL+2.*chargefactor*coup1L*coup2L*(-1.*coup3L*int4*mF1 + coup3R*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lSR=OZ2lSR+2.*chargefactor*coup1R*coup2R*(-1.*coup3R*int4*mF1 + coup3L*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2R*(coup3L*int2*mF1*mF2 - 1.*coup3R*(int1 -   & 
&  2.*int3 + int2*mS12))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2L*(coup3R*int2*mF1*mF2 - 1.*coup3L*(int1 -   & 
&  2.*int3 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,Hpm,Hpm
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = -cplHpmcHpmVZ(i2,i3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int2=Cget("C00 ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int3=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int4=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2L*coup3*(int1 + int3 + int4)*mF1
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2R*coup3*(int1 + int3 + int4)*mF1
  OZ2lVL=OZ2lVL - 2.*chargefactor*coup1L*coup2R*coup3*int2
  OZ2lVR=OZ2lVR - 2.*chargefactor*coup1R*coup2L*coup3*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Chi,VWm,Hpm
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
    Do i3=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MHpm2(i3).gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i3.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiHpmL(gt2,i1,i3)
coup2R = cplcChaChiHpmR(gt2,i1,i3)
coup3 = cplcHpmVWmVZ(i3)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mS2 = MHpm(i3)
mS22 = MHpm2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mV12)
  int2=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mS22, mV12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2L*coup3*int2
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2R*coup3*int2
  OZ2lVL=OZ2lVL - 1.*chargefactor*coup1L*coup2R*coup3*int1*mF1
  OZ2lVR=OZ2lVR - 1.*chargefactor*coup1R*coup2L*coup3*int1*mF1
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: Chi,Hpm,VWm
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
  Do i2=1,8
If ((MChi2(i1).gt.mf_l2(3)).Or.(MHpm2(i2).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4).and.(i2.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i1,gt1,i2)
coup1R = cplChiChacHpmR(i1,gt1,i2)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = cplHpmcVWmVZ(i2)
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mS1 = MHpm(i2)
mS12 = MHpm2(i2)
mV2 = MVWm
mV22 = MVWm2
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mV22, mS12)
  int2=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mV22, mS12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2R*coup3*int2
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2L*coup3*int2
  OZ2lVL=OZ2lVL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OZ2lVR=OZ2lVR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 


 ! Loop particles: Chi,VWm,VWm
! Generic diagram: FVV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,10
If ((MChi2(i1).gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3)).Or.(MVWm2.gt.mf_l2(3))) Then
If (((i1.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i1,gt1)
coup1R = cplChiChacVWmR(i1,gt1)
coup2L = cplcChaChiVWmL(gt2,i1)
coup2R = cplcChaChiVWmR(gt2,i1)
coup3 = -cplcVWmVWmVZ
! Masses in loop
mF1 = MChi(i1)
mF12 = MChi2(i1)
mV1 = MVWm
mV12 = MVWm2
mV2 = MVWm
mV22 = MVWm2
! Amplitude 
  int1=B0(MassEx32, mV12, mV22)
  int2=C0(0._dp, MassEx32, 0._dp, mF12, mV22, mV12)
  int3=Cget("C00 ",0._dp, MassEx32, 0._dp, mF12, mV22, mV12)
  int4=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mV22, mV12)
  int5=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mV22, mV12)
  OZ2lSL=OZ2lSL+6.*chargefactor*coup1L*coup2R*coup3*(int4 + int5)*mF1
  OZ2lSR=OZ2lSR+6.*chargefactor*coup1R*coup2L*coup3*(int4 + int5)*mF1
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2L*coup3*(Finite - 2.*(int1 + 2.*int3 +       & 
&  int2*mF12))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2R*coup3*(Finite - 2.*(int1 + 2.*int3 +       & 
&  int2*mF12))
  End if 
End if 
    End Do 


 ! Loop particles: Fu,Sd,Sd
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFu2(i1).gt.mf_l2(3)).Or.(MSd2(i2).gt.mf_l2(3)).Or.(MSd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i1,i2)
coup1R = cplChaFucSdR(gt1,i1,i2)
coup2L = cplcChacFuSdL(gt2,i1,i3)
coup2R = cplcChacFuSdR(gt2,i1,i3)
coup3 = -cplSdcSdVZ(i2,i3)
! Masses in loop
mF1 = MFu(i1)
mF12 = MFu2(i1)
mS1 = MSd(i2)
mS12 = MSd2(i2)
mS2 = MSd(i3)
mS22 = MSd2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int2=Cget("C00 ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int3=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int4=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2L*coup3*(int1 + int3 + int4)*mF1
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2R*coup3*(int1 + int3 + int4)*mF1
  OZ2lVL=OZ2lVL - 2.*chargefactor*coup1L*coup2R*coup3*int2
  OZ2lVR=OZ2lVR - 2.*chargefactor*coup1R*coup2L*coup3*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: hh,Cha,Cha
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,5
    Do i3=1,5
If ((Mhh2(i1).gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i2,gt1,i1)
coup1R = cplcChaChahhR(i2,gt1,i1)
coup2L = cplcChaChahhL(gt2,i3,i1)
coup2R = cplcChaChahhR(gt2,i3,i1)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
! Masses in loop
mS1 = Mhh(i1)
mS12 = Mhh2(i1)
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int3=Cget("C00 ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int4=Cget("C1  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int5=Cget("C2  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OZ2lSL=OZ2lSL+2.*chargefactor*coup1L*coup2L*(-1.*coup3L*int4*mF1 + coup3R*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lSR=OZ2lSR+2.*chargefactor*coup1R*coup2R*(-1.*coup3R*int4*mF1 + coup3L*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2R*(coup3L*int2*mF1*mF2 - 1.*coup3R*(int1 -   & 
&  2.*int3 + int2*mS12))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2L*(coup3R*int2*mF1*mF2 - 1.*coup3L*(int1 -   & 
&  2.*int3 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: Su,Fd,Fd
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSu2(i1).gt.mf_l2(3)).Or.(MFd2(i2).gt.mf_l2(3)).Or.(MFd2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i2,gt1,i1)
coup1R = cplcFdChaSuR(i2,gt1,i1)
coup2L = cplcChaFdcSuL(gt2,i3,i1)
coup2R = cplcChaFdcSuR(gt2,i3,i1)
coup3L = cplcFdFdVZL(i3,i2)
coup3R = cplcFdFdVZR(i3,i2)
! Masses in loop
mS1 = MSu(i1)
mS12 = MSu2(i1)
mF1 = MFd(i2)
mF12 = MFd2(i2)
mF2 = MFd(i3)
mF22 = MFd2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int3=Cget("C00 ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int4=Cget("C1  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int5=Cget("C2  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OZ2lSL=OZ2lSL+2.*chargefactor*coup1L*coup2L*(-1.*coup3L*int4*mF1 + coup3R*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lSR=OZ2lSR+2.*chargefactor*coup1R*coup2R*(-1.*coup3R*int4*mF1 + coup3L*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2R*(coup3L*int2*mF1*mF2 - 1.*coup3R*(int1 -   & 
&  2.*int3 + int2*mS12))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2L*(coup3R*int2*mF1*mF2 - 1.*coup3L*(int1 -   & 
&  2.*int3 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: VZ,Cha,Cha
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,5
    Do i3=1,5
If ((MVZ2.gt.mf_l2(3)).Or.(MCha2(i2).gt.mf_l2(3)).Or.(MCha2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplcChaChaVZL(i2,gt1)
coup1R = cplcChaChaVZR(i2,gt1)
coup2L = cplcChaChaVZL(gt2,i3)
coup2R = cplcChaChaVZR(gt2,i3)
coup3L = cplcChaChaVZL(i3,i2)
coup3R = cplcChaChaVZR(i3,i2)
! Masses in loop
mV1 = MVZ
mV12 = MVZ2
mF1 = MCha(i2)
mF12 = MCha2(i2)
mF2 = MCha(i3)
mF22 = MCha2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  int3=Cget("C00 ",MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  int4=Cget("C2  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  OZ2lSL=OZ2lSL - 4.*chargefactor*coup1L*coup2R*int4*(coup3R*mF1 + coup3L*mF2)
  OZ2lSR=OZ2lSR - 4.*chargefactor*coup1R*coup2L*int4*(coup3L*mF1 + coup3R*mF2)
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2L*(2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - & 
&  2.*(int1 - 2.*int3 + int2*mV12)))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2R*(2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - & 
&  2.*(int1 - 2.*int3 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],hh,Ah
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MAh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaAhL(gt2,i1,i3)
coup2R = cplcChaChaAhR(gt2,i1,i3)
coup3 = -cplAhhhVZ(i3,i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mS2 = MAh(i3)
mS22 = MAh2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int2=Cget("C00 ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int3=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int4=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2L*coup3*(int1 + int3 + int4)*mF1
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2R*coup3*(int1 + int3 + int4)*mF1
  OZ2lVL=OZ2lVL - 2.*chargefactor*coup1L*coup2R*coup3*int2
  OZ2lVR=OZ2lVR - 2.*chargefactor*coup1R*coup2L*coup3*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],Ah,hh
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MAh2(i2).gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaAhL(i1,gt1,i2)
coup1R = cplcChaChaAhR(i1,gt1,i2)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplAhhhVZ(i2,i3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = MAh(i2)
mS12 = MAh2(i2)
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int2=Cget("C00 ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int3=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int4=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2L*coup3*(int1 + int3 + int4)*mF1
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2R*coup3*(int1 + int3 + int4)*mF1
  OZ2lVL=OZ2lVL - 2.*chargefactor*coup1L*coup2R*coup3*int2
  OZ2lVR=OZ2lVR - 2.*chargefactor*coup1R*coup2L*coup3*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: bar[Cha],VZ,hh
! Generic diagram: FVS,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
    Do i3=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3)).Or.(Mhh2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChaVZL(i1,gt1)
coup1R = cplcChaChaVZR(i1,gt1)
coup2L = cplcChaChahhL(gt2,i1,i3)
coup2R = cplcChaChahhR(gt2,i1,i3)
coup3 = cplhhVZVZ(i3)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mV1 = MVZ
mV12 = MVZ2
mS2 = Mhh(i3)
mS22 = Mhh2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mV12)
  int2=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mS22, mV12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2L*coup3*int2
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2R*coup3*int2
  OZ2lVL=OZ2lVL - 1.*chargefactor*coup1L*coup2R*coup3*int1*mF1
  OZ2lVR=OZ2lVR - 1.*chargefactor*coup1R*coup2L*coup3*int1*mF1
  End if 
End if 
    End Do 
  End Do 


 ! Loop particles: bar[Cha],hh,VZ
! Generic diagram: FSV,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,5
  Do i2=1,8
If ((MCha2(i1).gt.mf_l2(3)).Or.(Mhh2(i2).gt.mf_l2(3)).Or.(MVZ2.gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcChaChahhL(i1,gt1,i2)
coup1R = cplcChaChahhR(i1,gt1,i2)
coup2L = cplcChaChaVZL(gt2,i1)
coup2R = cplcChaChaVZR(gt2,i1)
coup3 = cplhhVZVZ(i2)
! Masses in loop
mF1 = MCha(i1)
mF12 = MCha2(i1)
mS1 = Mhh(i2)
mS12 = Mhh2(i2)
mV2 = MVZ
mV22 = MVZ2
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mV22, mS12)
  int2=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mV22, mS12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2R*coup3*int2
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2L*coup3*int2
  OZ2lVL=OZ2lVL - 1.*chargefactor*coup1L*coup2L*coup3*int1*mF1
  OZ2lVR=OZ2lVR - 1.*chargefactor*coup1R*coup2R*coup3*int1*mF1
  End if 
End if 
    End Do 
   End Do 


 ! Loop particles: bar[Fd],conj[Su],conj[Su]
! Generic diagram: FSS,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,3
  Do i2=1,6
    Do i3=1,6
If ((MFd2(i1).gt.mf_l2(3)).Or.(MSu2(i2).gt.mf_l2(3)).Or.(MSu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplcFdChaSuL(i1,gt1,i2)
coup1R = cplcFdChaSuR(i1,gt1,i2)
coup2L = cplcChaFdcSuL(gt2,i1,i3)
coup2R = cplcChaFdcSuR(gt2,i1,i3)
coup3 = cplSucSuVZ(i3,i2)
! Masses in loop
mF1 = MFd(i1)
mF12 = MFd2(i1)
mS1 = MSu(i2)
mS12 = MSu2(i2)
mS2 = MSu(i3)
mS22 = MSu2(i3)
! Amplitude 
  int1=C0(0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int2=Cget("C00 ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int3=Cget("C1  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  int4=Cget("C2  ",0._dp, MassEx32, 0._dp, mF12, mS22, mS12)
  OZ2lSL=OZ2lSL - 2.*chargefactor*coup1L*coup2L*coup3*(int1 + int3 + int4)*mF1
  OZ2lSR=OZ2lSR - 2.*chargefactor*coup1R*coup2R*coup3*(int1 + int3 + int4)*mF1
  OZ2lVL=OZ2lVL - 2.*chargefactor*coup1L*coup2R*coup3*int2
  OZ2lVR=OZ2lVR - 2.*chargefactor*coup1R*coup2L*coup3*int2
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[Hpm],Chi,Chi
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 1 
Do i1=1,8
  Do i2=1,10
    Do i3=1,10
If ((MHpm2(i1).gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4).and.(i1.lt.2)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacHpmL(i2,gt1,i1)
coup1R = cplChiChacHpmR(i2,gt1,i1)
coup2L = cplcChaChiHpmL(gt2,i3,i1)
coup2R = cplcChaChiHpmR(gt2,i3,i1)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
! Masses in loop
mS1 = MHpm(i1)
mS12 = MHpm2(i1)
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int3=Cget("C00 ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int4=Cget("C1  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int5=Cget("C2  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OZ2lSL=OZ2lSL+2.*chargefactor*coup1L*coup2L*(-1.*coup3L*int4*mF1 + coup3R*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lSR=OZ2lSR+2.*chargefactor*coup1R*coup2R*(-1.*coup3R*int4*mF1 + coup3L*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2R*(coup3L*int2*mF1*mF2 - 1.*coup3R*(int1 -   & 
&  2.*int3 + int2*mS12))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2L*(coup3R*int2*mF1*mF2 - 1.*coup3L*(int1 -   & 
&  2.*int3 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[Sd],bar[Fu],bar[Fu]
! Generic diagram: SFF,  InsertionOrder: 1
chargefactor = 3 
Do i1=1,6
  Do i2=1,3
    Do i3=1,3
If ((MSd2(i1).gt.mf_l2(3)).Or.(MFu2(i2).gt.mf_l2(3)).Or.(MFu2(i3).gt.mf_l2(3))) Then
If (.not.OnlySM) Then 
coup1L = cplChaFucSdL(gt1,i2,i1)
coup1R = cplChaFucSdR(gt1,i2,i1)
coup2L = cplcChacFuSdL(gt2,i3,i1)
coup2R = cplcChacFuSdR(gt2,i3,i1)
coup3L = Conjg(-cplcFuFuVZR(i2,i3))
coup3R = Conjg(-cplcFuFuVZL(i2,i3))
! Masses in loop
mS1 = MSd(i1)
mS12 = MSd2(i1)
mF1 = MFu(i2)
mF12 = MFu2(i2)
mF2 = MFu(i3)
mF22 = MFu2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int3=Cget("C00 ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int4=Cget("C1  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  int5=Cget("C2  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mS12)
  OZ2lSL=OZ2lSL+2.*chargefactor*coup1L*coup2L*(-1.*coup3L*int4*mF1 + coup3R*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lSR=OZ2lSR+2.*chargefactor*coup1R*coup2R*(-1.*coup3R*int4*mF1 + coup3L*(int2 +   & 
&  int4 + int5)*mF2)
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2R*(coup3L*int2*mF1*mF2 - 1.*coup3R*(int1 -   & 
&  2.*int3 + int2*mS12))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2L*(coup3R*int2*mF1*mF2 - 1.*coup3L*(int1 -   & 
&  2.*int3 + int2*mS12))
  End if 
End if 
    End Do 
   End Do 
  End Do 


 ! Loop particles: conj[VWm],Chi,Chi
! Generic diagram: VFF,  InsertionOrder: 1
chargefactor = 1 
  Do i2=1,10
    Do i3=1,10
If ((MVWm2.gt.mf_l2(3)).Or.(MChi2(i2).gt.mf_l2(3)).Or.(MChi2(i3).gt.mf_l2(3))) Then
If (((i2.lt.4).and.(i3.lt.4)).or.(.not.OnlySM)) Then 
coup1L = cplChiChacVWmL(i2,gt1)
coup1R = cplChiChacVWmR(i2,gt1)
coup2L = cplcChaChiVWmL(gt2,i3)
coup2R = cplcChaChiVWmR(gt2,i3)
coup3L = cplChiChiVZL(i3,i2)
coup3R = cplChiChiVZR(i3,i2)
! Masses in loop
mV1 = MVWm
mV12 = MVWm2
mF1 = MChi(i2)
mF12 = MChi2(i2)
mF2 = MChi(i3)
mF22 = MChi2(i3)
! Amplitude 
  int1=B0(MassEx32, mF12, mF22)
  int2=C0(MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  int3=Cget("C00 ",MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  int4=Cget("C2  ",MassEx32, 0._dp, 0._dp, mF22, mF12, mV12)
  OZ2lSL=OZ2lSL - 4.*chargefactor*coup1L*coup2R*int4*(coup3R*mF1 + coup3L*mF2)
  OZ2lSR=OZ2lSR - 4.*chargefactor*coup1R*coup2L*int4*(coup3L*mF1 + coup3R*mF2)
  OZ2lVL=OZ2lVL+chargefactor*coup1L*coup2L*(2.*coup3R*int2*mF1*mF2 + coup3L*(Finite - & 
&  2.*(int1 - 2.*int3 + int2*mV12)))
  OZ2lVR=OZ2lVR+chargefactor*coup1R*coup2R*(2.*coup3L*int2*mF1*mF2 + coup3R*(Finite - & 
&  2.*(int1 - 2.*int3 + int2*mV12)))
  End if 
End if 
   End Do 
  End Do 


 OZ2lSL=oo16pi2*OZ2lSL 
OZ2lSR=oo16pi2*OZ2lSR 
OZ2lVL=oo16pi2*OZ2lVL 
OZ2lVR=oo16pi2*OZ2lVR 
Iname=Iname-1

End Subroutine CalculateZ2l 

Real(dp) Function C00g(m1, m2, m3)
Implicit None
Real(dp), Intent(in) :: m1, m2, m3
Real(dp) :: eps=1E-10_dp, large = 1E+5_dp

C00g = C00_3m(m1,m2,m3)

End Function C00g

Real(dp) Function C0g(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C0

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C0g=-1/(2._dp*m1) + (-1 + r)/(6._dp*m1) - (-1 + r)**2/(12._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C0g=-(1/m1)
     Else 
        C0g=(-1 + r - r*Log(r))/(m1*(-1 + r)**2)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C0g=-1/(2._dp*m2) + (-1 + r)/(3._dp*m2) - (-1 + r)**2/(4._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C0g=1._dp
     Else 
        C0g=(1 - r + Log(r))/(m2*(-1 + r)**2)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C0g=-1/(2._dp*m1) + (-1 + r)/(3._dp*m1) - (-1 + r)**2/(4._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C0g=1._dp
     Else 
        C0g=(1 - r + Log(r))/(m1*(-1 + r)**2)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C0g=-1/(2._dp*m2) + (-1 + r)/(6._dp*m2) - (-1 + r)**2/(12._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C0g=-(1/m2)
     Else 
        C0g=(-1 + r - r*Log(r))/(m2*(-1 + r)**2)
     End if 
  End if 

Else!! Different masses are not possible! 
   C0g =0._dp 
End if 
 
End Function C0g 


Real(dp) Function C1g(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C1

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C1g=1/(6._dp*m1) - (-1 + r)/(24._dp*m1) + (-1 + r)**2/(60._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C1g=1/(4._dp*m1)
     Else 
        C1g=(-1 + (4 - 3*r)*r + 2*r**2*Log(r))/(4._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C1g=1/(6._dp*m2) - (-1 + r)/(8._dp*m2) + (-1 + r)**2/(10._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C1g=large
     Else 
        C1g=(3 - 4*r + r**2 + 2*Log(r))/(4._dp*m2*(-1 + r)**3)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C1g=1/(6._dp*m1) - (-1 + r)/(8._dp*m1) + (-1 + r)**2/(10._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C1g=large
     Else 
        C1g=(3 - 4*r + r**2 + 2*Log(r))/(4._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C1g=1/(6._dp*m2) - (-1 + r)/(24._dp*m2) + (-1 + r)**2/(60._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C1g=1/(4._dp*m2)
     Else 
        C1g=(-1 + (4 - 3*r)*r + 2*r**2*Log(r))/(4._dp*m2*(-1 + r)**3)
     End if 
  End if 

Else!! Different masses are not possible! 
   C1g =0._dp 
End if 
 
End Function C1g 


Real(dp) Function C2g(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C2

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C2g=1/(6._dp*m1) - (-1 + r)/(12._dp*m1) + (-1 + r)**2/(20._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C2g=1/(2._dp*m1)
     Else 
        C2g=(-1 + r**2 - 2*r*Log(r))/(2._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C2g=1/(6._dp*m2) - (-1 + r)/(12._dp*m2) + (-1 + r)**2/(20._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C2g=1/(2._dp*m2)
     Else 
        C2g=(-1 + r**2 - 2*r*Log(r))/(2._dp*m2*(-1 + r)**3)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C2g=1/(6._dp*m1) - (-1 + r)/(8._dp*m1) + (-1 + r)**2/(10._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C2g=large
     Else 
        C2g=(3 - 4*r + r**2 + 2*Log(r))/(4._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C2g=1/(6._dp*m2) - (-1 + r)/(24._dp*m2) + (-1 + r)**2/(60._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C2g=1/(4._dp*m2)
     Else 
        C2g=(-1 + (4 - 3*r)*r + 2*r**2*Log(r))/(4._dp*m2*(-1 + r)**3)
     End if 
  End if 

Else!! Different masses are not possible! 
   C2g =0._dp 
End if 
 
End Function C2g 


Real(dp) Function C11g(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C11

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C11g=-1/(12._dp*m1) + (-1 + r)/(60._dp*m1) - (-1 + r)**2/(180._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C11g=-1/(9._dp*m1)
     Else 
        C11g=((-1 + r)*(2 + r*(-7 + 11*r)) - 6*r**3*Log(r))/(18._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C11g=-1/(12._dp*m2) + (-1 + r)/(15._dp*m2) - (-1 + r)**2/(18._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C11g=large
     Else 
        C11g=(-((-1 + r)*(11 + r*(-7 + 2*r))) + 6*Log(r))/(18._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C11g=-1/(12._dp*m1) + (-1 + r)/(15._dp*m1) - (-1 + r)**2/(18._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C11g=large
     Else 
        C11g=(-((-1 + r)*(11 + r*(-7 + 2*r))) + 6*Log(r))/(18._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C11g=-1/(12._dp*m2) + (-1 + r)/(60._dp*m2) - (-1 + r)**2/(180._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C11g=-1/(9._dp*m2)
     Else 
        C11g=((-1 + r)*(2 + r*(-7 + 11*r)) - 6*r**3*Log(r))/(18._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C11g =0._dp 
End if 
 
End Function C11g 


Real(dp) Function C12g(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C12

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C12g=-1/(24._dp*m1) + (-1 + r)/(60._dp*m1) - (-1 + r)**2/(120._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12g=-1/(12._dp*m1)
     Else 
        C12g=(-((-1 + r)*(-1 + r*(5 + 2*r))) + 6*r**2*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12g=-1/(24._dp*m2) + (-1 + r)/(40._dp*m2) - (-1 + r)**2/(60._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12g=-1/(6._dp*m2)
     Else 
        C12g=-(2 + r*(3 + (-6 + r)*r) + 6*r*Log(r))/(12._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C12g=-1/(24._dp*m1) + (-1 + r)/(30._dp*m1) - (-1 + r)**2/(36._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12g=large
     Else 
        C12g=(-((-1 + r)*(11 + r*(-7 + 2*r))) + 6*Log(r))/(36._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12g=-1/(24._dp*m2) + (-1 + r)/(120._dp*m2) - (-1 + r)**2/(360._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12g=-1/(18._dp*m2)
     Else 
        C12g=((-1 + r)*(2 + r*(-7 + 11*r)) - 6*r**3*Log(r))/(36._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C12g =0._dp 
End if 
 
End Function C12g 


Real(dp) Function C22g(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C22

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C22g=-1/(12._dp*m1) + (-1 + r)/(20._dp*m1) - (-1 + r)**2/(30._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C22g=-1/(3._dp*m1)
     Else 
        C22g=-(2 + r*(3 + (-6 + r)*r) + 6*r*Log(r))/(6._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C22g=-1/(12._dp*m2) + (-1 + r)/(30._dp*m2) - (-1 + r)**2/(60._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C22g=-1/(6._dp*m2)
     Else 
        C22g=(-((-1 + r)*(-1 + r*(5 + 2*r))) + 6*r**2*Log(r))/(6._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C22g=-1/(12._dp*m1) + (-1 + r)/(15._dp*m1) - (-1 + r)**2/(18._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C22g=large
     Else 
        C22g=(-((-1 + r)*(11 + r*(-7 + 2*r))) + 6*Log(r))/(18._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C22g=-1/(12._dp*m2) + (-1 + r)/(60._dp*m2) - (-1 + r)**2/(180._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C22g=-1/(9._dp*m2)
     Else 
        C22g=((-1 + r)*(2 + r*(-7 + 11*r)) - 6*r**3*Log(r))/(18._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C22g =0._dp 
End if 
 
End Function C22g 


Real(dp) Function C2C12C22(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C12 + C2 + C22

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C2C12C22=1/(24._dp*m1) - (-1 + r)/(60._dp*m1) + (-1 + r)**2/(120._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C2C12C22=1/(12._dp*m1)
     Else 
        C2C12C22=((-1 + r)*(-1 + r*(5 + 2*r)) - 6*r**2*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C2C12C22=1/(24._dp*m2) - (-1 + r)/(40._dp*m2) + (-1 + r)**2/(60._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C2C12C22=1/(6._dp*m2)
     Else 
        C2C12C22=(2 + r*(3 + (-6 + r)*r) + 6*r*Log(r))/(12._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C2C12C22=1/(24._dp*m1) - (-1 + r)/(40._dp*m1) + (-1 + r)**2/(60._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C2C12C22=1/(6._dp*m1)
     Else 
        C2C12C22=(2 + r*(3 + (-6 + r)*r) + 6*r*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C2C12C22=1/(24._dp*m2) - (-1 + r)/(60._dp*m2) + (-1 + r)**2/(120._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C2C12C22=1/(12._dp*m2)
     Else 
        C2C12C22=((-1 + r)*(-1 + r*(5 + 2*r)) - 6*r**2*Log(r))/(12._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C2C12C22 =0._dp 
End if 
 
End Function C2C12C22 


Real(dp) Function C1C12C11(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C1 + C11 + C12

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C1C12C11=1/(24._dp*m1) - (-1 + r)/(120._dp*m1) + (-1 + r)**2/(360._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C1C12C11=1/(18._dp*m1)
     Else 
        C1C12C11=(-((-1 + r)*(2 + r*(-7 + 11*r))) + 6*r**3*Log(r))/(36._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C1C12C11=1/(24._dp*m2) - (-1 + r)/(30._dp*m2) + (-1 + r)**2/(36._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C1C12C11=large
     Else 
        C1C12C11=((-1 + r)*(11 + r*(-7 + 2*r)) - 6*Log(r))/(36._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C1C12C11=1/(24._dp*m1) - (-1 + r)/(40._dp*m1) + (-1 + r)**2/(60._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C1C12C11=1/(6._dp*m1)
     Else 
        C1C12C11=(2 + r*(3 + (-6 + r)*r) + 6*r*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C1C12C11=1/(24._dp*m2) - (-1 + r)/(60._dp*m2) + (-1 + r)**2/(120._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C1C12C11=1/(12._dp*m2)
     Else 
        C1C12C11=((-1 + r)*(-1 + r*(5 + 2*r)) - 6*r**2*Log(r))/(12._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C1C12C11 =0._dp 
End if 
 
End Function C1C12C11 


Real(dp) Function C0C1C2(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C0 + C1 + C2

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C0C1C2=-1/(6._dp*m1) + (-1 + r)/(24._dp*m1) - (-1 + r)**2/(60._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C0C1C2=-1/(4._dp*m1)
     Else 
        C0C1C2=(1 - 4*r + 3*r**2 - 2*r**2*Log(r))/(4._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C0C1C2=-1/(6._dp*m2) + (-1 + r)/(8._dp*m2) - (-1 + r)**2/(10._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C0C1C2=large
     Else 
        C0C1C2=-(3 - 4*r + r**2 + 2*Log(r))/(4._dp*m2*(-1 + r)**3)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C0C1C2=-1/(6._dp*m1) + (-1 + r)/(12._dp*m1) - (-1 + r)**2/(20._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C0C1C2=-1/(2._dp*m1)
     Else 
        C0C1C2=(1 - r**2 + 2*r*Log(r))/(2._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C0C1C2=-1/(6._dp*m2) + (-1 + r)/(12._dp*m2) - (-1 + r)**2/(20._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C0C1C2=-1/(2._dp*m2)
     Else 
        C0C1C2=(1 - r**2 + 2*r*Log(r))/(2._dp*m2*(-1 + r)**3)
     End if 
  End if 

Else!! Different masses are not possible! 
   C0C1C2 =0._dp 
End if 
 
End Function C0C1C2 


Real(dp) Function C12C11C2(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  2 C11 + 2 C12 - C2

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C12C11C2=-5/(12._dp*m1) + (3*(-1 + r))/(20._dp*m1) - (7*(-1 + r)**2)/(90._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12C11C2=-8/(9._dp*m1)
     Else 
        C12C11C2=((-1 + r)*(16 + r*(-29 + 7*r)) - 6*r*(3 + 2*(-3 + r)*r)*Log(r))/(18._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12C11C2=-5/(12._dp*m2) + (4*(-1 + r))/(15._dp*m2) - (7*(-1 + r)**2)/(36._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12C11C2=large
     Else 
        C12C11C2=(-((-1 + r)*(7 + r*(-29 + 16*r))) + 6*(2 + 3*(-2 + r)*r)*Log(r))/(18._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C12C11C2=-5/(12._dp*m1) + (13*(-1 + r))/(40._dp*m1) - (4*(-1 + r)**2)/(15._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12C11C2=large
     Else 
        C12C11C2=-((-1 + r)*(31 + r*(-26 + 7*r)) + 6*(-3 + r)*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12C11C2=-5/(12._dp*m2) + (11*(-1 + r))/(120._dp*m2) - (-1 + r)**2/(30._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12C11C2=-7/(12._dp*m2)
     Else 
        C12C11C2=((-1 + r)*(7 + r*(-26 + 31*r)) + 6*(1 - 3*r)*r**2*Log(r))/(12._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C12C11C2 =0._dp 
End if 
 
End Function C12C11C2 


Real(dp) Function C12C22C1(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  -C1 + 2 C12 + 2 C22

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C12C22C1=-5/(12._dp*m1) + (7*(-1 + r))/(40._dp*m1) - (-1 + r)**2/(10._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12C22C1=-13/(12._dp*m1)
     Else 
        C12C22C1=((-1 + r)*(13 + (-2 + r)*r) - 6*r*(4 + (-3 + r)*r)*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12C22C1=-5/(12._dp*m2) + (29*(-1 + r))/(120._dp*m2) - (-1 + r)**2/(6._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12C22C1=large
     Else 
        C12C22C1=(-((-1 + r)*(1 + r*(-2 + 13*r))) + 6*(1 + r*(-3 + 4*r))*Log(r))/(12._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C12C22C1=-5/(12._dp*m1) + (13*(-1 + r))/(40._dp*m1) - (4*(-1 + r)**2)/(15._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12C22C1=large
     Else 
        C12C22C1=-((-1 + r)*(31 + r*(-26 + 7*r)) + 6*(-3 + r)*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12C22C1=-5/(12._dp*m2) + (11*(-1 + r))/(120._dp*m2) - (-1 + r)**2/(30._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12C22C1=-7/(12._dp*m2)
     Else 
        C12C22C1=((-1 + r)*(7 + r*(-26 + 31*r)) + 6*(1 - 3*r)*r**2*Log(r))/(12._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C12C22C1 =0._dp 
End if 
 
End Function C12C22C1 


Real(dp) Function C12C22(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C12 + C22

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C12C22=-1/(8._dp*m1) + (-1 + r)/(15._dp*m1) - (-1 + r)**2/(24._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12C22=-5/(12._dp*m1)
     Else 
        C12C22=(-5 + (9 - 4*r)*r**2 + 6*(-2 + r)*r*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12C22=-1/(8._dp*m2) + (7*(-1 + r))/(120._dp*m2) - (-1 + r)**2/(30._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12C22=-1/(3._dp*m2)
     Else 
        C12C22=(-4 + 9*r - 5*r**3 + 6*r*(-1 + 2*r)*Log(r))/(12._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C12C22=-1/(8._dp*m1) + (-1 + r)/(10._dp*m1) - (-1 + r)**2/(12._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C12C22=large
     Else 
        C12C22=(-((-1 + r)*(11 + r*(-7 + 2*r))) + 6*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C12C22=-1/(8._dp*m2) + (-1 + r)/(40._dp*m2) - (-1 + r)**2/(120._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C12C22=-1/(6._dp*m2)
     Else 
        C12C22=((-1 + r)*(2 + r*(-7 + 11*r)) - 6*r**3*Log(r))/(12._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C12C22 =0._dp 
End if 
 
End Function C12C22 


Real(dp) Function C2C12(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C12 + C2

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C2C12=1/(8._dp*m1) - (-1 + r)/(15._dp*m1) + (-1 + r)**2/(24._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C2C12=5/(12._dp*m1)
     Else 
        C2C12=(5 + r**2*(-9 + 4*r) - 6*(-2 + r)*r*Log(r))/(12._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C2C12=1/(8._dp*m2) - (7*(-1 + r))/(120._dp*m2) + (-1 + r)**2/(30._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C2C12=1/(3._dp*m2)
     Else 
        C2C12=(4 - 9*r + 5*r**3 + 6*(1 - 2*r)*r*Log(r))/(12._dp*m2*(-1 + r)**4)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C2C12=1/(8._dp*m1) - (11*(-1 + r))/(120._dp*m1) + (13*(-1 + r)**2)/(180._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C2C12=large
     Else 
        C2C12=((-1 + r)*(16 + r*(-29 + 7*r)) + 6*(-2 + 3*r)*Log(r))/(36._dp*m1*(-1 + r)**4)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C2C12=1/(8._dp*m2) - (-1 + r)/(30._dp*m2) + (-1 + r)**2/(72._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C2C12=7/(36._dp*m2)
     Else 
        C2C12=(-((-1 + r)*(7 + r*(-29 + 16*r))) + 6*r**2*(-3 + 2*r)*Log(r))/(36._dp*m2*(-1 + r)**4)
     End if 
  End if 

Else!! Different masses are not possible! 
   C2C12 =0._dp 
End if 
 
End Function C2C12 


Real(dp) Function C1C2(m1in,m2in,m3in) 
Real(dp),Intent(in)::m1in,m2in,m3in 
Real(dp)::eps=1E-10_dp,large=0._dp,epsR=1E-03_dp 
Real(dp)::m1,m2,r 

!  C1 + C2

If (Abs(m1in-m2in).lt.eps) Then! m1==m2 
 m1=m1in
 m2=m3in
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then  ! Taylor
        C1C2=1/(3._dp*m1) - (-1 + r)/(8._dp*m1) + (-1 + r)**2/(15._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C1C2=3/(4._dp*m1)
     Else 
        C1C2=-(3 - 4*r + r**2 - 2*(-2 + r)*r*Log(r))/(4._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C1C2=1/(3._dp*m2) - (5*(-1 + r))/(24._dp*m2) + (3*(-1 + r)**2)/(20._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C1C2=large
     Else 
        C1C2=(1 - 4*r + 3*r**2 + (2 - 4*r)*Log(r))/(4._dp*m2*(-1 + r)**3)
    End if 
   End if 

Else if (Abs(m2in-m3in).lt.eps) Then! m2==m3 
 m1=m1in 
 m2=m3in 
   If (m1.gt.m2) Then 
     r=m2/m1 
     If ((1._dp-r).lt.epsR) Then 
        C1C2=1/(3._dp*m1) - (-1 + r)/(4._dp*m1) + (-1 + r)**2/(5._dp*m1)
     Elseif (Abs(r).lt.eps) Then 
        C1C2=large
     Else 
        C1C2=(3 - 4*r + r**2 + 2*Log(r))/(2._dp*m1*(-1 + r)**3)
     End if 
   Else 
     r=m1/m2 
     If ((1._dp-r).lt.epsR) Then 
        C1C2=1/(3._dp*m2) - (-1 + r)/(12._dp*m2) + (-1 + r)**2/(30._dp*m2)
     Elseif (Abs(r).lt.eps) Then 
        C1C2=1/(2._dp*m2)
     Else 
        C1C2=(-1 + (4 - 3*r)*r + 2*r**2*Log(r))/(2._dp*m2*(-1 + r)**3)
     End if 
  End if 

Else!! Different masses are not possible! 
   C1C2 =0._dp 
End if 
 
End Function C1C2 
End Module FlavorKit_LFV_munuSSM3G 
